[0m14:35:15.702036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111c1180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a87f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a86a70>]}


============================== 14:35:15.704943 | a3a3e6bd-cf2f-4b48-b2fc-80d5a75b3ffb ==============================
[0m14:35:15.704943 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:35:15.705376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init duckdb_dbt_sample', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:35:15.713372 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse logging event dictionary. Failed to parse dir field: expected string or bytes-like object.. Dictionary: {'dir': PosixPath('/Users/takeshiiijima/.dbt')}
[0m14:35:15.713757 [info ] [MainThread]: Creating dbt configuration folder at 
[0m14:35:15.714806 [debug] [MainThread]: Starter project path: /opt/homebrew/lib/python3.10/site-packages/dbt/include/starter_project
[0m14:35:15.719111 [info ] [MainThread]: 
Your new dbt project "duckdb_dbt_sample" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m14:35:15.719336 [info ] [MainThread]: Setting up your profile.
[0m14:37:54.232117 [error] [MainThread]: Encountered an error:

[0m14:37:54.238123 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/main.py", line 477, in init
    results = task.run()
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/task/init.py", line 346, in run
    self.setup_profile(profile_name)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/task/init.py", line 261, in setup_profile
    adapter = self.ask_for_adapter_choice()
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/task/init.py", line 242, in ask_for_adapter_choice
    numeric_choice = click.prompt(prompt_msg, type=click.INT)
  File "/opt/homebrew/lib/python3.10/site-packages/click/termui.py", line 164, in prompt
    value = prompt_func(prompt)
  File "/opt/homebrew/lib/python3.10/site-packages/click/termui.py", line 147, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m14:37:54.241238 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": false, "command_wall_clock_time": 158.58401, "process_in_blocks": "0", "process_kernel_time": 0.172507, "process_mem_max_rss": "93372416", "process_out_blocks": "0", "process_user_time": 0.833324}
[0m14:37:54.242074 [debug] [MainThread]: Command `dbt init` failed at 14:37:54.241883 after 158.59 seconds
[0m14:37:54.243135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111c1180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069165c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124957b0>]}
[0m14:37:54.243912 [debug] [MainThread]: Flushing usage events
[0m14:37:57.769833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c11b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11948beb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11948ab00>]}


============================== 14:37:57.772711 | 09f8d8d4-4c52-475a-9449-27eb79dd71a7 ==============================
[0m14:37:57.772711 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:37:57.773047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt init duckdb_dbt_sample', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:57.781636 [info ] [MainThread]: Setting up your profile.
[0m14:38:04.025084 [error] [MainThread]: Encountered an error:

[0m14:38:04.028638 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/main.py", line 477, in init
    results = task.run()
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/task/init.py", line 320, in run
    self.setup_profile(profile_name)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/task/init.py", line 261, in setup_profile
    adapter = self.ask_for_adapter_choice()
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/task/init.py", line 242, in ask_for_adapter_choice
    numeric_choice = click.prompt(prompt_msg, type=click.INT)
  File "/opt/homebrew/lib/python3.10/site-packages/click/termui.py", line 164, in prompt
    value = prompt_func(prompt)
  File "/opt/homebrew/lib/python3.10/site-packages/click/termui.py", line 147, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m14:38:04.030616 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": false, "command_wall_clock_time": 6.304998, "process_in_blocks": "0", "process_kernel_time": 0.163432, "process_mem_max_rss": "93454336", "process_out_blocks": "0", "process_user_time": 0.845282}
[0m14:38:04.031183 [debug] [MainThread]: Command `dbt init` failed at 14:38:04.031068 after 6.31 seconds
[0m14:38:04.031627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c11b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187951e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187b2170>]}
[0m14:38:04.032054 [debug] [MainThread]: Flushing usage events
[0m14:38:10.668774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108067ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108066bf0>]}


============================== 14:38:10.675208 | 20cf070b-74db-4b11-971d-5faf5e0493ae ==============================
[0m14:38:10.675208 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:38:10.676768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt init duckdb_dbt_sample', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:38:10.698384 [info ] [MainThread]: Setting up your profile.
[0m14:38:14.904651 [info ] [MainThread]: Profile duckdb_dbt_sample written to /Users/takeshiiijima/.dbt/profiles.yml using target's sample configuration. Once updated, you'll be able to start developing with dbt.
[0m14:38:14.905702 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 4.300977, "process_in_blocks": "0", "process_kernel_time": 0.112342, "process_mem_max_rss": "99188736", "process_out_blocks": "0", "process_user_time": 0.726178}
[0m14:38:14.905999 [debug] [MainThread]: Command `dbt init` succeeded at 14:38:14.905936 after 4.30 seconds
[0m14:38:14.906242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108067e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b588e0>]}
[0m14:38:14.906484 [debug] [MainThread]: Flushing usage events
[0m14:38:15.658186 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:38:18.615429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e1270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f391b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f39f00>]}


============================== 14:38:18.618342 | 57aa3b9d-5baf-48a9-8971-559c5df0ffe6 ==============================
[0m14:38:18.618342 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:38:18.618687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt init duckdb_dbt_sample', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:38:18.627548 [info ] [MainThread]: Setting up your profile.
[0m14:38:29.557704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103999150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a6b60>]}


============================== 14:38:29.560516 | 2d87f872-d817-4a58-842a-9b4e181a0127 ==============================
[0m14:38:29.560516 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:38:29.560875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:38:29.643199 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:38:29.643586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2d87f872-d817-4a58-842a-9b4e181a0127', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c08a60>]}
[0m14:38:29.643862 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:38:29.644047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2d87f872-d817-4a58-842a-9b4e181a0127', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0a620>]}
[0m14:38:29.713372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d87f872-d817-4a58-842a-9b4e181a0127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104272fe0>]}
[0m14:38:29.744739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d87f872-d817-4a58-842a-9b4e181a0127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a72020>]}
[0m14:38:29.747684 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:38:29.972798 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:38:29.973322 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:38:29.973552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2d87f872-d817-4a58-842a-9b4e181a0127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106250340>]}
[0m14:38:30.735661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d87f872-d817-4a58-842a-9b4e181a0127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676f370>]}
[0m14:38:30.778146 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m14:38:30.779424 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m14:38:30.794946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d87f872-d817-4a58-842a-9b4e181a0127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ce8c0>]}
[0m14:38:30.795286 [info ] [MainThread]: Found 1 model, 1 seed, 426 macros
[0m14:38:30.795500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d87f872-d817-4a58-842a-9b4e181a0127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106775c00>]}
[0m14:38:30.796294 [info ] [MainThread]: 
[0m14:38:30.796514 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:38:30.796682 [info ] [MainThread]: 
[0m14:38:30.796955 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:38:30.797390 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:38:30.830675 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:38:30.830969 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:38:30.831152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:30.877287 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m14:38:30.878184 [debug] [ThreadPool]: On list_dev: Close
[0m14:38:30.879845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:38:30.880387 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:38:30.885307 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:38:30.885601 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:38:30.885768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:30.891250 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m14:38:30.892378 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:38:30.892737 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:38:30.893130 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:38:30.893323 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:38:30.893492 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:38:30.893872 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:38:30.894392 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:38:30.894580 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:38:30.894739 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:38:30.894970 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:38:30.895141 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:38:30.898941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:38:30.902987 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:38:30.903263 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:38:30.903424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:30.908459 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m14:38:30.908714 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:38:30.908964 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:38:30.920900 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m14:38:30.921735 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:38:30.922326 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:38:30.922488 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:38:30.923891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d87f872-d817-4a58-842a-9b4e181a0127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cc5b0>]}
[0m14:38:30.924217 [debug] [MainThread]: Using duckdb connection "master"
[0m14:38:30.924422 [debug] [MainThread]: On master: BEGIN
[0m14:38:30.924614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:38:30.929983 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m14:38:30.930282 [debug] [MainThread]: On master: COMMIT
[0m14:38:30.930453 [debug] [MainThread]: Using duckdb connection "master"
[0m14:38:30.930605 [debug] [MainThread]: On master: COMMIT
[0m14:38:30.930814 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:38:30.930978 [debug] [MainThread]: On master: Close
[0m14:38:30.932425 [debug] [Thread-1 (]: Began running node seed.duckdb_dbt_sample.sample_data
[0m14:38:30.932766 [info ] [Thread-1 (]: 1 of 1 START seed file main.sample_data ........................................ [RUN]
[0m14:38:30.933052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now seed.duckdb_dbt_sample.sample_data)
[0m14:38:30.933672 [debug] [Thread-1 (]: Began compiling node seed.duckdb_dbt_sample.sample_data
[0m14:38:30.933885 [debug] [Thread-1 (]: Began executing node seed.duckdb_dbt_sample.sample_data
[0m14:38:30.949772 [debug] [Thread-1 (]: Using duckdb connection "seed.duckdb_dbt_sample.sample_data"
[0m14:38:30.950541 [debug] [Thread-1 (]: On seed.duckdb_dbt_sample.sample_data: BEGIN
[0m14:38:30.950768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:30.956192 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:38:30.956445 [debug] [Thread-1 (]: Using duckdb connection "seed.duckdb_dbt_sample.sample_data"
[0m14:38:30.956642 [debug] [Thread-1 (]: On seed.duckdb_dbt_sample.sample_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "seed.duckdb_dbt_sample.sample_data"} */

    create table "dev"."main"."sample_data" ("id" integer,"name" text,"age" integer)
  
[0m14:38:30.957346 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:38:30.964650 [debug] [Thread-1 (]: Using duckdb connection "seed.duckdb_dbt_sample.sample_data"
[0m14:38:30.964969 [debug] [Thread-1 (]: On seed.duckdb_dbt_sample.sample_data: 
          COPY "dev"."main"."sample_data" FROM '/Users/takeshiiijima/github/duckdb-dbt/data/sample_data.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m14:38:30.969258 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:38:30.973082 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.duckdb_dbt_sample.sample_data"
[0m14:38:30.981065 [debug] [Thread-1 (]: On seed.duckdb_dbt_sample.sample_data: COMMIT
[0m14:38:30.981381 [debug] [Thread-1 (]: Using duckdb connection "seed.duckdb_dbt_sample.sample_data"
[0m14:38:30.981574 [debug] [Thread-1 (]: On seed.duckdb_dbt_sample.sample_data: COMMIT
[0m14:38:30.982621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:38:30.984417 [debug] [Thread-1 (]: On seed.duckdb_dbt_sample.sample_data: Close
[0m14:38:30.988485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d87f872-d817-4a58-842a-9b4e181a0127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a47df0>]}
[0m14:38:30.988906 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.sample_data .................................... [[32mINSERT 3[0m in 0.05s]
[0m14:38:30.989225 [debug] [Thread-1 (]: Finished running node seed.duckdb_dbt_sample.sample_data
[0m14:38:30.989820 [debug] [MainThread]: Using duckdb connection "master"
[0m14:38:30.990021 [debug] [MainThread]: On master: BEGIN
[0m14:38:30.990176 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:38:30.996178 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m14:38:30.996494 [debug] [MainThread]: On master: COMMIT
[0m14:38:30.996684 [debug] [MainThread]: Using duckdb connection "master"
[0m14:38:30.996839 [debug] [MainThread]: On master: COMMIT
[0m14:38:30.997098 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:38:30.997313 [debug] [MainThread]: On master: Close
[0m14:38:30.998360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:30.998527 [debug] [MainThread]: Connection 'seed.duckdb_dbt_sample.sample_data' was properly closed.
[0m14:38:30.998698 [info ] [MainThread]: 
[0m14:38:30.998882 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m14:38:30.999635 [debug] [MainThread]: Command end result
[0m14:38:31.012135 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m14:38:31.013213 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m14:38:31.017228 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m14:38:31.017612 [info ] [MainThread]: 
[0m14:38:31.017964 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:38:31.018141 [info ] [MainThread]: 
[0m14:38:31.018325 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:38:31.019222 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.5003929, "process_in_blocks": "0", "process_kernel_time": 0.247041, "process_mem_max_rss": "140492800", "process_out_blocks": "0", "process_user_time": 1.834415}
[0m14:38:31.019475 [debug] [MainThread]: Command `dbt seed` succeeded at 14:38:31.019411 after 1.50 seconds
[0m14:38:31.019918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103999150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a42680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a72020>]}
[0m14:38:31.020221 [debug] [MainThread]: Flushing usage events
[0m14:38:31.786024 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:38:48.099516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679ab90>]}


============================== 14:38:48.102767 | bbee01c7-22a8-4656-a5eb-34f1be7fa72d ==============================
[0m14:38:48.102767 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:38:48.103092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:38:48.192470 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:38:48.193003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bbee01c7-22a8-4656-a5eb-34f1be7fa72d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106910a60>]}
[0m14:38:48.193327 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:38:48.193575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bbee01c7-22a8-4656-a5eb-34f1be7fa72d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106912620>]}
[0m14:38:48.270558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbee01c7-22a8-4656-a5eb-34f1be7fa72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691da80>]}
[0m14:38:48.303702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbee01c7-22a8-4656-a5eb-34f1be7fa72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e5ea0>]}
[0m14:38:48.306787 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:38:48.364807 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:38:48.437093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:38:48.437375 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:38:48.462222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbee01c7-22a8-4656-a5eb-34f1be7fa72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d33e50>]}
[0m14:38:48.504934 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m14:38:48.506122 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m14:38:48.519069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbee01c7-22a8-4656-a5eb-34f1be7fa72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c57b80>]}
[0m14:38:48.519468 [info ] [MainThread]: Found 1 model, 1 seed, 426 macros
[0m14:38:48.519676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbee01c7-22a8-4656-a5eb-34f1be7fa72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c564a0>]}
[0m14:38:48.520576 [info ] [MainThread]: 
[0m14:38:48.520807 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:38:48.520970 [info ] [MainThread]: 
[0m14:38:48.521349 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:38:48.521874 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m14:38:48.556323 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m14:38:48.556644 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m14:38:48.556833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:48.617629 [debug] [ThreadPool]: SQL status: OK in 0.061 seconds
[0m14:38:48.618555 [debug] [ThreadPool]: On list_dev: Close
[0m14:38:48.620291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m14:38:48.620582 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m14:38:48.624291 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:38:48.624515 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m14:38:48.624698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:48.630497 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m14:38:48.631531 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:38:48.631713 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m14:38:48.631941 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:38:48.632097 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:38:48.632248 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m14:38:48.632525 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:38:48.632948 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:38:48.633108 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m14:38:48.633251 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m14:38:48.633600 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:38:48.634088 [debug] [ThreadPool]: On create_dev_main: Close
[0m14:38:48.637875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m14:38:48.641084 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:38:48.641297 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m14:38:48.641455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:48.647009 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m14:38:48.647273 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m14:38:48.647449 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m14:38:48.660735 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m14:38:48.661757 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m14:38:48.662418 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m14:38:48.662624 [debug] [ThreadPool]: On list_dev_main: Close
[0m14:38:48.664182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbee01c7-22a8-4656-a5eb-34f1be7fa72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c57280>]}
[0m14:38:48.664494 [debug] [MainThread]: Using duckdb connection "master"
[0m14:38:48.664663 [debug] [MainThread]: On master: BEGIN
[0m14:38:48.664821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:38:48.670525 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m14:38:48.670829 [debug] [MainThread]: On master: COMMIT
[0m14:38:48.671002 [debug] [MainThread]: Using duckdb connection "master"
[0m14:38:48.671158 [debug] [MainThread]: On master: COMMIT
[0m14:38:48.671383 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:38:48.671554 [debug] [MainThread]: On master: Close
[0m14:38:48.673153 [debug] [Thread-1 (]: Began running node model.duckdb_dbt_sample.sample_model
[0m14:38:48.673495 [info ] [Thread-1 (]: 1 of 1 START sql view model main.sample_model .................................. [RUN]
[0m14:38:48.673754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_dbt_sample.sample_model)
[0m14:38:48.673949 [debug] [Thread-1 (]: Began compiling node model.duckdb_dbt_sample.sample_model
[0m14:38:48.679218 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_dbt_sample.sample_model"
[0m14:38:48.679878 [debug] [Thread-1 (]: Began executing node model.duckdb_dbt_sample.sample_model
[0m14:38:48.697366 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_dbt_sample.sample_model"
[0m14:38:48.697979 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m14:38:48.698182 [debug] [Thread-1 (]: On model.duckdb_dbt_sample.sample_model: BEGIN
[0m14:38:48.698361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:48.703905 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:38:48.704187 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m14:38:48.704380 [debug] [Thread-1 (]: On model.duckdb_dbt_sample.sample_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */

  
  create view "dev"."main"."sample_model__dbt_tmp" as (
    -- models/sample_model.sql
select
    *
from
    { { ref('sample_data') } }
  );

[0m14:38:48.706674 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */

  
  create view "dev"."main"."sample_model__dbt_tmp" as (
    -- models/sample_model.sql
select
    *
from
    { { ref('sample_data') } }
  );

[0m14:38:48.706910 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:38:48.707185 [debug] [Thread-1 (]: On model.duckdb_dbt_sample.sample_model: ROLLBACK
[0m14:38:48.710584 [debug] [Thread-1 (]: Failed to rollback 'model.duckdb_dbt_sample.sample_model'
[0m14:38:48.710889 [debug] [Thread-1 (]: On model.duckdb_dbt_sample.sample_model: Close
[0m14:38:48.712454 [debug] [Thread-1 (]: Runtime Error in model sample_model (models/sample_model.sql)
  Parser Error: syntax error at or near "{"
[0m14:38:48.713642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbee01c7-22a8-4656-a5eb-34f1be7fa72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719abc0>]}
[0m14:38:48.714022 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.sample_model ......................... [[31mERROR[0m in 0.04s]
[0m14:38:48.714332 [debug] [Thread-1 (]: Finished running node model.duckdb_dbt_sample.sample_model
[0m14:38:48.714607 [debug] [Thread-4 (]: Marking all children of 'model.duckdb_dbt_sample.sample_model' to be skipped because of status 'error'.  Reason: Runtime Error in model sample_model (models/sample_model.sql)
  Parser Error: syntax error at or near "{".
[0m14:38:48.715419 [debug] [MainThread]: Using duckdb connection "master"
[0m14:38:48.715596 [debug] [MainThread]: On master: BEGIN
[0m14:38:48.715744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:38:48.721607 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m14:38:48.721944 [debug] [MainThread]: On master: COMMIT
[0m14:38:48.722126 [debug] [MainThread]: Using duckdb connection "master"
[0m14:38:48.722289 [debug] [MainThread]: On master: COMMIT
[0m14:38:48.722517 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:38:48.722689 [debug] [MainThread]: On master: Close
[0m14:38:48.723809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:48.723996 [debug] [MainThread]: Connection 'model.duckdb_dbt_sample.sample_model' was properly closed.
[0m14:38:48.724179 [info ] [MainThread]: 
[0m14:38:48.724396 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m14:38:48.724777 [debug] [MainThread]: Command end result
[0m14:38:48.738861 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m14:38:48.740269 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m14:38:48.745012 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m14:38:48.745300 [info ] [MainThread]: 
[0m14:38:48.745528 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:38:48.745709 [info ] [MainThread]: 
[0m14:38:48.745910 [error] [MainThread]:   Runtime Error in model sample_model (models/sample_model.sql)
  Parser Error: syntax error at or near "{"
[0m14:38:48.746071 [info ] [MainThread]: 
[0m14:38:48.746246 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:38:48.747087 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6935492, "process_in_blocks": "0", "process_kernel_time": 0.2545, "process_mem_max_rss": "132595712", "process_out_blocks": "0", "process_user_time": 1.316388}
[0m14:38:48.747305 [debug] [MainThread]: Command `dbt run` failed at 14:38:48.747264 after 0.69 seconds
[0m14:38:48.747517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c82e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10724fc10>]}
[0m14:38:48.747718 [debug] [MainThread]: Flushing usage events
[0m14:38:49.531749 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:02.170530 [error] [MainThread]: Encountered an error:

[0m14:39:02.174281 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/main.py", line 477, in init
    results = task.run()
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/task/init.py", line 320, in run
    self.setup_profile(profile_name)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/task/init.py", line 261, in setup_profile
    adapter = self.ask_for_adapter_choice()
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/task/init.py", line 242, in ask_for_adapter_choice
    numeric_choice = click.prompt(prompt_msg, type=click.INT)
  File "/opt/homebrew/lib/python3.10/site-packages/click/termui.py", line 164, in prompt
    value = prompt_func(prompt)
  File "/opt/homebrew/lib/python3.10/site-packages/click/termui.py", line 147, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m14:39:02.177627 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": false, "command_wall_clock_time": 43.60404, "process_in_blocks": "0", "process_kernel_time": 0.102766, "process_mem_max_rss": "93437952", "process_out_blocks": "0", "process_user_time": 0.680921}
[0m14:39:02.178443 [debug] [MainThread]: Command `dbt init` failed at 14:39:02.178259 after 43.61 seconds
[0m14:39:02.179643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e1270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f463b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f38c40>]}
[0m14:39:02.180363 [debug] [MainThread]: Flushing usage events
[0m14:39:40.135835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc10c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748af80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748a830>]}


============================== 14:39:40.144450 | 02106791-93b4-4683-aac5-d9237586ed27 ==============================
[0m14:39:40.144450 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:39:40.145011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt init duckdb_dbt_sample', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:39:40.163566 [info ] [MainThread]: Setting up your profile.
[0m16:11:39.265045 [error] [MainThread]: Encountered an error:

[0m16:11:39.273473 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/main.py", line 477, in init
    results = task.run()
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/task/init.py", line 320, in run
    self.setup_profile(profile_name)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/task/init.py", line 248, in setup_profile
    if not self.check_if_can_write_profile(profile_name=profile_name):
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/task/init.py", line 211, in check_if_can_write_profile
    response = click.confirm(
  File "/opt/homebrew/lib/python3.10/site-packages/click/termui.py", line 235, in confirm
    raise Abort() from None
click.exceptions.Abort

[0m16:11:39.284745 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": false, "command_wall_clock_time": 4418.7456, "process_in_blocks": "0", "process_kernel_time": 0.144673, "process_mem_max_rss": "92717056", "process_out_blocks": "0", "process_user_time": 0.818773}
[0m16:11:39.285347 [debug] [MainThread]: Command `dbt init` failed at 16:11:39.285214 after 4418.75 seconds
[0m16:11:39.286035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc10c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107489c90>]}
[0m16:11:39.286685 [debug] [MainThread]: Flushing usage events
[0m16:11:39.304783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:49.640192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b9d120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dbb130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dba9e0>]}


============================== 16:11:49.643967 | cb56e93c-9a26-4e33-a362-4eeba3f4babf ==============================
[0m16:11:49.643967 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:11:49.644323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:11:49.735678 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:11:49.736006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cb56e93c-9a26-4e33-a362-4eeba3f4babf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0d1b0>]}
[0m16:11:49.736289 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:11:49.736483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cb56e93c-9a26-4e33-a362-4eeba3f4babf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0ee60>]}
[0m16:11:49.814377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb56e93c-9a26-4e33-a362-4eeba3f4babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e95960>]}
[0m16:11:49.848464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb56e93c-9a26-4e33-a362-4eeba3f4babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c45870>]}
[0m16:11:49.852050 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:11:49.925613 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:11:50.005118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:50.005512 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:50.036338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb56e93c-9a26-4e33-a362-4eeba3f4babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107423e50>]}
[0m16:11:50.086782 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:11:50.088457 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:11:50.102619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb56e93c-9a26-4e33-a362-4eeba3f4babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073dc8e0>]}
[0m16:11:50.102990 [info ] [MainThread]: Found 1 model, 1 seed, 426 macros
[0m16:11:50.103196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb56e93c-9a26-4e33-a362-4eeba3f4babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073dc7c0>]}
[0m16:11:50.104377 [info ] [MainThread]: 
[0m16:11:50.104785 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:50.105003 [info ] [MainThread]: 
[0m16:11:50.105395 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:11:50.105993 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:11:50.144414 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:11:50.144695 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:11:50.144875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:50.191764 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m16:11:50.192773 [debug] [ThreadPool]: On list_dev: Close
[0m16:11:50.194637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:11:50.195065 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:11:50.200323 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:11:50.200602 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:11:50.200777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:50.207041 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:11:50.208290 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:11:50.208533 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:11:50.208883 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:11:50.209070 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:11:50.209267 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:11:50.209914 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:11:50.210417 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:11:50.210597 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:11:50.210750 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:11:50.210990 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:11:50.211167 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:11:50.215562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:11:50.219135 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:11:50.219393 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:11:50.219562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:50.226642 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m16:11:50.227091 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:11:50.227322 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:11:50.240366 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:11:50.241330 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:11:50.242037 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:11:50.242257 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:11:50.243911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb56e93c-9a26-4e33-a362-4eeba3f4babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073dec20>]}
[0m16:11:50.244225 [debug] [MainThread]: Using duckdb connection "master"
[0m16:11:50.244402 [debug] [MainThread]: On master: BEGIN
[0m16:11:50.244561 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:50.250568 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m16:11:50.250857 [debug] [MainThread]: On master: COMMIT
[0m16:11:50.251041 [debug] [MainThread]: Using duckdb connection "master"
[0m16:11:50.251205 [debug] [MainThread]: On master: COMMIT
[0m16:11:50.251446 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:11:50.251630 [debug] [MainThread]: On master: Close
[0m16:11:50.253207 [debug] [Thread-1 (]: Began running node model.duckdb_dbt_sample.sample_model
[0m16:11:50.253580 [info ] [Thread-1 (]: 1 of 1 START sql view model main.sample_model .................................. [RUN]
[0m16:11:50.253924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_dbt_sample.sample_model)
[0m16:11:50.254179 [debug] [Thread-1 (]: Began compiling node model.duckdb_dbt_sample.sample_model
[0m16:11:50.260586 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_dbt_sample.sample_model"
[0m16:11:50.261081 [debug] [Thread-1 (]: Began executing node model.duckdb_dbt_sample.sample_model
[0m16:11:50.284281 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_dbt_sample.sample_model"
[0m16:11:50.284872 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:11:50.285121 [debug] [Thread-1 (]: On model.duckdb_dbt_sample.sample_model: BEGIN
[0m16:11:50.285316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:50.293527 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:11:50.294516 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:11:50.294800 [debug] [Thread-1 (]: On model.duckdb_dbt_sample.sample_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */

  
  create view "dev"."main"."sample_model__dbt_tmp" as (
    -- models/sample_model.sql
select
    *
from
    { { ref('sample_data') } }
  );

[0m16:11:50.298265 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */

  
  create view "dev"."main"."sample_model__dbt_tmp" as (
    -- models/sample_model.sql
select
    *
from
    { { ref('sample_data') } }
  );

[0m16:11:50.298629 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:11:50.298953 [debug] [Thread-1 (]: On model.duckdb_dbt_sample.sample_model: ROLLBACK
[0m16:11:50.305404 [debug] [Thread-1 (]: Failed to rollback 'model.duckdb_dbt_sample.sample_model'
[0m16:11:50.306476 [debug] [Thread-1 (]: On model.duckdb_dbt_sample.sample_model: Close
[0m16:11:50.310327 [debug] [Thread-1 (]: Runtime Error in model sample_model (models/sample_model.sql)
  Parser Error: syntax error at or near "{"
[0m16:11:50.311796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb56e93c-9a26-4e33-a362-4eeba3f4babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808eb60>]}
[0m16:11:50.312234 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.sample_model ......................... [[31mERROR[0m in 0.06s]
[0m16:11:50.312575 [debug] [Thread-1 (]: Finished running node model.duckdb_dbt_sample.sample_model
[0m16:11:50.313832 [debug] [Thread-4 (]: Marking all children of 'model.duckdb_dbt_sample.sample_model' to be skipped because of status 'error'.  Reason: Runtime Error in model sample_model (models/sample_model.sql)
  Parser Error: syntax error at or near "{".
[0m16:11:50.315117 [debug] [MainThread]: Using duckdb connection "master"
[0m16:11:50.315353 [debug] [MainThread]: On master: BEGIN
[0m16:11:50.315527 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:50.321830 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m16:11:50.322252 [debug] [MainThread]: On master: COMMIT
[0m16:11:50.322462 [debug] [MainThread]: Using duckdb connection "master"
[0m16:11:50.322660 [debug] [MainThread]: On master: COMMIT
[0m16:11:50.322948 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:11:50.323192 [debug] [MainThread]: On master: Close
[0m16:11:50.324769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:50.325144 [debug] [MainThread]: Connection 'model.duckdb_dbt_sample.sample_model' was properly closed.
[0m16:11:50.325412 [info ] [MainThread]: 
[0m16:11:50.325710 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m16:11:50.326244 [debug] [MainThread]: Command end result
[0m16:11:50.342165 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:11:50.343243 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:11:50.349168 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m16:11:50.349617 [info ] [MainThread]: 
[0m16:11:50.349876 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:11:50.350064 [info ] [MainThread]: 
[0m16:11:50.350278 [error] [MainThread]:   Runtime Error in model sample_model (models/sample_model.sql)
  Parser Error: syntax error at or near "{"
[0m16:11:50.350441 [info ] [MainThread]: 
[0m16:11:50.350617 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:11:50.351644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7629257, "process_in_blocks": "0", "process_kernel_time": 0.284224, "process_mem_max_rss": "135348224", "process_out_blocks": "0", "process_user_time": 1.413252}
[0m16:11:50.351890 [debug] [MainThread]: Command `dbt run` failed at 16:11:50.351843 after 0.76 seconds
[0m16:11:50.352119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b9d120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734ee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108157af0>]}
[0m16:11:50.352373 [debug] [MainThread]: Flushing usage events
[0m16:11:51.482082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:15:07.345307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110152310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ccf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113cc220>]}


============================== 16:15:07.363240 | a180c69d-c81e-413a-86e3-1d22f06a880b ==============================
[0m16:15:07.363240 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:15:07.363791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:15:07.394476 [info ] [MainThread]: dbt version: 1.9.2
[0m16:15:07.394771 [info ] [MainThread]: python version: 3.9.21
[0m16:15:07.395038 [info ] [MainThread]: python path: /Users/takeshiiijima/Library/Caches/pypoetry/virtualenvs/duckdb-dbt-aeGIh8AP-py3.9/bin/python
[0m16:15:07.395263 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit
[0m16:15:08.194870 [info ] [MainThread]: Using profiles dir at /Users/takeshiiijima/.dbt
[0m16:15:08.195220 [info ] [MainThread]: Using profiles.yml file at /Users/takeshiiijima/.dbt/profiles.yml
[0m16:15:08.195415 [info ] [MainThread]: Using dbt_project.yml file at /Users/takeshiiijima/github/duckdb-dbt/dbt_project.yml
[0m16:15:08.197813 [info ] [MainThread]: adapter type: duckdb
[0m16:15:08.198066 [info ] [MainThread]: adapter version: 1.9.1
[0m16:15:08.199907 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:15:08.200152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a180c69d-c81e-413a-86e3-1d22f06a880b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115fa700>]}
[0m16:15:08.200595 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:15:08.200861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a180c69d-c81e-413a-86e3-1d22f06a880b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115fa280>]}
[0m16:15:08.253618 [info ] [MainThread]: Configuration:
[0m16:15:08.253961 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:15:08.254195 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:15:08.254391 [info ] [MainThread]: Required dependencies:
[0m16:15:08.254623 [debug] [MainThread]: Executing "git --help"
[0m16:15:08.273960 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:15:08.274898 [debug] [MainThread]: STDERR: "b''"
[0m16:15:08.275168 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:15:08.275385 [info ] [MainThread]: Connection:
[0m16:15:08.275602 [info ] [MainThread]:   database: dev
[0m16:15:08.275766 [info ] [MainThread]:   schema: main
[0m16:15:08.275949 [info ] [MainThread]:   path: dev.duckdb
[0m16:15:08.276113 [info ] [MainThread]:   config_options: None
[0m16:15:08.276273 [info ] [MainThread]:   extensions: None
[0m16:15:08.276431 [info ] [MainThread]:   settings: {}
[0m16:15:08.276664 [info ] [MainThread]:   external_root: .
[0m16:15:08.276889 [info ] [MainThread]:   use_credential_provider: None
[0m16:15:08.277066 [info ] [MainThread]:   attach: None
[0m16:15:08.277236 [info ] [MainThread]:   filesystems: None
[0m16:15:08.277401 [info ] [MainThread]:   remote: None
[0m16:15:08.277563 [info ] [MainThread]:   plugins: None
[0m16:15:08.277725 [info ] [MainThread]:   disable_transactions: False
[0m16:15:08.278144 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:15:08.356539 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m16:15:08.389925 [debug] [MainThread]: Using duckdb connection "debug"
[0m16:15:08.390265 [debug] [MainThread]: On debug: select 1 as id
[0m16:15:08.390463 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:08.405060 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m16:15:08.405779 [debug] [MainThread]: On debug: Close
[0m16:15:08.407234 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:15:08.407515 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:15:08.408878 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.1082189, "process_in_blocks": "0", "process_kernel_time": 0.422153, "process_mem_max_rss": "134365184", "process_out_blocks": "0", "process_user_time": 1.658138}
[0m16:15:08.409215 [debug] [MainThread]: Command `dbt debug` succeeded at 16:15:08.409156 after 1.11 seconds
[0m16:15:08.409452 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:15:08.409700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110152310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117ae310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111436dc0>]}
[0m16:15:08.410027 [debug] [MainThread]: Flushing usage events
[0m16:15:09.449125 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:15:16.402744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099afd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099afee0>]}


============================== 16:15:16.405995 | 3907b970-24b9-4ac6-ac66-a2c4d3cae76c ==============================
[0m16:15:16.405995 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:15:16.406530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:15:16.471331 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:15:16.471708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3907b970-24b9-4ac6-ac66-a2c4d3cae76c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ac4e20>]}
[0m16:15:16.471991 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:15:16.472192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3907b970-24b9-4ac6-ac66-a2c4d3cae76c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ac48b0>]}
[0m16:15:16.532835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3907b970-24b9-4ac6-ac66-a2c4d3cae76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099813a0>]}
[0m16:15:16.563656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3907b970-24b9-4ac6-ac66-a2c4d3cae76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094178b0>]}
[0m16:15:16.565825 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:15:16.637175 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:15:16.708543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:16.709644 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:16.733205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3907b970-24b9-4ac6-ac66-a2c4d3cae76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ff0fd0>]}
[0m16:15:16.774868 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:15:16.776313 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:15:16.797005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3907b970-24b9-4ac6-ac66-a2c4d3cae76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ff5f10>]}
[0m16:15:16.797377 [info ] [MainThread]: Found 1 model, 1 seed, 426 macros
[0m16:15:16.797600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3907b970-24b9-4ac6-ac66-a2c4d3cae76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ff5eb0>]}
[0m16:15:16.798439 [info ] [MainThread]: 
[0m16:15:16.798674 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:15:16.798847 [info ] [MainThread]: 
[0m16:15:16.799148 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:15:16.799641 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:15:16.833096 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:15:16.833377 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:15:16.833563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:16.841625 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m16:15:16.842553 [debug] [ThreadPool]: On list_dev: Close
[0m16:15:16.843835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:15:16.844115 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:15:16.848155 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:15:16.848404 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:15:16.848583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:16.853881 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:15:16.854678 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:15:16.854887 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:15:16.855145 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:15:16.855320 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:15:16.855487 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:15:16.855858 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:15:16.856856 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:15:16.857079 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:15:16.857252 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:15:16.857552 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:15:16.857738 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:15:16.861596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:15:16.865144 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:15:16.865386 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:15:16.865564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:16.870708 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:15:16.870938 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:15:16.871132 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:15:16.881645 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:15:16.882499 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:15:16.883134 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:15:16.883340 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:15:16.884775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3907b970-24b9-4ac6-ac66-a2c4d3cae76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a813880>]}
[0m16:15:16.885060 [debug] [MainThread]: Using duckdb connection "master"
[0m16:15:16.885233 [debug] [MainThread]: On master: BEGIN
[0m16:15:16.885391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:16.890729 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:15:16.891054 [debug] [MainThread]: On master: COMMIT
[0m16:15:16.891242 [debug] [MainThread]: Using duckdb connection "master"
[0m16:15:16.891410 [debug] [MainThread]: On master: COMMIT
[0m16:15:16.891652 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:15:16.891828 [debug] [MainThread]: On master: Close
[0m16:15:16.893287 [debug] [Thread-1  ]: Began running node model.duckdb_dbt_sample.sample_model
[0m16:15:16.893611 [info ] [Thread-1  ]: 1 of 1 START sql view model main.sample_model .................................. [RUN]
[0m16:15:16.893886 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_dbt_sample.sample_model)
[0m16:15:16.894094 [debug] [Thread-1  ]: Began compiling node model.duckdb_dbt_sample.sample_model
[0m16:15:16.898497 [debug] [Thread-1  ]: Writing injected SQL for node "model.duckdb_dbt_sample.sample_model"
[0m16:15:16.898965 [debug] [Thread-1  ]: Began executing node model.duckdb_dbt_sample.sample_model
[0m16:15:16.917662 [debug] [Thread-1  ]: Writing runtime sql for node "model.duckdb_dbt_sample.sample_model"
[0m16:15:16.918187 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:15:16.918398 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: BEGIN
[0m16:15:16.918589 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:15:16.924035 [debug] [Thread-1  ]: SQL status: OK in 0.005 seconds
[0m16:15:16.924350 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:15:16.924560 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */

  
  create view "dev"."main"."sample_model__dbt_tmp" as (
    -- models/sample_model.sql
select
    *
from
    { { ref('sample_data') } }
  );

[0m16:15:16.925204 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */

  
  create view "dev"."main"."sample_model__dbt_tmp" as (
    -- models/sample_model.sql
select
    *
from
    { { ref('sample_data') } }
  );

[0m16:15:16.925417 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m16:15:16.925693 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: ROLLBACK
[0m16:15:16.928622 [debug] [Thread-1  ]: Failed to rollback 'model.duckdb_dbt_sample.sample_model'
[0m16:15:16.928825 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: Close
[0m16:15:16.930521 [debug] [Thread-1  ]: Runtime Error in model sample_model (models/sample_model.sql)
  Parser Error: syntax error at or near "{"
[0m16:15:16.931971 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3907b970-24b9-4ac6-ac66-a2c4d3cae76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad2f5b0>]}
[0m16:15:16.932346 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model main.sample_model ......................... [[31mERROR[0m in 0.04s]
[0m16:15:16.932659 [debug] [Thread-1  ]: Finished running node model.duckdb_dbt_sample.sample_model
[0m16:15:16.932969 [debug] [Thread-4  ]: Marking all children of 'model.duckdb_dbt_sample.sample_model' to be skipped because of status 'error'.  Reason: Runtime Error in model sample_model (models/sample_model.sql)
  Parser Error: syntax error at or near "{".
[0m16:15:16.933580 [debug] [MainThread]: Using duckdb connection "master"
[0m16:15:16.933811 [debug] [MainThread]: On master: BEGIN
[0m16:15:16.933995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:15:16.940045 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m16:15:16.940453 [debug] [MainThread]: On master: COMMIT
[0m16:15:16.940692 [debug] [MainThread]: Using duckdb connection "master"
[0m16:15:16.940924 [debug] [MainThread]: On master: COMMIT
[0m16:15:16.941403 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:15:16.941622 [debug] [MainThread]: On master: Close
[0m16:15:16.942977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:16.943231 [debug] [MainThread]: Connection 'model.duckdb_dbt_sample.sample_model' was properly closed.
[0m16:15:16.943426 [info ] [MainThread]: 
[0m16:15:16.943627 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m16:15:16.944241 [debug] [MainThread]: Command end result
[0m16:15:16.957226 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:15:16.958281 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:15:16.961630 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m16:15:16.961831 [info ] [MainThread]: 
[0m16:15:16.962063 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:15:16.962678 [info ] [MainThread]: 
[0m16:15:16.962950 [error] [MainThread]:   Runtime Error in model sample_model (models/sample_model.sql)
  Parser Error: syntax error at or near "{"
[0m16:15:16.963139 [info ] [MainThread]: 
[0m16:15:16.963337 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:15:16.964275 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6022632, "process_in_blocks": "0", "process_kernel_time": 0.18251, "process_mem_max_rss": "133709824", "process_out_blocks": "0", "process_user_time": 1.151297}
[0m16:15:16.964526 [debug] [MainThread]: Command `dbt run` failed at 16:15:16.964481 after 0.60 seconds
[0m16:15:16.964772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094178b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce9670>]}
[0m16:15:16.965076 [debug] [MainThread]: Flushing usage events
[0m16:15:17.751959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:15:25.205846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f47eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ff0d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ff0ee0>]}


============================== 16:15:25.210066 | 5e518145-a965-4db8-ab4d-279e0bcbb2eb ==============================
[0m16:15:25.210066 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:15:25.210511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:15:25.277394 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:15:25.277746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5e518145-a965-4db8-ab4d-279e0bcbb2eb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111203e20>]}
[0m16:15:25.278028 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:15:25.278228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5e518145-a965-4db8-ab4d-279e0bcbb2eb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112038b0>]}
[0m16:15:25.334396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e518145-a965-4db8-ab4d-279e0bcbb2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc13a0>]}
[0m16:15:25.364002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e518145-a965-4db8-ab4d-279e0bcbb2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108578b0>]}
[0m16:15:25.367390 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:15:25.438024 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:15:25.504864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:25.505178 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:25.528544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e518145-a965-4db8-ab4d-279e0bcbb2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11162ffd0>]}
[0m16:15:25.569856 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:15:25.570893 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:15:25.581638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e518145-a965-4db8-ab4d-279e0bcbb2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111646820>]}
[0m16:15:25.581980 [info ] [MainThread]: Found 1 model, 1 seed, 426 macros
[0m16:15:25.582194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e518145-a965-4db8-ab4d-279e0bcbb2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11164b940>]}
[0m16:15:25.582933 [info ] [MainThread]: 
[0m16:15:25.583149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:15:25.583322 [info ] [MainThread]: 
[0m16:15:25.583603 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:15:25.584100 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:15:25.616928 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:15:25.617223 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:15:25.617404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:25.624461 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m16:15:25.625306 [debug] [ThreadPool]: On list_dev: Close
[0m16:15:25.626587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:15:25.626894 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:15:25.630994 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:15:25.631274 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:15:25.631466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:25.636872 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:15:25.637688 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:15:25.637896 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:15:25.638160 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:15:25.638339 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:15:25.638510 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:15:25.638776 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:15:25.639262 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:15:25.639463 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:15:25.639742 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:15:25.640072 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:15:25.640257 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:15:25.644352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:15:25.648004 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:15:25.648266 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:15:25.648459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:25.653930 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:15:25.654254 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:15:25.654481 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:15:25.665421 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m16:15:25.666298 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:15:25.667002 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:15:25.667209 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:15:25.668690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e518145-a965-4db8-ab4d-279e0bcbb2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11170c2e0>]}
[0m16:15:25.668971 [debug] [MainThread]: Using duckdb connection "master"
[0m16:15:25.669139 [debug] [MainThread]: On master: BEGIN
[0m16:15:25.669295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:25.675226 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m16:15:25.675641 [debug] [MainThread]: On master: COMMIT
[0m16:15:25.675835 [debug] [MainThread]: Using duckdb connection "master"
[0m16:15:25.675999 [debug] [MainThread]: On master: COMMIT
[0m16:15:25.676252 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:15:25.676434 [debug] [MainThread]: On master: Close
[0m16:15:25.677933 [debug] [Thread-1  ]: Began running node model.duckdb_dbt_sample.sample_model
[0m16:15:25.678280 [info ] [Thread-1  ]: 1 of 1 START sql view model main.sample_model .................................. [RUN]
[0m16:15:25.678574 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_dbt_sample.sample_model)
[0m16:15:25.678861 [debug] [Thread-1  ]: Began compiling node model.duckdb_dbt_sample.sample_model
[0m16:15:25.683399 [debug] [Thread-1  ]: Writing injected SQL for node "model.duckdb_dbt_sample.sample_model"
[0m16:15:25.683888 [debug] [Thread-1  ]: Began executing node model.duckdb_dbt_sample.sample_model
[0m16:15:25.703123 [debug] [Thread-1  ]: Writing runtime sql for node "model.duckdb_dbt_sample.sample_model"
[0m16:15:25.703694 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:15:25.703912 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: BEGIN
[0m16:15:25.704105 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:15:25.709885 [debug] [Thread-1  ]: SQL status: OK in 0.006 seconds
[0m16:15:25.710235 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:15:25.710463 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */

  
  create view "dev"."main"."sample_model__dbt_tmp" as (
    -- models/sample_model.sql
select
    *
from
    { { ref('sample_data') } }
  );

[0m16:15:25.710875 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */

  
  create view "dev"."main"."sample_model__dbt_tmp" as (
    -- models/sample_model.sql
select
    *
from
    { { ref('sample_data') } }
  );

[0m16:15:25.711089 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m16:15:25.711376 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: ROLLBACK
[0m16:15:25.714669 [debug] [Thread-1  ]: Failed to rollback 'model.duckdb_dbt_sample.sample_model'
[0m16:15:25.715021 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: Close
[0m16:15:25.716534 [debug] [Thread-1  ]: Runtime Error in model sample_model (models/sample_model.sql)
  Parser Error: syntax error at or near "{"
[0m16:15:25.717694 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e518145-a965-4db8-ab4d-279e0bcbb2eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d05640>]}
[0m16:15:25.718109 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model main.sample_model ......................... [[31mERROR[0m in 0.04s]
[0m16:15:25.718450 [debug] [Thread-1  ]: Finished running node model.duckdb_dbt_sample.sample_model
[0m16:15:25.718747 [debug] [Thread-4  ]: Marking all children of 'model.duckdb_dbt_sample.sample_model' to be skipped because of status 'error'.  Reason: Runtime Error in model sample_model (models/sample_model.sql)
  Parser Error: syntax error at or near "{".
[0m16:15:25.719354 [debug] [MainThread]: Using duckdb connection "master"
[0m16:15:25.719553 [debug] [MainThread]: On master: BEGIN
[0m16:15:25.719715 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:15:25.725594 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m16:15:25.725928 [debug] [MainThread]: On master: COMMIT
[0m16:15:25.726133 [debug] [MainThread]: Using duckdb connection "master"
[0m16:15:25.726308 [debug] [MainThread]: On master: COMMIT
[0m16:15:25.726568 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:15:25.726747 [debug] [MainThread]: On master: Close
[0m16:15:25.727853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:25.728068 [debug] [MainThread]: Connection 'model.duckdb_dbt_sample.sample_model' was properly closed.
[0m16:15:25.728263 [info ] [MainThread]: 
[0m16:15:25.728462 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m16:15:25.728836 [debug] [MainThread]: Command end result
[0m16:15:25.742930 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:15:25.743975 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:15:25.748125 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m16:15:25.748414 [info ] [MainThread]: 
[0m16:15:25.748665 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:15:25.748860 [info ] [MainThread]: 
[0m16:15:25.749071 [error] [MainThread]:   Runtime Error in model sample_model (models/sample_model.sql)
  Parser Error: syntax error at or near "{"
[0m16:15:25.749249 [info ] [MainThread]: 
[0m16:15:25.749758 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:15:25.751139 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5862938, "process_in_blocks": "0", "process_kernel_time": 0.190865, "process_mem_max_rss": "134086656", "process_out_blocks": "0", "process_user_time": 1.144355}
[0m16:15:25.751410 [debug] [MainThread]: Command `dbt run` failed at 16:15:25.751367 after 0.59 seconds
[0m16:15:25.751636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f47eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108578b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a6760>]}
[0m16:15:25.751854 [debug] [MainThread]: Flushing usage events
[0m16:15:26.557916 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:15:40.816015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103449e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104300d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104300ee0>]}


============================== 16:15:40.818748 | d36fe9cc-dce3-4673-be66-a7d4ecd102e1 ==============================
[0m16:15:40.818748 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:15:40.819113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:15:40.895600 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:15:40.896040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd36fe9cc-dce3-4673-be66-a7d4ecd102e1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104412520>]}
[0m16:15:40.896409 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:15:40.896619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd36fe9cc-dce3-4673-be66-a7d4ecd102e1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104412ee0>]}
[0m16:15:40.952247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd36fe9cc-dce3-4673-be66-a7d4ecd102e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043cd8e0>]}
[0m16:15:40.983914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd36fe9cc-dce3-4673-be66-a7d4ecd102e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e01d30>]}
[0m16:15:40.986265 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:15:41.061536 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:15:41.125881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:41.126167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:41.149133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd36fe9cc-dce3-4673-be66-a7d4ecd102e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104840f40>]}
[0m16:15:41.189636 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:15:41.190910 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:15:41.200941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd36fe9cc-dce3-4673-be66-a7d4ecd102e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048572b0>]}
[0m16:15:41.201318 [info ] [MainThread]: Found 1 model, 1 seed, 426 macros
[0m16:15:41.201541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd36fe9cc-dce3-4673-be66-a7d4ecd102e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104867d30>]}
[0m16:15:41.202269 [info ] [MainThread]: 
[0m16:15:41.202477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:15:41.202651 [info ] [MainThread]: 
[0m16:15:41.202947 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:15:41.203444 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:15:41.237769 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:15:41.238046 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:15:41.238227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:41.284486 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m16:15:41.285447 [debug] [ThreadPool]: On list_dev: Close
[0m16:15:41.287193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:15:41.287492 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:15:41.291360 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:15:41.291603 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:15:41.291813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:41.297990 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:15:41.299231 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:15:41.299426 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:15:41.299681 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:15:41.299853 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:15:41.300018 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:15:41.300508 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:15:41.301017 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:15:41.301203 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:15:41.301366 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:15:41.301595 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:15:41.301775 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:15:41.305488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:15:41.309052 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:15:41.309346 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:15:41.309529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:41.315326 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:15:41.315615 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:15:41.315810 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:15:41.327779 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m16:15:41.328644 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:15:41.329280 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:15:41.329482 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:15:41.331046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd36fe9cc-dce3-4673-be66-a7d4ecd102e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10446a7c0>]}
[0m16:15:41.331356 [debug] [MainThread]: Using duckdb connection "master"
[0m16:15:41.331527 [debug] [MainThread]: On master: BEGIN
[0m16:15:41.331686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:41.336863 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:15:41.337098 [debug] [MainThread]: On master: COMMIT
[0m16:15:41.337269 [debug] [MainThread]: Using duckdb connection "master"
[0m16:15:41.337424 [debug] [MainThread]: On master: COMMIT
[0m16:15:41.337638 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:15:41.337816 [debug] [MainThread]: On master: Close
[0m16:15:41.339230 [debug] [Thread-1  ]: Began running node model.duckdb_dbt_sample.sample_model
[0m16:15:41.339531 [info ] [Thread-1  ]: 1 of 1 START sql view model main.sample_model .................................. [RUN]
[0m16:15:41.339790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_dbt_sample.sample_model)
[0m16:15:41.339996 [debug] [Thread-1  ]: Began compiling node model.duckdb_dbt_sample.sample_model
[0m16:15:41.344236 [debug] [Thread-1  ]: Writing injected SQL for node "model.duckdb_dbt_sample.sample_model"
[0m16:15:41.344859 [debug] [Thread-1  ]: Began executing node model.duckdb_dbt_sample.sample_model
[0m16:15:41.362730 [debug] [Thread-1  ]: Writing runtime sql for node "model.duckdb_dbt_sample.sample_model"
[0m16:15:41.363682 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:15:41.364017 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: BEGIN
[0m16:15:41.364302 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:15:41.369428 [debug] [Thread-1  ]: SQL status: OK in 0.005 seconds
[0m16:15:41.369685 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:15:41.369908 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */

  
  create view "dev"."main"."sample_model__dbt_tmp" as (
    -- models/sample_model.sql
select
    *
from
    { { ref('sample_data') } }
  );

[0m16:15:41.372357 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */

  
  create view "dev"."main"."sample_model__dbt_tmp" as (
    -- models/sample_model.sql
select
    *
from
    { { ref('sample_data') } }
  );

[0m16:15:41.372562 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m16:15:41.372830 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: ROLLBACK
[0m16:15:41.375914 [debug] [Thread-1  ]: Failed to rollback 'model.duckdb_dbt_sample.sample_model'
[0m16:15:41.376237 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: Close
[0m16:15:41.378052 [debug] [Thread-1  ]: Runtime Error in model sample_model (models/sample_model.sql)
  Parser Error: syntax error at or near "{"
[0m16:15:41.379535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd36fe9cc-dce3-4673-be66-a7d4ecd102e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10334d4c0>]}
[0m16:15:41.380227 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model main.sample_model ......................... [[31mERROR[0m in 0.04s]
[0m16:15:41.380612 [debug] [Thread-1  ]: Finished running node model.duckdb_dbt_sample.sample_model
[0m16:15:41.380939 [debug] [Thread-4  ]: Marking all children of 'model.duckdb_dbt_sample.sample_model' to be skipped because of status 'error'.  Reason: Runtime Error in model sample_model (models/sample_model.sql)
  Parser Error: syntax error at or near "{".
[0m16:15:41.381554 [debug] [MainThread]: Using duckdb connection "master"
[0m16:15:41.381754 [debug] [MainThread]: On master: BEGIN
[0m16:15:41.381914 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:15:41.387245 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:15:41.387513 [debug] [MainThread]: On master: COMMIT
[0m16:15:41.387686 [debug] [MainThread]: Using duckdb connection "master"
[0m16:15:41.387843 [debug] [MainThread]: On master: COMMIT
[0m16:15:41.388056 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:15:41.388234 [debug] [MainThread]: On master: Close
[0m16:15:41.389227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:41.389406 [debug] [MainThread]: Connection 'model.duckdb_dbt_sample.sample_model' was properly closed.
[0m16:15:41.389586 [info ] [MainThread]: 
[0m16:15:41.389774 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m16:15:41.390148 [debug] [MainThread]: Command end result
[0m16:15:41.403725 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:15:41.404773 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:15:41.409316 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m16:15:41.409718 [info ] [MainThread]: 
[0m16:15:41.410010 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:15:41.410276 [info ] [MainThread]: 
[0m16:15:41.410514 [error] [MainThread]:   Runtime Error in model sample_model (models/sample_model.sql)
  Parser Error: syntax error at or near "{"
[0m16:15:41.410697 [info ] [MainThread]: 
[0m16:15:41.410886 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:15:41.411850 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6372352, "process_in_blocks": "0", "process_kernel_time": 0.185183, "process_mem_max_rss": "132890624", "process_out_blocks": "0", "process_user_time": 1.090423}
[0m16:15:41.412120 [debug] [MainThread]: Command `dbt run` failed at 16:15:41.412074 after 0.64 seconds
[0m16:15:41.412372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103449e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e01d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104857850>]}
[0m16:15:41.412607 [debug] [MainThread]: Flushing usage events
[0m16:15:42.184902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:38.430683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103399e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d70d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d70ee0>]}


============================== 16:16:38.433707 | 5501bea4-708f-4aec-94fd-6f3fe5bdc4ec ==============================
[0m16:16:38.433707 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:16:38.434058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:16:38.566939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5501bea4-708f-4aec-94fd-6f3fe5bdc4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024834f0>]}
[0m16:16:38.596547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5501bea4-708f-4aec-94fd-6f3fe5bdc4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104671d30>]}
[0m16:16:38.599128 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:16:38.669609 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:16:38.716926 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:16:38.717300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5501bea4-708f-4aec-94fd-6f3fe5bdc4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d7f70>]}
[0m16:16:39.311576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5501bea4-708f-4aec-94fd-6f3fe5bdc4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6e130>]}
[0m16:16:39.351270 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:16:39.352308 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:16:39.361302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5501bea4-708f-4aec-94fd-6f3fe5bdc4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e82940>]}
[0m16:16:39.361734 [info ] [MainThread]: Found 1 model, 1 seed, 426 macros
[0m16:16:39.361939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5501bea4-708f-4aec-94fd-6f3fe5bdc4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e34340>]}
[0m16:16:39.363259 [info ] [MainThread]: 
[0m16:16:39.363566 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:16:39.363775 [info ] [MainThread]: 
[0m16:16:39.364081 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:16:39.364581 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:16:39.395432 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:16:39.395952 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:16:39.396509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:39.435730 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m16:16:39.436707 [debug] [ThreadPool]: On list_dev: Close
[0m16:16:39.438541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:16:39.438860 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:16:39.443212 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:16:39.443473 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:16:39.443665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:39.449299 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:16:39.450377 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:16:39.450593 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:16:39.450849 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:16:39.451025 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:16:39.451196 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:16:39.451641 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:16:39.452093 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:16:39.452263 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:16:39.452415 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:16:39.452626 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:16:39.452802 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:16:39.456378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:16:39.459781 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:16:39.460000 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:16:39.460167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:39.465736 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:16:39.466040 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:16:39.466235 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:16:39.476873 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:16:39.477617 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:16:39.478205 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:16:39.478382 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:16:39.479864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5501bea4-708f-4aec-94fd-6f3fe5bdc4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060722b0>]}
[0m16:16:39.480232 [debug] [MainThread]: Using duckdb connection "master"
[0m16:16:39.480411 [debug] [MainThread]: On master: BEGIN
[0m16:16:39.480564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:16:39.485511 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:16:39.485727 [debug] [MainThread]: On master: COMMIT
[0m16:16:39.485904 [debug] [MainThread]: Using duckdb connection "master"
[0m16:16:39.486067 [debug] [MainThread]: On master: COMMIT
[0m16:16:39.486289 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:16:39.486464 [debug] [MainThread]: On master: Close
[0m16:16:39.487833 [debug] [Thread-1  ]: Began running node model.duckdb_dbt_sample.sample_model
[0m16:16:39.488130 [info ] [Thread-1  ]: 1 of 1 START sql view model main.sample_model .................................. [RUN]
[0m16:16:39.488384 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_dbt_sample.sample_model)
[0m16:16:39.488590 [debug] [Thread-1  ]: Began compiling node model.duckdb_dbt_sample.sample_model
[0m16:16:39.493210 [debug] [Thread-1  ]: Writing injected SQL for node "model.duckdb_dbt_sample.sample_model"
[0m16:16:39.493681 [debug] [Thread-1  ]: Began executing node model.duckdb_dbt_sample.sample_model
[0m16:16:39.511994 [debug] [Thread-1  ]: Writing runtime sql for node "model.duckdb_dbt_sample.sample_model"
[0m16:16:39.512535 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:16:39.512746 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: BEGIN
[0m16:16:39.512935 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:16:39.518577 [debug] [Thread-1  ]: SQL status: OK in 0.006 seconds
[0m16:16:39.518863 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:16:39.519065 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */

  
  create view "dev"."main"."sample_model__dbt_tmp" as (
    -- models/sample_model.sql
select
    *
from
    "dev"."main"."sample_data"
  );

[0m16:16:39.519446 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:16:39.523112 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:16:39.523364 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */
alter view "dev"."main"."sample_model__dbt_tmp" rename to "sample_model"
[0m16:16:39.524216 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:16:39.530241 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: COMMIT
[0m16:16:39.530558 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:16:39.530757 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: COMMIT
[0m16:16:39.531616 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:16:39.535061 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:16:39.535283 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */
drop view if exists "dev"."main"."sample_model__dbt_backup" cascade
[0m16:16:39.535594 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:16:39.536909 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: Close
[0m16:16:39.540098 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5501bea4-708f-4aec-94fd-6f3fe5bdc4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102455fa0>]}
[0m16:16:39.540573 [info ] [Thread-1  ]: 1 of 1 OK created sql view model main.sample_model ............................. [[32mOK[0m in 0.05s]
[0m16:16:39.540900 [debug] [Thread-1  ]: Finished running node model.duckdb_dbt_sample.sample_model
[0m16:16:39.541509 [debug] [MainThread]: Using duckdb connection "master"
[0m16:16:39.541700 [debug] [MainThread]: On master: BEGIN
[0m16:16:39.541854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:16:39.547520 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m16:16:39.547865 [debug] [MainThread]: On master: COMMIT
[0m16:16:39.548067 [debug] [MainThread]: Using duckdb connection "master"
[0m16:16:39.548235 [debug] [MainThread]: On master: COMMIT
[0m16:16:39.548480 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:16:39.548669 [debug] [MainThread]: On master: Close
[0m16:16:39.549705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:39.549906 [debug] [MainThread]: Connection 'model.duckdb_dbt_sample.sample_model' was properly closed.
[0m16:16:39.550102 [info ] [MainThread]: 
[0m16:16:39.550291 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m16:16:39.550664 [debug] [MainThread]: Command end result
[0m16:16:39.562417 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:16:39.564186 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:16:39.568171 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m16:16:39.568432 [info ] [MainThread]: 
[0m16:16:39.568679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:16:39.568865 [info ] [MainThread]: 
[0m16:16:39.569055 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:16:39.569932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1804112, "process_in_blocks": "0", "process_kernel_time": 0.189701, "process_mem_max_rss": "137986048", "process_out_blocks": "0", "process_user_time": 1.666033}
[0m16:16:39.570154 [debug] [MainThread]: Command `dbt run` succeeded at 16:16:39.570112 after 1.18 seconds
[0m16:16:39.570367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103399e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e85520>]}
[0m16:16:39.570581 [debug] [MainThread]: Flushing usage events
[0m16:16:40.704930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:46.298551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f70d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f70ee0>]}


============================== 16:16:46.301712 | 31a41b0a-5ac4-443b-9f39-e5270650c10c ==============================
[0m16:16:46.301712 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:16:46.302061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:16:46.423053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31a41b0a-5ac4-443b-9f39-e5270650c10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b584f0>]}
[0m16:16:46.454062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31a41b0a-5ac4-443b-9f39-e5270650c10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106971d30>]}
[0m16:16:46.456441 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:16:46.529658 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:16:46.601929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:16:46.602517 [debug] [MainThread]: Partial parsing: updated file: duckdb_dbt_sample://models/sample_model.sql
[0m16:16:46.845028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31a41b0a-5ac4-443b-9f39-e5270650c10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11106a130>]}
[0m16:16:46.889550 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:16:46.891063 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:16:46.901936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31a41b0a-5ac4-443b-9f39-e5270650c10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec7700>]}
[0m16:16:46.902346 [info ] [MainThread]: Found 1 seed, 1 model, 426 macros
[0m16:16:46.902574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31a41b0a-5ac4-443b-9f39-e5270650c10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111042400>]}
[0m16:16:46.903421 [info ] [MainThread]: 
[0m16:16:46.903641 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:16:46.903817 [info ] [MainThread]: 
[0m16:16:46.904161 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:16:46.904647 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:16:46.937697 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:16:46.938014 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:16:46.938211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:46.945446 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m16:16:46.946459 [debug] [ThreadPool]: On list_dev: Close
[0m16:16:46.947769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:16:46.948057 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:16:46.951865 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:16:46.952088 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:16:46.952259 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:46.957680 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:16:46.958430 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:16:46.958614 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:16:46.958844 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:16:46.959004 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:16:46.959163 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:16:46.959418 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:16:46.959860 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:16:46.960027 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:16:46.960178 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:16:46.960388 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:16:46.960549 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:16:46.965307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:16:46.968975 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:16:46.969237 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:16:46.969434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:46.974821 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:16:46.975136 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:16:46.975341 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:16:46.985431 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:16:46.986375 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:16:46.987115 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:16:46.987324 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:16:46.988930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31a41b0a-5ac4-443b-9f39-e5270650c10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783c490>]}
[0m16:16:46.989244 [debug] [MainThread]: Using duckdb connection "master"
[0m16:16:46.989429 [debug] [MainThread]: On master: BEGIN
[0m16:16:46.989592 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:16:46.994751 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:16:46.995006 [debug] [MainThread]: On master: COMMIT
[0m16:16:46.995208 [debug] [MainThread]: Using duckdb connection "master"
[0m16:16:46.995377 [debug] [MainThread]: On master: COMMIT
[0m16:16:46.995610 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:16:46.995787 [debug] [MainThread]: On master: Close
[0m16:16:46.998016 [debug] [Thread-1  ]: Began running node model.duckdb_dbt_sample.sample_model
[0m16:16:46.998427 [info ] [Thread-1  ]: 1 of 1 START sql view model main.sample_model .................................. [RUN]
[0m16:16:46.998736 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_dbt_sample.sample_model)
[0m16:16:46.998957 [debug] [Thread-1  ]: Began compiling node model.duckdb_dbt_sample.sample_model
[0m16:16:47.003594 [debug] [Thread-1  ]: Writing injected SQL for node "model.duckdb_dbt_sample.sample_model"
[0m16:16:47.004087 [debug] [Thread-1  ]: Began executing node model.duckdb_dbt_sample.sample_model
[0m16:16:47.022271 [debug] [Thread-1  ]: Writing runtime sql for node "model.duckdb_dbt_sample.sample_model"
[0m16:16:47.022820 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:16:47.023034 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: BEGIN
[0m16:16:47.023226 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:16:47.029164 [debug] [Thread-1  ]: SQL status: OK in 0.006 seconds
[0m16:16:47.029579 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:16:47.029808 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */

  
  create view "dev"."main"."sample_model__dbt_tmp" as (
    select *
from "dev"."main"."sample_data"
  );

[0m16:16:47.030544 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:16:47.034290 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:16:47.034525 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */
alter view "dev"."main"."sample_model" rename to "sample_model__dbt_backup"
[0m16:16:47.034856 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:16:47.036472 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:16:47.036679 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */
alter view "dev"."main"."sample_model__dbt_tmp" rename to "sample_model"
[0m16:16:47.036969 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:16:47.043463 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: COMMIT
[0m16:16:47.043766 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:16:47.043964 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: COMMIT
[0m16:16:47.044576 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:16:47.048289 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:16:47.048540 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */
drop view if exists "dev"."main"."sample_model__dbt_backup" cascade
[0m16:16:47.049013 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:16:47.050559 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: Close
[0m16:16:47.053055 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31a41b0a-5ac4-443b-9f39-e5270650c10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b29fa0>]}
[0m16:16:47.053456 [info ] [Thread-1  ]: 1 of 1 OK created sql view model main.sample_model ............................. [[32mOK[0m in 0.05s]
[0m16:16:47.053777 [debug] [Thread-1  ]: Finished running node model.duckdb_dbt_sample.sample_model
[0m16:16:47.054342 [debug] [MainThread]: Using duckdb connection "master"
[0m16:16:47.054529 [debug] [MainThread]: On master: BEGIN
[0m16:16:47.054685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:16:47.059850 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:16:47.060109 [debug] [MainThread]: On master: COMMIT
[0m16:16:47.060704 [debug] [MainThread]: Using duckdb connection "master"
[0m16:16:47.060924 [debug] [MainThread]: On master: COMMIT
[0m16:16:47.061303 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:16:47.061502 [debug] [MainThread]: On master: Close
[0m16:16:47.062817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:47.063037 [debug] [MainThread]: Connection 'model.duckdb_dbt_sample.sample_model' was properly closed.
[0m16:16:47.063483 [info ] [MainThread]: 
[0m16:16:47.063743 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m16:16:47.064136 [debug] [MainThread]: Command end result
[0m16:16:47.109522 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:16:47.110499 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:16:47.114097 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m16:16:47.114336 [info ] [MainThread]: 
[0m16:16:47.114577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:16:47.114763 [info ] [MainThread]: 
[0m16:16:47.114955 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:16:47.115874 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.86032414, "process_in_blocks": "0", "process_kernel_time": 0.188752, "process_mem_max_rss": "137576448", "process_out_blocks": "0", "process_user_time": 1.318073}
[0m16:16:47.116113 [debug] [MainThread]: Command `dbt run` succeeded at 16:16:47.116072 after 0.86 seconds
[0m16:16:47.116328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e58b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c1b6a0>]}
[0m16:16:47.116541 [debug] [MainThread]: Flushing usage events
[0m16:16:47.870444 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:53.766946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db6df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a767c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a767e50>]}


============================== 16:16:53.769444 | e23e5359-ebba-4552-a3d9-325151656d82 ==============================
[0m16:16:53.769444 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:16:53.769805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:16:53.884364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e23e5359-ebba-4552-a3d9-325151656d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a61910>]}
[0m16:16:53.912661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e23e5359-ebba-4552-a3d9-325151656d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a741bb0>]}
[0m16:16:53.914722 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:16:53.983022 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:16:54.045497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:16:54.045776 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:16:54.068574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e23e5359-ebba-4552-a3d9-325151656d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adb2130>]}
[0m16:16:54.108974 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:16:54.110199 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:16:54.116132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e23e5359-ebba-4552-a3d9-325151656d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adde9d0>]}
[0m16:16:54.116461 [info ] [MainThread]: Found 1 seed, 1 model, 426 macros
[0m16:16:54.116682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e23e5359-ebba-4552-a3d9-325151656d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad8c670>]}
[0m16:16:54.117454 [info ] [MainThread]: 
[0m16:16:54.117675 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:16:54.117842 [info ] [MainThread]: 
[0m16:16:54.118143 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:16:54.120691 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m16:16:54.150015 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:16:54.150289 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:16:54.150461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:54.156529 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:16:54.156766 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:16:54.156946 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:16:54.167265 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:16:54.168180 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:16:54.168545 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:16:54.168718 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:16:54.170282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e23e5359-ebba-4552-a3d9-325151656d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9d4310>]}
[0m16:16:54.171434 [debug] [Thread-1  ]: Began running node seed.duckdb_dbt_sample.sample_data
[0m16:16:54.171710 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_main, now seed.duckdb_dbt_sample.sample_data)
[0m16:16:54.171922 [debug] [Thread-1  ]: Began compiling node seed.duckdb_dbt_sample.sample_data
[0m16:16:54.176131 [debug] [Thread-1  ]: Began executing node seed.duckdb_dbt_sample.sample_data
[0m16:16:54.176562 [debug] [Thread-1  ]: Finished running node seed.duckdb_dbt_sample.sample_data
[0m16:16:54.176952 [debug] [Thread-1  ]: Began running node model.duckdb_dbt_sample.sample_model
[0m16:16:54.177195 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.duckdb_dbt_sample.sample_data, now model.duckdb_dbt_sample.sample_model)
[0m16:16:54.177395 [debug] [Thread-1  ]: Began compiling node model.duckdb_dbt_sample.sample_model
[0m16:16:54.178961 [debug] [Thread-1  ]: Writing injected SQL for node "model.duckdb_dbt_sample.sample_model"
[0m16:16:54.179392 [debug] [Thread-1  ]: Began executing node model.duckdb_dbt_sample.sample_model
[0m16:16:54.179863 [debug] [Thread-1  ]: Finished running node model.duckdb_dbt_sample.sample_model
[0m16:16:54.180376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:54.180549 [debug] [MainThread]: Connection 'model.duckdb_dbt_sample.sample_model' was properly closed.
[0m16:16:54.180934 [debug] [MainThread]: Command end result
[0m16:16:54.192045 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:16:54.192917 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:16:54.198077 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m16:16:54.199180 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.47300404, "process_in_blocks": "0", "process_kernel_time": 0.155536, "process_mem_max_rss": "129662976", "process_out_blocks": "0", "process_user_time": 1.029334}
[0m16:16:54.199456 [debug] [MainThread]: Command `dbt compile` succeeded at 16:16:54.199405 after 0.47 seconds
[0m16:16:54.199721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db6df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a90f070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a61910>]}
[0m16:16:54.199977 [debug] [MainThread]: Flushing usage events
[0m16:16:55.149444 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:02.022154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105123eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fdbd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fdbee0>]}


============================== 16:21:02.025266 | 70249f5a-8f8b-4b4c-a726-7dec65e1b3ea ==============================
[0m16:21:02.025266 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:21:02.025636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:21:02.160250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70249f5a-8f8b-4b4c-a726-7dec65e1b3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060717c0>]}
[0m16:21:02.189582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70249f5a-8f8b-4b4c-a726-7dec65e1b3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9bca0>]}
[0m16:21:02.192383 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:21:02.265223 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:21:02.331305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:21:02.331723 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:21:02.359711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70249f5a-8f8b-4b4c-a726-7dec65e1b3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10651c130>]}
[0m16:21:02.414862 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:21:02.416482 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:21:02.433860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70249f5a-8f8b-4b4c-a726-7dec65e1b3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d8eb0>]}
[0m16:21:02.434870 [info ] [MainThread]: Found 1 seed, 1 model, 426 macros
[0m16:21:02.435315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70249f5a-8f8b-4b4c-a726-7dec65e1b3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653aaf0>]}
[0m16:21:02.437985 [info ] [MainThread]: 
[0m16:21:02.438769 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:21:02.439114 [info ] [MainThread]: 
[0m16:21:02.439847 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:21:02.441598 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:21:02.484741 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:21:02.485026 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:21:02.485211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:02.527542 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m16:21:02.528637 [debug] [ThreadPool]: On list_dev: Close
[0m16:21:02.530402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:21:02.530717 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:21:02.534543 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:21:02.534761 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:21:02.534941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:02.540253 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:21:02.541084 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:21:02.541288 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:21:02.541533 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:02.541704 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:21:02.541869 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:21:02.542212 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:02.542705 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:21:02.542896 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:21:02.543066 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:21:02.543304 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:02.543474 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:21:02.547070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:21:02.550486 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:21:02.550706 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:21:02.550873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:02.556031 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:21:02.556259 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:21:02.556450 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:21:02.567216 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m16:21:02.568022 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:21:02.568643 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:21:02.568818 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:21:02.570344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70249f5a-8f8b-4b4c-a726-7dec65e1b3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f8ac0>]}
[0m16:21:02.570614 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:02.570777 [debug] [MainThread]: On master: BEGIN
[0m16:21:02.570927 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:02.575836 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:21:02.576057 [debug] [MainThread]: On master: COMMIT
[0m16:21:02.576229 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:02.576385 [debug] [MainThread]: On master: COMMIT
[0m16:21:02.576597 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:02.576775 [debug] [MainThread]: On master: Close
[0m16:21:02.578372 [debug] [Thread-1  ]: Began running node seed.duckdb_dbt_sample.sample_data
[0m16:21:02.578681 [info ] [Thread-1  ]: 1 of 1 START seed file main.sample_data ........................................ [RUN]
[0m16:21:02.578988 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_main, now seed.duckdb_dbt_sample.sample_data)
[0m16:21:02.579203 [debug] [Thread-1  ]: Began compiling node seed.duckdb_dbt_sample.sample_data
[0m16:21:02.579406 [debug] [Thread-1  ]: Began executing node seed.duckdb_dbt_sample.sample_data
[0m16:21:02.596010 [debug] [Thread-1  ]: Using duckdb connection "seed.duckdb_dbt_sample.sample_data"
[0m16:21:02.596311 [debug] [Thread-1  ]: On seed.duckdb_dbt_sample.sample_data: BEGIN
[0m16:21:02.596504 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:21:02.602083 [debug] [Thread-1  ]: SQL status: OK in 0.006 seconds
[0m16:21:02.602387 [debug] [Thread-1  ]: Using duckdb connection "seed.duckdb_dbt_sample.sample_data"
[0m16:21:02.602588 [debug] [Thread-1  ]: On seed.duckdb_dbt_sample.sample_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "seed.duckdb_dbt_sample.sample_data"} */
truncate table "dev"."main"."sample_data"
[0m16:21:02.603328 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:21:02.609395 [debug] [Thread-1  ]: Using duckdb connection "seed.duckdb_dbt_sample.sample_data"
[0m16:21:02.609655 [debug] [Thread-1  ]: On seed.duckdb_dbt_sample.sample_data: 
          COPY "dev"."main"."sample_data" FROM '/Users/takeshiiijima/github/duckdb-dbt/data/sample_data.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:21:02.613052 [debug] [Thread-1  ]: SQL status: OK in 0.003 seconds
[0m16:21:02.616429 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.duckdb_dbt_sample.sample_data"
[0m16:21:02.622655 [debug] [Thread-1  ]: On seed.duckdb_dbt_sample.sample_data: COMMIT
[0m16:21:02.622895 [debug] [Thread-1  ]: Using duckdb connection "seed.duckdb_dbt_sample.sample_data"
[0m16:21:02.623096 [debug] [Thread-1  ]: On seed.duckdb_dbt_sample.sample_data: COMMIT
[0m16:21:02.624304 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:21:02.625368 [debug] [Thread-1  ]: On seed.duckdb_dbt_sample.sample_data: Close
[0m16:21:02.628538 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70249f5a-8f8b-4b4c-a726-7dec65e1b3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e1ee0>]}
[0m16:21:02.628885 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file main.sample_data .................................... [[32mINSERT 3[0m in 0.05s]
[0m16:21:02.629197 [debug] [Thread-1  ]: Finished running node seed.duckdb_dbt_sample.sample_data
[0m16:21:02.629783 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:02.629992 [debug] [MainThread]: On master: BEGIN
[0m16:21:02.630159 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:02.635319 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:21:02.635722 [debug] [MainThread]: On master: COMMIT
[0m16:21:02.636031 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:02.636247 [debug] [MainThread]: On master: COMMIT
[0m16:21:02.636545 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:02.637997 [debug] [MainThread]: On master: Close
[0m16:21:02.651676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:02.652189 [debug] [MainThread]: Connection 'seed.duckdb_dbt_sample.sample_data' was properly closed.
[0m16:21:02.658018 [info ] [MainThread]: 
[0m16:21:02.668724 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m16:21:02.678666 [debug] [MainThread]: Command end result
[0m16:21:02.699353 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:21:02.700283 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:21:02.703485 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m16:21:02.703682 [info ] [MainThread]: 
[0m16:21:02.703925 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:21:02.704105 [info ] [MainThread]: 
[0m16:21:02.704293 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:21:02.705138 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.72782093, "process_in_blocks": "0", "process_kernel_time": 0.185653, "process_mem_max_rss": "138870784", "process_out_blocks": "0", "process_user_time": 1.095359}
[0m16:21:02.705363 [debug] [MainThread]: Command `dbt seed` succeeded at 16:21:02.705322 after 0.73 seconds
[0m16:21:02.705580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105123eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ad9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc6760>]}
[0m16:21:02.705788 [debug] [MainThread]: Flushing usage events
[0m16:21:03.798278 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:07.121479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fafd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fafee0>]}


============================== 16:21:07.123792 | f3a2c25e-f1f7-44ed-b8a4-18f548f7a131 ==============================
[0m16:21:07.123792 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:21:07.124131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:21:07.234707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3a2c25e-f1f7-44ed-b8a4-18f548f7a131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b34f0>]}
[0m16:21:07.262309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3a2c25e-f1f7-44ed-b8a4-18f548f7a131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ab12e0>]}
[0m16:21:07.264262 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:21:07.331056 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:21:07.392278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:21:07.392625 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:21:07.415526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3a2c25e-f1f7-44ed-b8a4-18f548f7a131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125f0130>]}
[0m16:21:07.455324 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:21:07.456293 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:21:07.462338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3a2c25e-f1f7-44ed-b8a4-18f548f7a131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125b8790>]}
[0m16:21:07.462659 [info ] [MainThread]: Found 1 seed, 1 model, 426 macros
[0m16:21:07.462878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3a2c25e-f1f7-44ed-b8a4-18f548f7a131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11261dac0>]}
[0m16:21:07.463725 [info ] [MainThread]: 
[0m16:21:07.463995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:21:07.464185 [info ] [MainThread]: 
[0m16:21:07.464495 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:21:07.465006 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:21:07.494221 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:21:07.494545 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:21:07.494734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:07.501451 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m16:21:07.502210 [debug] [ThreadPool]: On list_dev: Close
[0m16:21:07.503421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:21:07.503717 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:21:07.507405 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:21:07.507620 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:21:07.507798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:07.513478 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:21:07.514872 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:21:07.515110 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:21:07.515407 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:07.515577 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:21:07.515737 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:21:07.516011 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:07.516447 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:21:07.516616 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:21:07.516768 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:21:07.516982 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:07.517146 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:21:07.520790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:21:07.524141 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:21:07.524415 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:21:07.524598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:07.529701 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:21:07.529914 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:21:07.530091 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:21:07.539855 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:21:07.540714 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:21:07.541342 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:21:07.541539 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:21:07.543173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3a2c25e-f1f7-44ed-b8a4-18f548f7a131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126c4220>]}
[0m16:21:07.543510 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:07.543705 [debug] [MainThread]: On master: BEGIN
[0m16:21:07.543867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:07.549080 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:21:07.549334 [debug] [MainThread]: On master: COMMIT
[0m16:21:07.549508 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:07.549667 [debug] [MainThread]: On master: COMMIT
[0m16:21:07.549889 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:07.550060 [debug] [MainThread]: On master: Close
[0m16:21:07.551445 [debug] [Thread-1  ]: Began running node model.duckdb_dbt_sample.sample_model
[0m16:21:07.551756 [info ] [Thread-1  ]: 1 of 1 START sql view model main.sample_model .................................. [RUN]
[0m16:21:07.552014 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_main, now model.duckdb_dbt_sample.sample_model)
[0m16:21:07.552223 [debug] [Thread-1  ]: Began compiling node model.duckdb_dbt_sample.sample_model
[0m16:21:07.556718 [debug] [Thread-1  ]: Writing injected SQL for node "model.duckdb_dbt_sample.sample_model"
[0m16:21:07.557147 [debug] [Thread-1  ]: Began executing node model.duckdb_dbt_sample.sample_model
[0m16:21:07.574515 [debug] [Thread-1  ]: Writing runtime sql for node "model.duckdb_dbt_sample.sample_model"
[0m16:21:07.575098 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:21:07.575306 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: BEGIN
[0m16:21:07.575494 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:21:07.580844 [debug] [Thread-1  ]: SQL status: OK in 0.005 seconds
[0m16:21:07.581152 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:21:07.581354 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */

  
  create view "dev"."main"."sample_model__dbt_tmp" as (
    select *
from "dev"."main"."sample_data"
  );

[0m16:21:07.581738 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:21:07.585978 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:21:07.586212 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */
alter view "dev"."main"."sample_model" rename to "sample_model__dbt_backup"
[0m16:21:07.586573 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:21:07.588234 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:21:07.588433 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */
alter view "dev"."main"."sample_model__dbt_tmp" rename to "sample_model"
[0m16:21:07.588722 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:21:07.594876 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: COMMIT
[0m16:21:07.595121 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:21:07.595309 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: COMMIT
[0m16:21:07.595906 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:21:07.598847 [debug] [Thread-1  ]: Using duckdb connection "model.duckdb_dbt_sample.sample_model"
[0m16:21:07.599119 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "node_id": "model.duckdb_dbt_sample.sample_model"} */
drop view if exists "dev"."main"."sample_model__dbt_backup" cascade
[0m16:21:07.599588 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:21:07.601009 [debug] [Thread-1  ]: On model.duckdb_dbt_sample.sample_model: Close
[0m16:21:07.603234 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a2c25e-f1f7-44ed-b8a4-18f548f7a131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a7daf0>]}
[0m16:21:07.603616 [info ] [Thread-1  ]: 1 of 1 OK created sql view model main.sample_model ............................. [[32mOK[0m in 0.05s]
[0m16:21:07.603936 [debug] [Thread-1  ]: Finished running node model.duckdb_dbt_sample.sample_model
[0m16:21:07.604516 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:07.604711 [debug] [MainThread]: On master: BEGIN
[0m16:21:07.604872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:07.610331 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:21:07.610849 [debug] [MainThread]: On master: COMMIT
[0m16:21:07.611058 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:07.611255 [debug] [MainThread]: On master: COMMIT
[0m16:21:07.611583 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:07.611831 [debug] [MainThread]: On master: Close
[0m16:21:07.613061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:07.613265 [debug] [MainThread]: Connection 'model.duckdb_dbt_sample.sample_model' was properly closed.
[0m16:21:07.613455 [info ] [MainThread]: 
[0m16:21:07.613873 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m16:21:07.614517 [debug] [MainThread]: Command end result
[0m16:21:07.626224 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:21:07.627112 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:21:07.630457 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m16:21:07.630806 [info ] [MainThread]: 
[0m16:21:07.631118 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:21:07.631346 [info ] [MainThread]: 
[0m16:21:07.631553 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:21:07.632524 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5497569, "process_in_blocks": "0", "process_kernel_time": 0.15288, "process_mem_max_rss": "135053312", "process_out_blocks": "0", "process_user_time": 1.118128}
[0m16:21:07.632781 [debug] [MainThread]: Command `dbt run` succeeded at 16:21:07.632735 after 0.55 seconds
[0m16:21:07.633035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11261d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112114f40>]}
[0m16:21:07.633356 [debug] [MainThread]: Flushing usage events
[0m16:21:08.437064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:11.793834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf6df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca7c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca7e50>]}


============================== 16:21:11.796316 | ba37bfb9-bf99-4048-9b96-b09722ab9b49 ==============================
[0m16:21:11.796316 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:21:11.796668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:21:11.905570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba37bfb9-bf99-4048-9b96-b09722ab9b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10287e910>]}
[0m16:21:11.933572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba37bfb9-bf99-4048-9b96-b09722ab9b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c81bb0>]}
[0m16:21:11.935336 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:21:12.001245 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:21:12.059231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:21:12.059498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:21:12.082098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba37bfb9-bf99-4048-9b96-b09722ab9b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f1130>]}
[0m16:21:12.122857 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:21:12.123971 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:21:12.129713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba37bfb9-bf99-4048-9b96-b09722ab9b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10531e9d0>]}
[0m16:21:12.130059 [info ] [MainThread]: Found 1 seed, 1 model, 426 macros
[0m16:21:12.130279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba37bfb9-bf99-4048-9b96-b09722ab9b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051cc9a0>]}
[0m16:21:12.131379 [info ] [MainThread]: 
[0m16:21:12.131636 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:21:12.131827 [info ] [MainThread]: 
[0m16:21:12.132141 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:21:12.134893 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m16:21:12.166995 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:21:12.167276 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:21:12.167451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:12.173640 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:21:12.173881 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:21:12.174068 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "duckdb_dbt_sample", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:21:12.184234 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:21:12.185072 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:21:12.185423 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:21:12.185598 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:21:12.187130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba37bfb9-bf99-4048-9b96-b09722ab9b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e12f10>]}
[0m16:21:12.188392 [debug] [Thread-1  ]: Began running node seed.duckdb_dbt_sample.sample_data
[0m16:21:12.188684 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dev_main, now seed.duckdb_dbt_sample.sample_data)
[0m16:21:12.188897 [debug] [Thread-1  ]: Began compiling node seed.duckdb_dbt_sample.sample_data
[0m16:21:12.192978 [debug] [Thread-1  ]: Began executing node seed.duckdb_dbt_sample.sample_data
[0m16:21:12.193367 [debug] [Thread-1  ]: Finished running node seed.duckdb_dbt_sample.sample_data
[0m16:21:12.193743 [debug] [Thread-1  ]: Began running node model.duckdb_dbt_sample.sample_model
[0m16:21:12.193981 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.duckdb_dbt_sample.sample_data, now model.duckdb_dbt_sample.sample_model)
[0m16:21:12.194183 [debug] [Thread-1  ]: Began compiling node model.duckdb_dbt_sample.sample_model
[0m16:21:12.195779 [debug] [Thread-1  ]: Writing injected SQL for node "model.duckdb_dbt_sample.sample_model"
[0m16:21:12.196186 [debug] [Thread-1  ]: Began executing node model.duckdb_dbt_sample.sample_model
[0m16:21:12.196517 [debug] [Thread-1  ]: Finished running node model.duckdb_dbt_sample.sample_model
[0m16:21:12.196941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:12.197181 [debug] [MainThread]: Connection 'model.duckdb_dbt_sample.sample_model' was properly closed.
[0m16:21:12.197677 [debug] [MainThread]: Command end result
[0m16:21:12.209184 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:21:12.210112 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:21:12.213900 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m16:21:12.214886 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.45850572, "process_in_blocks": "0", "process_kernel_time": 0.133395, "process_mem_max_rss": "129581056", "process_out_blocks": "0", "process_user_time": 0.960686}
[0m16:21:12.215135 [debug] [MainThread]: Command `dbt compile` succeeded at 16:21:12.215090 after 0.46 seconds
[0m16:21:12.215363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf6df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10287e910>]}
[0m16:21:12.215579 [debug] [MainThread]: Flushing usage events
[0m16:21:12.987059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:28:04.214285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c5270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac2b30>]}


============================== 16:28:04.217768 | 03f961c8-3a0e-41d7-abee-fb372cce8892 ==============================
[0m16:28:04.217768 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:28:04.218143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:28:04.220035 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_star_schema_profile'
[0m16:28:04.221489 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.050639, "process_in_blocks": "0", "process_kernel_time": 0.111746, "process_mem_max_rss": "92880896", "process_out_blocks": "0", "process_user_time": 0.679439}
[0m16:28:04.221793 [debug] [MainThread]: Command `dbt seed` failed at 16:28:04.221742 after 0.05 seconds
[0m16:28:04.222025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c5270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac1e10>]}
[0m16:28:04.222237 [debug] [MainThread]: Flushing usage events
[0m16:28:05.258938 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:28:58.827865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c9d1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104adb220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104adaad0>]}


============================== 16:28:58.831656 | 77f90843-4ffa-4456-8174-9ba0da64d4e4 ==============================
[0m16:28:58.831656 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:28:58.832027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:28:58.834218 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_star_schema_profile'
[0m16:28:58.835412 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.051347792, "process_in_blocks": "0", "process_kernel_time": 0.116836, "process_mem_max_rss": "93093888", "process_out_blocks": "0", "process_user_time": 0.693954}
[0m16:28:58.835700 [debug] [MainThread]: Command `dbt seed` failed at 16:28:58.835644 after 0.05 seconds
[0m16:28:58.835934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c9d1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104adb1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad9de0>]}
[0m16:28:58.836157 [debug] [MainThread]: Flushing usage events
[0m16:28:59.641380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:33:37.431926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4c12a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bfe72b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bfe6b60>]}


============================== 16:33:37.434780 | 8724c526-5657-4592-9f75-33b7ed2c852e ==============================
[0m16:33:37.434780 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:33:37.435128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:33:37.436877 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_star_schema_profile'
[0m16:33:37.437906 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.049590334, "process_in_blocks": "0", "process_kernel_time": 0.106635, "process_mem_max_rss": "93339648", "process_out_blocks": "0", "process_user_time": 0.68369}
[0m16:33:37.438167 [debug] [MainThread]: Command `dbt seed` failed at 16:33:37.438113 after 0.05 seconds
[0m16:33:37.438365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4c12a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bfe7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bfe5e10>]}
[0m16:33:37.438554 [debug] [MainThread]: Flushing usage events
[0m16:33:38.390591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:33:56.519357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037c1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac31f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac2aa0>]}


============================== 16:33:56.523578 | fe27af92-65b4-4bbc-9841-d898c2f8d466 ==============================
[0m16:33:56.523578 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:33:56.524945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:33:56.705531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe27af92-65b4-4bbc-9841-d898c2f8d466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a33be0>]}
[0m16:33:56.735827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe27af92-65b4-4bbc-9841-d898c2f8d466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf3a00>]}
[0m16:33:56.738625 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:33:56.794361 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:33:56.860670 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 5 files added, 0 files changed.
[0m16:33:56.861053 [debug] [MainThread]: Partial parsing: added file: duckdb_dbt_sample://models/fact_sales.sql
[0m16:33:56.861340 [debug] [MainThread]: Partial parsing: added file: duckdb_dbt_sample://models/dim_customers.sql
[0m16:33:56.861556 [debug] [MainThread]: Partial parsing: added file: duckdb_dbt_sample://models/dim_products.sql
[0m16:33:56.861776 [debug] [MainThread]: Partial parsing: added file: duckdb_dbt_sample://models/star_schema_view.sql
[0m16:33:56.861970 [debug] [MainThread]: Partial parsing: added file: duckdb_dbt_sample://models/dim_dates.sql
[0m16:33:56.862134 [debug] [MainThread]: Partial parsing: deleted file: duckdb_dbt_sample://data/sample_data.csv
[0m16:33:56.862285 [debug] [MainThread]: Partial parsing: deleted file: duckdb_dbt_sample://models/sample_model.sql
[0m16:33:56.962974 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.duckdb_dbt_sample.fact_sales' (models/fact_sales.sql) depends on a node named 'sales' which was not found
[0m16:33:56.964358 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.51033974, "process_in_blocks": "0", "process_kernel_time": 0.151285, "process_mem_max_rss": "111230976", "process_out_blocks": "0", "process_user_time": 1.000904}
[0m16:33:56.964627 [debug] [MainThread]: Command `dbt seed` failed at 16:33:56.964573 after 0.51 seconds
[0m16:33:56.964858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037c1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a7c430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107112fb0>]}
[0m16:33:56.965076 [debug] [MainThread]: Flushing usage events
[0m16:33:57.720078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:34:39.035940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10534d1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106187190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106186a40>]}


============================== 16:34:39.038978 | 69693a2b-a437-4911-8d56-72f9391a3880 ==============================
[0m16:34:39.038978 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:34:39.039408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:34:39.041164 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_star_schema_profile'
[0m16:34:39.042183 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.04764004, "process_in_blocks": "0", "process_kernel_time": 0.088288, "process_mem_max_rss": "92094464", "process_out_blocks": "0", "process_user_time": 0.624527}
[0m16:34:39.042434 [debug] [MainThread]: Command `dbt seed` failed at 16:34:39.042385 after 0.05 seconds
[0m16:34:39.042639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10534d1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106187130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106185e40>]}
[0m16:34:39.042832 [debug] [MainThread]: Flushing usage events
[0m16:34:39.856765 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:34:47.263656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682eaa0>]}


============================== 16:34:47.266325 | 954adf60-d5ec-4f11-9baa-fd719aad4e0c ==============================
[0m16:34:47.266325 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:34:47.266665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:34:47.268402 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_star_schema_profile'
[0m16:34:47.269404 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.0446375, "process_in_blocks": "0", "process_kernel_time": 0.095223, "process_mem_max_rss": "93437952", "process_out_blocks": "0", "process_user_time": 0.659561}
[0m16:34:47.269666 [debug] [MainThread]: Command `dbt seed` failed at 16:34:47.269614 after 0.04 seconds
[0m16:34:47.269872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682de40>]}
[0m16:34:47.270064 [debug] [MainThread]: Flushing usage events
[0m16:34:48.024832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:34:56.043847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c11e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110de7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110de6ad0>]}


============================== 16:34:56.046829 | 012acd9c-8ef7-46af-9771-039eaa884aa0 ==============================
[0m16:34:56.046829 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:34:56.047179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m16:34:56.048964 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_star_schema_profile'
[0m16:34:56.050015 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.04586029, "process_in_blocks": "0", "process_kernel_time": 0.084862, "process_mem_max_rss": "92848128", "process_out_blocks": "0", "process_user_time": 0.628605}
[0m16:34:56.050272 [debug] [MainThread]: Command `dbt seed` failed at 16:34:56.050225 after 0.05 seconds
[0m16:34:56.050486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c11e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110de71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110de5de0>]}
[0m16:34:56.050687 [debug] [MainThread]: Flushing usage events
[0m16:34:57.053104 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:35:07.389501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107295270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ab280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080aab30>]}


============================== 16:35:07.392111 | eb665237-e99a-4eac-b122-a14e3bea8ca1 ==============================
[0m16:35:07.392111 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:35:07.392448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/takeshiiijima/.dbt', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:35:07.394120 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_star_schema_profile'
[0m16:35:07.395258 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.04330129, "process_in_blocks": "0", "process_kernel_time": 0.085695, "process_mem_max_rss": "92733440", "process_out_blocks": "0", "process_user_time": 0.641022}
[0m16:35:07.395596 [debug] [MainThread]: Command `dbt seed` failed at 16:35:07.395538 after 0.04 seconds
[0m16:35:07.395824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107295270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ab220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080a9e10>]}
[0m16:35:07.396027 [debug] [MainThread]: Flushing usage events
[0m16:35:08.177221 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:35:59.098174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036192a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104477280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104476b30>]}


============================== 16:35:59.101086 | d08c4997-8abe-4e12-91b3-8fd59d1c5da5 ==============================
[0m16:35:59.101086 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:35:59.101448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m16:35:59.103195 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_star_schema_profile'
[0m16:35:59.104236 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.04854975, "process_in_blocks": "0", "process_kernel_time": 0.091349, "process_mem_max_rss": "92536832", "process_out_blocks": "0", "process_user_time": 0.633697}
[0m16:35:59.104493 [debug] [MainThread]: Command `dbt seed` failed at 16:35:59.104445 after 0.05 seconds
[0m16:35:59.104702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036192a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104477220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104475cf0>]}
[0m16:35:59.104903 [debug] [MainThread]: Flushing usage events
[0m16:35:59.896464 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:36:05.300285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f25270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d83280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d82b30>]}


============================== 16:36:05.302477 | f86107a5-e377-49a7-9e31-3390f9c4c355 ==============================
[0m16:36:05.302477 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:36:05.302809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:36:05.304434 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_star_schema_profile'
[0m16:36:05.305231 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.043305, "process_in_blocks": "0", "process_kernel_time": 0.075238, "process_mem_max_rss": "93650944", "process_out_blocks": "0", "process_user_time": 0.621028}
[0m16:36:05.305525 [debug] [MainThread]: Command `dbt seed` failed at 16:36:05.305468 after 0.04 seconds
[0m16:36:05.305780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f25270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d83220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d81cf0>]}
[0m16:36:05.305992 [debug] [MainThread]: Flushing usage events
[0m16:36:06.098460 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:36:25.602297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ac1240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbe3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbe2ad0>]}


============================== 16:36:25.605150 | e6243383-68a3-4d12-bc28-d92c735e9ec8 ==============================
[0m16:36:25.605150 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:36:25.605547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:36:25.607328 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_star_schema_profile'
[0m16:36:25.608369 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.044263583, "process_in_blocks": "0", "process_kernel_time": 0.090931, "process_mem_max_rss": "92422144", "process_out_blocks": "0", "process_user_time": 0.641426}
[0m16:36:25.608642 [debug] [MainThread]: Command `dbt seed` failed at 16:36:25.608592 after 0.04 seconds
[0m16:36:25.608861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ac1240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbe31c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bbe1d20>]}
[0m16:36:25.609070 [debug] [MainThread]: Flushing usage events
[0m16:36:26.878818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:37:02.887460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107415270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c97220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c96ad0>]}


============================== 16:37:02.890416 | 91394f17-2dd8-4612-989e-16b3223bd043 ==============================
[0m16:37:02.890416 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:37:02.890769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:37:03.086003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91394f17-2dd8-4612-989e-16b3223bd043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0e470>]}
[0m16:37:03.132482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91394f17-2dd8-4612-989e-16b3223bd043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f10280>]}
[0m16:37:03.140094 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:37:03.269818 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:37:03.327242 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:37:03.327557 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m16:37:03.327777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '91394f17-2dd8-4612-989e-16b3223bd043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e94850>]}
[0m16:37:03.936334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91394f17-2dd8-4612-989e-16b3223bd043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2f4f0>]}
[0m16:37:03.976216 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:37:03.977522 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:37:03.990751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91394f17-2dd8-4612-989e-16b3223bd043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb0ae00>]}
[0m16:37:03.991130 [info ] [MainThread]: Found 5 models, 4 seeds, 426 macros
[0m16:37:03.991346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91394f17-2dd8-4612-989e-16b3223bd043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b933fa0>]}
[0m16:37:03.992362 [info ] [MainThread]: 
[0m16:37:03.992570 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:37:03.992737 [info ] [MainThread]: 
[0m16:37:03.993015 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:37:03.995950 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb'
[0m16:37:04.026917 [debug] [ThreadPool]: Using duckdb connection "list_duckdb"
[0m16:37:04.027206 [debug] [ThreadPool]: On list_duckdb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duckdb"'
    
  
  
[0m16:37:04.027386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:04.069581 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m16:37:04.070403 [debug] [ThreadPool]: On list_duckdb: Close
[0m16:37:04.071959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_duckdb, now create_duckdb_main)
[0m16:37:04.072260 [debug] [ThreadPool]: Creating schema "database: "duckdb"
schema: "main"
"
[0m16:37:04.076206 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:37:04.076416 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='duckdb'
        and type='sqlite'
    
  
[0m16:37:04.076582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:04.082474 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:37:04.083612 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:37:04.083826 [debug] [ThreadPool]: On create_duckdb_main: BEGIN
[0m16:37:04.084182 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:37:04.084353 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:37:04.084517 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
    
        create schema if not exists "duckdb"."main"
    
[0m16:37:04.085089 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:37:04.085659 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m16:37:04.085867 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:37:04.086036 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m16:37:04.086315 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:37:04.086489 [debug] [ThreadPool]: On create_duckdb_main: Close
[0m16:37:04.088269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_duckdb_main, now list_duckdb_main)
[0m16:37:04.091482 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m16:37:04.091678 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m16:37:04.091839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:04.097476 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:37:04.097775 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m16:37:04.097956 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m16:37:04.108610 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:37:04.109340 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m16:37:04.109925 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m16:37:04.110114 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m16:37:04.111488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91394f17-2dd8-4612-989e-16b3223bd043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb93430>]}
[0m16:37:04.111779 [debug] [MainThread]: Using duckdb connection "master"
[0m16:37:04.111951 [debug] [MainThread]: On master: BEGIN
[0m16:37:04.112210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:04.117372 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:37:04.117606 [debug] [MainThread]: On master: COMMIT
[0m16:37:04.117788 [debug] [MainThread]: Using duckdb connection "master"
[0m16:37:04.117947 [debug] [MainThread]: On master: COMMIT
[0m16:37:04.118166 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:37:04.118334 [debug] [MainThread]: On master: Close
[0m16:37:04.119773 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.customers
[0m16:37:04.120084 [info ] [Thread-1 (]: 1 of 4 START seed file main.customers .......................................... [RUN]
[0m16:37:04.120343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now seed.my_star_schema_project.customers)
[0m16:37:04.120548 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.customers
[0m16:37:04.120744 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.customers
[0m16:37:04.138822 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m16:37:04.139235 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: BEGIN
[0m16:37:04.139435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:04.144755 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:37:04.145069 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m16:37:04.145294 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.customers"} */

    create table "duckdb"."main"."customers" ("customer_id" integer,"customer_name" text,"customer_city" text,"customer_state" text)
  
[0m16:37:04.146231 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:37:04.152402 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m16:37:04.152660 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: 
          COPY "duckdb"."main"."customers" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:37:04.156731 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:37:04.159868 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.customers"
[0m16:37:04.167386 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: COMMIT
[0m16:37:04.167661 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m16:37:04.167851 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: COMMIT
[0m16:37:04.168851 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:37:04.169896 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: Close
[0m16:37:04.174066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91394f17-2dd8-4612-989e-16b3223bd043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106257eb0>]}
[0m16:37:04.174434 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file main.customers ...................................... [[32mINSERT 3[0m in 0.05s]
[0m16:37:04.174759 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.customers
[0m16:37:04.174991 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.dates
[0m16:37:04.175297 [info ] [Thread-1 (]: 2 of 4 START seed file main.dates .............................................. [RUN]
[0m16:37:04.175553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.customers, now seed.my_star_schema_project.dates)
[0m16:37:04.175757 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.dates
[0m16:37:04.175952 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.dates
[0m16:37:04.178347 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m16:37:04.178549 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: BEGIN
[0m16:37:04.178931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:04.184551 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:37:04.184833 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m16:37:04.185035 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.dates"} */

    create table "duckdb"."main"."dates" ("date_key" integer,"date" date,"year" integer,"month" integer,"day" integer)
  
[0m16:37:04.185348 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:37:04.186072 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m16:37:04.186265 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: 
          COPY "duckdb"."main"."dates" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/dates.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:37:04.187517 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:37:04.187911 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.dates"
[0m16:37:04.188963 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: COMMIT
[0m16:37:04.189156 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m16:37:04.189328 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: COMMIT
[0m16:37:04.189750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:37:04.190180 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: Close
[0m16:37:04.192423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91394f17-2dd8-4612-989e-16b3223bd043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106257eb0>]}
[0m16:37:04.192799 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file main.dates .......................................... [[32mINSERT 3[0m in 0.02s]
[0m16:37:04.193113 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.dates
[0m16:37:04.193358 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.products
[0m16:37:04.193692 [info ] [Thread-1 (]: 3 of 4 START seed file main.products ........................................... [RUN]
[0m16:37:04.193991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.dates, now seed.my_star_schema_project.products)
[0m16:37:04.194213 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.products
[0m16:37:04.194412 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.products
[0m16:37:04.197087 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m16:37:04.197339 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: BEGIN
[0m16:37:04.197524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:04.203497 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:37:04.203803 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m16:37:04.204001 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.products"} */

    create table "duckdb"."main"."products" ("product_id" integer,"product_name" text,"product_category" text,"price" float8)
  
[0m16:37:04.204316 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:37:04.205040 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m16:37:04.205240 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: 
          COPY "duckdb"."main"."products" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:37:04.206396 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:37:04.206755 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.products"
[0m16:37:04.207854 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: COMMIT
[0m16:37:04.208117 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m16:37:04.208299 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: COMMIT
[0m16:37:04.208874 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:37:04.209360 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: Close
[0m16:37:04.213175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91394f17-2dd8-4612-989e-16b3223bd043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf31a20>]}
[0m16:37:04.213614 [info ] [Thread-1 (]: 3 of 4 OK loaded seed file main.products ....................................... [[32mINSERT 3[0m in 0.02s]
[0m16:37:04.213954 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.products
[0m16:37:04.214192 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.sales
[0m16:37:04.214505 [info ] [Thread-1 (]: 4 of 4 START seed file main.sales .............................................. [RUN]
[0m16:37:04.214766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.products, now seed.my_star_schema_project.sales)
[0m16:37:04.214967 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.sales
[0m16:37:04.215264 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.sales
[0m16:37:04.218261 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m16:37:04.218498 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: BEGIN
[0m16:37:04.218673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:04.224067 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:37:04.224368 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m16:37:04.224568 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.sales"} */

    create table "duckdb"."main"."sales" ("sale_id" integer,"customer_id" integer,"product_id" integer,"date_key" integer,"quantity" integer,"total_amount" float8)
  
[0m16:37:04.224897 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:37:04.225607 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m16:37:04.225800 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: 
          COPY "duckdb"."main"."sales" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/sales.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:37:04.226941 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:37:04.227308 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.sales"
[0m16:37:04.228353 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: COMMIT
[0m16:37:04.228560 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m16:37:04.228790 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: COMMIT
[0m16:37:04.230524 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:37:04.231068 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: Close
[0m16:37:04.233695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91394f17-2dd8-4612-989e-16b3223bd043', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3ef400>]}
[0m16:37:04.234093 [info ] [Thread-1 (]: 4 of 4 OK loaded seed file main.sales .......................................... [[32mINSERT 3[0m in 0.02s]
[0m16:37:04.234402 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.sales
[0m16:37:04.234987 [debug] [MainThread]: Using duckdb connection "master"
[0m16:37:04.235181 [debug] [MainThread]: On master: BEGIN
[0m16:37:04.235336 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:37:04.240545 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:37:04.241067 [debug] [MainThread]: On master: COMMIT
[0m16:37:04.241295 [debug] [MainThread]: Using duckdb connection "master"
[0m16:37:04.241466 [debug] [MainThread]: On master: COMMIT
[0m16:37:04.241725 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:37:04.241899 [debug] [MainThread]: On master: Close
[0m16:37:04.243063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:04.243276 [debug] [MainThread]: Connection 'seed.my_star_schema_project.sales' was properly closed.
[0m16:37:04.243471 [info ] [MainThread]: 
[0m16:37:04.243663 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m16:37:04.244213 [debug] [MainThread]: Command end result
[0m16:37:04.257132 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:37:04.258409 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:37:04.262526 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m16:37:04.262861 [info ] [MainThread]: 
[0m16:37:04.263125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:04.263311 [info ] [MainThread]: 
[0m16:37:04.263501 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:37:04.264663 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.4181623, "process_in_blocks": "0", "process_kernel_time": 0.208605, "process_mem_max_rss": "153157632", "process_out_blocks": "0", "process_user_time": 1.734706}
[0m16:37:04.264983 [debug] [MainThread]: Command `dbt seed` succeeded at 16:37:04.264931 after 1.42 seconds
[0m16:37:04.265287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107415270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10749ac80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0e470>]}
[0m16:37:04.265543 [debug] [MainThread]: Flushing usage events
[0m16:37:05.025405 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:02.053139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038c1270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105193280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105192b30>]}


============================== 16:38:02.056080 | 18e543c6-1afc-4873-8e5c-16a627926da9 ==============================
[0m16:38:02.056080 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:38:02.056430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:38:02.201573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18e543c6-1afc-4873-8e5c-16a627926da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10429a2c0>]}
[0m16:38:02.230724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18e543c6-1afc-4873-8e5c-16a627926da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10500b790>]}
[0m16:38:02.233596 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:38:02.287641 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:38:02.353109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:02.353395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:02.376629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18e543c6-1afc-4873-8e5c-16a627926da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105934130>]}
[0m16:38:02.416608 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:38:02.417992 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:38:02.429133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18e543c6-1afc-4873-8e5c-16a627926da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105934910>]}
[0m16:38:02.429501 [info ] [MainThread]: Found 5 models, 4 seeds, 426 macros
[0m16:38:02.429730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18e543c6-1afc-4873-8e5c-16a627926da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059348b0>]}
[0m16:38:02.430728 [info ] [MainThread]: 
[0m16:38:02.430940 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:02.431106 [info ] [MainThread]: 
[0m16:38:02.431390 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:38:02.434098 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb'
[0m16:38:02.465478 [debug] [ThreadPool]: Using duckdb connection "list_duckdb"
[0m16:38:02.465765 [debug] [ThreadPool]: On list_duckdb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duckdb"'
    
  
  
[0m16:38:02.465950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:02.507805 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m16:38:02.508639 [debug] [ThreadPool]: On list_duckdb: Close
[0m16:38:02.510382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_duckdb, now create_duckdb_main)
[0m16:38:02.510837 [debug] [ThreadPool]: Creating schema "database: "duckdb"
schema: "main"
"
[0m16:38:02.514695 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:38:02.514922 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='duckdb'
        and type='sqlite'
    
  
[0m16:38:02.515086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:02.520766 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:38:02.521848 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:38:02.522045 [debug] [ThreadPool]: On create_duckdb_main: BEGIN
[0m16:38:02.522300 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:38:02.522468 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:38:02.522630 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
    
        create schema if not exists "duckdb"."main"
    
[0m16:38:02.523159 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:38:02.523722 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m16:38:02.523922 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:38:02.524086 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m16:38:02.524372 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:38:02.524599 [debug] [ThreadPool]: On create_duckdb_main: Close
[0m16:38:02.526701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_duckdb_main, now list_duckdb_main)
[0m16:38:02.530546 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m16:38:02.530775 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m16:38:02.530936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:02.536131 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:38:02.536329 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m16:38:02.536524 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m16:38:02.547213 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:38:02.548012 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m16:38:02.548580 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m16:38:02.548758 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m16:38:02.550429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18e543c6-1afc-4873-8e5c-16a627926da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105297040>]}
[0m16:38:02.550715 [debug] [MainThread]: Using duckdb connection "master"
[0m16:38:02.550880 [debug] [MainThread]: On master: BEGIN
[0m16:38:02.551027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:02.556208 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:38:02.556424 [debug] [MainThread]: On master: COMMIT
[0m16:38:02.556600 [debug] [MainThread]: Using duckdb connection "master"
[0m16:38:02.556755 [debug] [MainThread]: On master: COMMIT
[0m16:38:02.556977 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:38:02.557150 [debug] [MainThread]: On master: Close
[0m16:38:02.558568 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_customers
[0m16:38:02.558849 [info ] [Thread-1 (]: 1 of 5 START sql view model main.dim_customers ................................. [RUN]
[0m16:38:02.559098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now model.my_star_schema_project.dim_customers)
[0m16:38:02.559284 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_customers
[0m16:38:02.563948 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_customers"
[0m16:38:02.564839 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_customers
[0m16:38:02.582075 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.dim_customers"
[0m16:38:02.582697 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m16:38:02.582905 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: BEGIN
[0m16:38:02.583086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:02.588230 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:38:02.588466 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m16:38:02.588663 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */

  
  create view "duckdb"."main"."dim_customers__dbt_tmp" as (
    -- models/dim_customers.sql
select 
    customer_id,
    customer_name,
    customer_city,
    customer_state
from "duckdb"."main"."customers"
  );

[0m16:38:02.589023 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.592415 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m16:38:02.592636 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */
alter view "duckdb"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m16:38:02.593383 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:38:02.598743 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: COMMIT
[0m16:38:02.598999 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m16:38:02.599192 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: COMMIT
[0m16:38:02.599999 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:38:02.602603 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m16:38:02.602818 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */
drop view if exists "duckdb"."main"."dim_customers__dbt_backup" cascade
[0m16:38:02.603107 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.604401 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: Close
[0m16:38:02.608123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18e543c6-1afc-4873-8e5c-16a627926da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059755d0>]}
[0m16:38:02.608523 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.dim_customers ............................ [[32mOK[0m in 0.05s]
[0m16:38:02.608833 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_customers
[0m16:38:02.609050 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_dates
[0m16:38:02.609335 [info ] [Thread-1 (]: 2 of 5 START sql view model main.dim_dates ..................................... [RUN]
[0m16:38:02.609586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_customers, now model.my_star_schema_project.dim_dates)
[0m16:38:02.609785 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_dates
[0m16:38:02.612022 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_dates"
[0m16:38:02.612535 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_dates
[0m16:38:02.614603 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.dim_dates"
[0m16:38:02.615289 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m16:38:02.615496 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: BEGIN
[0m16:38:02.615670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:02.620977 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:38:02.621253 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m16:38:02.621449 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */

  
  create view "duckdb"."main"."dim_dates__dbt_tmp" as (
    -- models/dim_dates.sql
select 
    date_key,
    date,
    year,
    month,
    day
from "duckdb"."main"."dates"
  );

[0m16:38:02.621795 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.623543 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m16:38:02.623741 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */
alter view "duckdb"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m16:38:02.624051 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.624777 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: COMMIT
[0m16:38:02.624968 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m16:38:02.625147 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: COMMIT
[0m16:38:02.625636 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.627022 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m16:38:02.627230 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */
drop view if exists "duckdb"."main"."dim_dates__dbt_backup" cascade
[0m16:38:02.627535 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.628266 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: Close
[0m16:38:02.630546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18e543c6-1afc-4873-8e5c-16a627926da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb7bb0>]}
[0m16:38:02.631055 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.dim_dates ................................ [[32mOK[0m in 0.02s]
[0m16:38:02.631397 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_dates
[0m16:38:02.631630 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_products
[0m16:38:02.631936 [info ] [Thread-1 (]: 3 of 5 START sql view model main.dim_products .................................. [RUN]
[0m16:38:02.632208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_dates, now model.my_star_schema_project.dim_products)
[0m16:38:02.632440 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_products
[0m16:38:02.634437 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_products"
[0m16:38:02.634887 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_products
[0m16:38:02.636836 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.dim_products"
[0m16:38:02.637179 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m16:38:02.637600 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: BEGIN
[0m16:38:02.637824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:02.643223 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:38:02.643469 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m16:38:02.643682 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */

  
  create view "duckdb"."main"."dim_products__dbt_tmp" as (
    -- models/dim_products.sql
select 
    product_id,
    product_name,
    product_category,
    price
from "duckdb"."main"."products"
  );

[0m16:38:02.644046 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.645973 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m16:38:02.646397 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */
alter view "duckdb"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m16:38:02.646824 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.647692 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: COMMIT
[0m16:38:02.647900 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m16:38:02.648077 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: COMMIT
[0m16:38:02.648589 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.651004 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m16:38:02.651252 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */
drop view if exists "duckdb"."main"."dim_products__dbt_backup" cascade
[0m16:38:02.651619 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.652337 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: Close
[0m16:38:02.654162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18e543c6-1afc-4873-8e5c-16a627926da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed7b80>]}
[0m16:38:02.654510 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.dim_products ............................. [[32mOK[0m in 0.02s]
[0m16:38:02.654804 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_products
[0m16:38:02.655016 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.fact_sales
[0m16:38:02.655308 [info ] [Thread-1 (]: 4 of 5 START sql view model main.fact_sales .................................... [RUN]
[0m16:38:02.655574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_products, now model.my_star_schema_project.fact_sales)
[0m16:38:02.655775 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.fact_sales
[0m16:38:02.686437 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.fact_sales"
[0m16:38:02.686943 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.fact_sales
[0m16:38:02.688859 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.fact_sales"
[0m16:38:02.689198 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m16:38:02.689394 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: BEGIN
[0m16:38:02.689568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:02.694809 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:38:02.695062 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m16:38:02.695258 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */

  
  create view "duckdb"."main"."fact_sales__dbt_tmp" as (
    -- models/fact_sales.sql
select 
    sale_id,
    customer_id,
    product_id,
    date_key,
    quantity,
    total_amount
from "duckdb"."main"."sales"
  );

[0m16:38:02.695621 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.697587 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m16:38:02.697811 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */
alter view "duckdb"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m16:38:02.698138 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.698870 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: COMMIT
[0m16:38:02.699062 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m16:38:02.699242 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: COMMIT
[0m16:38:02.699692 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.700944 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m16:38:02.701128 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */
drop view if exists "duckdb"."main"."fact_sales__dbt_backup" cascade
[0m16:38:02.701387 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.702074 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: Close
[0m16:38:02.703935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18e543c6-1afc-4873-8e5c-16a627926da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef8730>]}
[0m16:38:02.704284 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.fact_sales ............................... [[32mOK[0m in 0.05s]
[0m16:38:02.704582 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.fact_sales
[0m16:38:02.704949 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.star_schema_view
[0m16:38:02.705273 [info ] [Thread-1 (]: 5 of 5 START sql view model main.star_schema_view .............................. [RUN]
[0m16:38:02.705550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.fact_sales, now model.my_star_schema_project.star_schema_view)
[0m16:38:02.705763 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.star_schema_view
[0m16:38:02.707829 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.star_schema_view"
[0m16:38:02.708204 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.star_schema_view
[0m16:38:02.710171 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.star_schema_view"
[0m16:38:02.710861 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m16:38:02.711078 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: BEGIN
[0m16:38:02.711269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:02.717909 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:38:02.718224 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m16:38:02.718446 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */

  
  create view "duckdb"."main"."star_schema_view__dbt_tmp" as (
    -- models/star_schema_view.sql
with fact as (
    select * from "duckdb"."main"."fact_sales"
),
customers as (
    select * from "duckdb"."main"."dim_customers"
),
products as (
    select * from "duckdb"."main"."dim_products"
),
dates as (
    select * from "duckdb"."main"."dim_dates"
)
select
    f.sale_id,
    f.quantity,
    f.total_amount,
    c.customer_id,
    c.customer_name,
    c.customer_city,
    c.customer_state,
    p.product_id,
    p.product_name,
    p.product_category,
    p.price,
    d.date_key,
    d.date,
    d.year,
    d.month,
    d.day
from fact f
left join customers c on f.customer_id = c.customer_id
left join products p on f.product_id = p.product_id
left join dates d on f.date_key = d.date_key
  );

[0m16:38:02.719140 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.721726 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m16:38:02.721945 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */
alter view "duckdb"."main"."star_schema_view__dbt_tmp" rename to "star_schema_view"
[0m16:38:02.722275 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.723011 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: COMMIT
[0m16:38:02.723217 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m16:38:02.723404 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: COMMIT
[0m16:38:02.723878 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.725152 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m16:38:02.725349 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */
drop view if exists "duckdb"."main"."star_schema_view__dbt_backup" cascade
[0m16:38:02.725630 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:02.726254 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: Close
[0m16:38:02.728326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18e543c6-1afc-4873-8e5c-16a627926da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550b460>]}
[0m16:38:02.728726 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.star_schema_view ......................... [[32mOK[0m in 0.02s]
[0m16:38:02.729152 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.star_schema_view
[0m16:38:02.730008 [debug] [MainThread]: Using duckdb connection "master"
[0m16:38:02.730210 [debug] [MainThread]: On master: BEGIN
[0m16:38:02.730368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:38:02.736048 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m16:38:02.736278 [debug] [MainThread]: On master: COMMIT
[0m16:38:02.736440 [debug] [MainThread]: Using duckdb connection "master"
[0m16:38:02.736588 [debug] [MainThread]: On master: COMMIT
[0m16:38:02.736793 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:38:02.736947 [debug] [MainThread]: On master: Close
[0m16:38:02.738010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:02.738171 [debug] [MainThread]: Connection 'model.my_star_schema_project.star_schema_view' was properly closed.
[0m16:38:02.738375 [info ] [MainThread]: 
[0m16:38:02.738555 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m16:38:02.739137 [debug] [MainThread]: Command end result
[0m16:38:02.751615 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:38:02.752528 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:38:02.755977 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m16:38:02.756184 [info ] [MainThread]: 
[0m16:38:02.756407 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:38:02.756581 [info ] [MainThread]: 
[0m16:38:02.756763 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:38:02.757828 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7497699, "process_in_blocks": "0", "process_kernel_time": 0.202391, "process_mem_max_rss": "136052736", "process_out_blocks": "0", "process_user_time": 1.242944}
[0m16:38:02.758052 [debug] [MainThread]: Command `dbt run` succeeded at 16:38:02.758011 after 0.75 seconds
[0m16:38:02.758254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038c1270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103260550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b7ec80>]}
[0m16:38:02.758452 [debug] [MainThread]: Flushing usage events
[0m16:38:04.005703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:35.550989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a65240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a2ad0>]}


============================== 16:55:35.554176 | 8a3f5f50-8650-4c0e-9350-f26fa021376e ==============================
[0m16:55:35.554176 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:55:35.554550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:35.713984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a3f5f50-8650-4c0e-9350-f26fa021376e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10833e320>]}
[0m16:55:35.744440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a3f5f50-8650-4c0e-9350-f26fa021376e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a8d4e0>]}
[0m16:55:35.747426 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:55:35.805091 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:55:35.875759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:35.876033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:35.899854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a3f5f50-8650-4c0e-9350-f26fa021376e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e10130>]}
[0m16:55:35.940722 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:55:35.942144 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:55:35.953776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a3f5f50-8650-4c0e-9350-f26fa021376e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e12e30>]}
[0m16:55:35.954164 [info ] [MainThread]: Found 5 models, 4 seeds, 426 macros
[0m16:55:35.954383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a3f5f50-8650-4c0e-9350-f26fa021376e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd9c30>]}
[0m16:55:35.955482 [info ] [MainThread]: 
[0m16:55:35.955731 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:35.955900 [info ] [MainThread]: 
[0m16:55:35.956287 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:55:35.960151 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb'
[0m16:55:35.992030 [debug] [ThreadPool]: Using duckdb connection "list_duckdb"
[0m16:55:35.992515 [debug] [ThreadPool]: On list_duckdb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duckdb"'
    
  
  
[0m16:55:35.992780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:36.063909 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m16:55:36.065007 [debug] [ThreadPool]: On list_duckdb: Close
[0m16:55:36.066967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_duckdb, now create_duckdb_main)
[0m16:55:36.067337 [debug] [ThreadPool]: Creating schema "database: "duckdb"
schema: "main"
"
[0m16:55:36.071517 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:55:36.071777 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='duckdb'
        and type='sqlite'
    
  
[0m16:55:36.071956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:36.078391 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:55:36.079350 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:55:36.079541 [debug] [ThreadPool]: On create_duckdb_main: BEGIN
[0m16:55:36.079787 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:55:36.079949 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:55:36.080108 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
    
        create schema if not exists "duckdb"."main"
    
[0m16:55:36.080713 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:55:36.081209 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m16:55:36.081402 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:55:36.081568 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m16:55:36.081835 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:55:36.082047 [debug] [ThreadPool]: On create_duckdb_main: Close
[0m16:55:36.083728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_duckdb_main, now list_duckdb_main)
[0m16:55:36.087381 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m16:55:36.087590 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m16:55:36.087754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:36.093372 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:55:36.093659 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m16:55:36.093848 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m16:55:36.107572 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m16:55:36.108704 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m16:55:36.109278 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m16:55:36.109480 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m16:55:36.111453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a3f5f50-8650-4c0e-9350-f26fa021376e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ad240>]}
[0m16:55:36.111732 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:36.111902 [debug] [MainThread]: On master: BEGIN
[0m16:55:36.112058 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:36.123457 [debug] [MainThread]: SQL status: OK in 0.011 seconds
[0m16:55:36.124565 [debug] [MainThread]: On master: COMMIT
[0m16:55:36.126656 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:36.126980 [debug] [MainThread]: On master: COMMIT
[0m16:55:36.127378 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:55:36.127626 [debug] [MainThread]: On master: Close
[0m16:55:36.131776 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.customers
[0m16:55:36.132342 [info ] [Thread-1 (]: 1 of 4 START seed file main.customers .......................................... [RUN]
[0m16:55:36.132741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now seed.my_star_schema_project.customers)
[0m16:55:36.133198 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.customers
[0m16:55:36.133919 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.customers
[0m16:55:36.171041 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m16:55:36.172712 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: BEGIN
[0m16:55:36.173008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:36.183333 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m16:55:36.183714 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m16:55:36.183948 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.customers"} */
truncate table "duckdb"."main"."customers"
[0m16:55:36.187224 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:55:36.198411 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m16:55:36.198803 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: 
          COPY "duckdb"."main"."customers" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:55:36.212523 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m16:55:36.216338 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.customers"
[0m16:55:36.223347 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: COMMIT
[0m16:55:36.223878 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m16:55:36.224142 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: COMMIT
[0m16:55:36.226268 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:55:36.227692 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: Close
[0m16:55:36.234053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a3f5f50-8650-4c0e-9350-f26fa021376e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e23460>]}
[0m16:55:36.234547 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file main.customers ...................................... [[32mINSERT 3[0m in 0.10s]
[0m16:55:36.234896 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.customers
[0m16:55:36.235149 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.dates
[0m16:55:36.236139 [info ] [Thread-1 (]: 2 of 4 START seed file main.dates .............................................. [RUN]
[0m16:55:36.236515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.customers, now seed.my_star_schema_project.dates)
[0m16:55:36.237217 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.dates
[0m16:55:36.237460 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.dates
[0m16:55:36.243924 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m16:55:36.244489 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: BEGIN
[0m16:55:36.244716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:36.255401 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m16:55:36.255872 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m16:55:36.256112 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.dates"} */
truncate table "duckdb"."main"."dates"
[0m16:55:36.256689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:36.257721 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m16:55:36.257967 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: 
          COPY "duckdb"."main"."dates" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/dates.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:55:36.260224 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:55:36.260873 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.dates"
[0m16:55:36.262071 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: COMMIT
[0m16:55:36.262392 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m16:55:36.262597 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: COMMIT
[0m16:55:36.263549 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:55:36.264055 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: Close
[0m16:55:36.268127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a3f5f50-8650-4c0e-9350-f26fa021376e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785cd90>]}
[0m16:55:36.268933 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file main.dates .......................................... [[32mINSERT 3[0m in 0.03s]
[0m16:55:36.269683 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.dates
[0m16:55:36.270167 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.products
[0m16:55:36.270793 [info ] [Thread-1 (]: 3 of 4 START seed file main.products ........................................... [RUN]
[0m16:55:36.271190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.dates, now seed.my_star_schema_project.products)
[0m16:55:36.271444 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.products
[0m16:55:36.271680 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.products
[0m16:55:36.281765 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m16:55:36.283350 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: BEGIN
[0m16:55:36.283625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:36.294763 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m16:55:36.295490 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m16:55:36.296447 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.products"} */
truncate table "duckdb"."main"."products"
[0m16:55:36.297333 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:36.298219 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m16:55:36.298464 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: 
          COPY "duckdb"."main"."products" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:55:36.299883 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:55:36.300378 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.products"
[0m16:55:36.301483 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: COMMIT
[0m16:55:36.301729 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m16:55:36.301924 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: COMMIT
[0m16:55:36.303141 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:55:36.303649 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: Close
[0m16:55:36.307533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a3f5f50-8650-4c0e-9350-f26fa021376e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938feb0>]}
[0m16:55:36.308058 [info ] [Thread-1 (]: 3 of 4 OK loaded seed file main.products ....................................... [[32mINSERT 3[0m in 0.04s]
[0m16:55:36.308871 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.products
[0m16:55:36.309154 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.sales
[0m16:55:36.309467 [info ] [Thread-1 (]: 4 of 4 START seed file main.sales .............................................. [RUN]
[0m16:55:36.309845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.products, now seed.my_star_schema_project.sales)
[0m16:55:36.310264 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.sales
[0m16:55:36.310569 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.sales
[0m16:55:36.315265 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m16:55:36.315909 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: BEGIN
[0m16:55:36.316148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:36.323457 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:55:36.323821 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m16:55:36.324066 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.sales"} */
truncate table "duckdb"."main"."sales"
[0m16:55:36.324535 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:55:36.326847 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m16:55:36.327206 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: 
          COPY "duckdb"."main"."sales" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/sales.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:55:36.329157 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:55:36.329665 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.sales"
[0m16:55:36.330785 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: COMMIT
[0m16:55:36.331018 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m16:55:36.331207 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: COMMIT
[0m16:55:36.332278 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:55:36.332739 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: Close
[0m16:55:36.335753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a3f5f50-8650-4c0e-9350-f26fa021376e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109338220>]}
[0m16:55:36.336279 [info ] [Thread-1 (]: 4 of 4 OK loaded seed file main.sales .......................................... [[32mINSERT 3[0m in 0.03s]
[0m16:55:36.336647 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.sales
[0m16:55:36.337651 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:36.337855 [debug] [MainThread]: On master: BEGIN
[0m16:55:36.338021 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:36.346742 [debug] [MainThread]: SQL status: OK in 0.009 seconds
[0m16:55:36.347045 [debug] [MainThread]: On master: COMMIT
[0m16:55:36.347237 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:36.347407 [debug] [MainThread]: On master: COMMIT
[0m16:55:36.347641 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:55:36.347817 [debug] [MainThread]: On master: Close
[0m16:55:36.349231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:36.349484 [debug] [MainThread]: Connection 'seed.my_star_schema_project.sales' was properly closed.
[0m16:55:36.349723 [info ] [MainThread]: 
[0m16:55:36.349928 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m16:55:36.350595 [debug] [MainThread]: Command end result
[0m16:55:36.406226 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:55:36.407412 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:55:36.411602 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m16:55:36.411847 [info ] [MainThread]: 
[0m16:55:36.412093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:36.412277 [info ] [MainThread]: 
[0m16:55:36.412461 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:55:36.413593 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.90715754, "process_in_blocks": "0", "process_kernel_time": 0.214984, "process_mem_max_rss": "151175168", "process_out_blocks": "0", "process_user_time": 1.243819}
[0m16:55:36.413825 [debug] [MainThread]: Command `dbt seed` succeeded at 16:55:36.413782 after 0.91 seconds
[0m16:55:36.414040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a65240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1a9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785cd90>]}
[0m16:55:36.414263 [debug] [MainThread]: Flushing usage events
[0m16:55:37.320472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:56:16.445563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ac1240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a97220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a96ad0>]}


============================== 16:56:16.448286 | 69215d63-d4aa-4087-9ee2-b80cf1cd590a ==============================
[0m16:56:16.448286 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:56:16.448629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:56:16.585576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69215d63-d4aa-4087-9ee2-b80cf1cd590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c5e320>]}
[0m16:56:16.616561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69215d63-d4aa-4087-9ee2-b80cf1cd590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ded4e0>]}
[0m16:56:16.619553 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:56:16.674789 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:56:16.739365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:56:16.739665 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:56:16.766903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69215d63-d4aa-4087-9ee2-b80cf1cd590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114230130>]}
[0m16:56:16.807692 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:56:16.808973 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:56:16.819299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69215d63-d4aa-4087-9ee2-b80cf1cd590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114232e30>]}
[0m16:56:16.819601 [info ] [MainThread]: Found 5 models, 4 seeds, 426 macros
[0m16:56:16.819799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69215d63-d4aa-4087-9ee2-b80cf1cd590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ff5c30>]}
[0m16:56:16.820829 [info ] [MainThread]: 
[0m16:56:16.821065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:56:16.821239 [info ] [MainThread]: 
[0m16:56:16.821533 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:56:16.824225 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb'
[0m16:56:16.854707 [debug] [ThreadPool]: Using duckdb connection "list_duckdb"
[0m16:56:16.854999 [debug] [ThreadPool]: On list_duckdb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duckdb"'
    
  
  
[0m16:56:16.855177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:16.914002 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m16:56:16.914934 [debug] [ThreadPool]: On list_duckdb: Close
[0m16:56:16.916647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_duckdb, now create_duckdb_main)
[0m16:56:16.916961 [debug] [ThreadPool]: Creating schema "database: "duckdb"
schema: "main"
"
[0m16:56:16.920847 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:56:16.921104 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='duckdb'
        and type='sqlite'
    
  
[0m16:56:16.921287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:16.927679 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:56:16.928636 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:56:16.928831 [debug] [ThreadPool]: On create_duckdb_main: BEGIN
[0m16:56:16.929059 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:56:16.929226 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:56:16.929384 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
    
        create schema if not exists "duckdb"."main"
    
[0m16:56:16.929968 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:56:16.930407 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m16:56:16.930570 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:56:16.930718 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m16:56:16.930946 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:56:16.931121 [debug] [ThreadPool]: On create_duckdb_main: Close
[0m16:56:16.932818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_duckdb_main, now list_duckdb_main)
[0m16:56:16.936396 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m16:56:16.936616 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m16:56:16.936780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:16.942315 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:56:16.942576 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m16:56:16.942758 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m16:56:16.954917 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m16:56:16.955825 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m16:56:16.956358 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m16:56:16.956529 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m16:56:16.958464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69215d63-d4aa-4087-9ee2-b80cf1cd590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110625240>]}
[0m16:56:16.958758 [debug] [MainThread]: Using duckdb connection "master"
[0m16:56:16.958932 [debug] [MainThread]: On master: BEGIN
[0m16:56:16.959084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:56:16.964286 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:56:16.964547 [debug] [MainThread]: On master: COMMIT
[0m16:56:16.964731 [debug] [MainThread]: Using duckdb connection "master"
[0m16:56:16.964888 [debug] [MainThread]: On master: COMMIT
[0m16:56:16.965109 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:56:16.965276 [debug] [MainThread]: On master: Close
[0m16:56:16.966725 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.customers
[0m16:56:16.967027 [info ] [Thread-1 (]: 1 of 4 START seed file main.customers .......................................... [RUN]
[0m16:56:16.967280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now seed.my_star_schema_project.customers)
[0m16:56:16.967477 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.customers
[0m16:56:16.967677 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.customers
[0m16:56:16.984455 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m16:56:16.984746 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: BEGIN
[0m16:56:16.984932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:16.990648 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:56:16.990937 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m16:56:16.991131 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.customers"} */
truncate table "duckdb"."main"."customers"
[0m16:56:16.992221 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:56:16.998300 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m16:56:16.998530 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: 
          COPY "duckdb"."main"."customers" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:56:17.002763 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:56:17.005881 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.customers"
[0m16:56:17.011277 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: COMMIT
[0m16:56:17.011511 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m16:56:17.011696 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: COMMIT
[0m16:56:17.012913 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:56:17.013926 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: Close
[0m16:56:17.019244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69215d63-d4aa-4087-9ee2-b80cf1cd590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114243bb0>]}
[0m16:56:17.019599 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file main.customers ...................................... [[32mINSERT 3[0m in 0.05s]
[0m16:56:17.019913 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.customers
[0m16:56:17.020136 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.dates
[0m16:56:17.020566 [info ] [Thread-1 (]: 2 of 4 START seed file main.dates .............................................. [RUN]
[0m16:56:17.020895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.customers, now seed.my_star_schema_project.dates)
[0m16:56:17.021117 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.dates
[0m16:56:17.021312 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.dates
[0m16:56:17.024400 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m16:56:17.024613 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: BEGIN
[0m16:56:17.024797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:17.030460 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:56:17.030767 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m16:56:17.030977 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.dates"} */
truncate table "duckdb"."main"."dates"
[0m16:56:17.031397 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:56:17.032172 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m16:56:17.032371 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: 
          COPY "duckdb"."main"."dates" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/dates.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:56:17.033583 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:56:17.033938 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.dates"
[0m16:56:17.034861 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: COMMIT
[0m16:56:17.035057 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m16:56:17.035227 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: COMMIT
[0m16:56:17.036217 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:56:17.036623 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: Close
[0m16:56:17.039577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69215d63-d4aa-4087-9ee2-b80cf1cd590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117b4d90>]}
[0m16:56:17.040279 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file main.dates .......................................... [[32mINSERT 3[0m in 0.02s]
[0m16:56:17.040671 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.dates
[0m16:56:17.040909 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.products
[0m16:56:17.041274 [info ] [Thread-1 (]: 3 of 4 START seed file main.products ........................................... [RUN]
[0m16:56:17.041561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.dates, now seed.my_star_schema_project.products)
[0m16:56:17.041773 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.products
[0m16:56:17.041969 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.products
[0m16:56:17.045801 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m16:56:17.046013 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: BEGIN
[0m16:56:17.046190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:17.052209 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:56:17.052540 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m16:56:17.052790 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.products"} */
truncate table "duckdb"."main"."products"
[0m16:56:17.053269 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:56:17.054606 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m16:56:17.054900 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: 
          COPY "duckdb"."main"."products" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:56:17.056352 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:56:17.057039 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.products"
[0m16:56:17.058382 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: COMMIT
[0m16:56:17.058612 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m16:56:17.058795 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: COMMIT
[0m16:56:17.059882 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:56:17.060317 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: Close
[0m16:56:17.063910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69215d63-d4aa-4087-9ee2-b80cf1cd590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150b3eb0>]}
[0m16:56:17.064321 [info ] [Thread-1 (]: 3 of 4 OK loaded seed file main.products ....................................... [[32mINSERT 3[0m in 0.02s]
[0m16:56:17.064711 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.products
[0m16:56:17.064973 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.sales
[0m16:56:17.065308 [info ] [Thread-1 (]: 4 of 4 START seed file main.sales .............................................. [RUN]
[0m16:56:17.065603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.products, now seed.my_star_schema_project.sales)
[0m16:56:17.065812 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.sales
[0m16:56:17.066001 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.sales
[0m16:56:17.069127 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m16:56:17.069340 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: BEGIN
[0m16:56:17.069519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:17.075488 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:56:17.075782 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m16:56:17.075973 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.sales"} */
truncate table "duckdb"."main"."sales"
[0m16:56:17.076347 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:56:17.077105 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m16:56:17.077323 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: 
          COPY "duckdb"."main"."sales" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/sales.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:56:17.078423 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:56:17.078790 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.sales"
[0m16:56:17.079712 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: COMMIT
[0m16:56:17.079906 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m16:56:17.080080 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: COMMIT
[0m16:56:17.080945 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:56:17.081363 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: Close
[0m16:56:17.083591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69215d63-d4aa-4087-9ee2-b80cf1cd590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115063d00>]}
[0m16:56:17.083917 [info ] [Thread-1 (]: 4 of 4 OK loaded seed file main.sales .......................................... [[32mINSERT 3[0m in 0.02s]
[0m16:56:17.084231 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.sales
[0m16:56:17.084816 [debug] [MainThread]: Using duckdb connection "master"
[0m16:56:17.085001 [debug] [MainThread]: On master: BEGIN
[0m16:56:17.085151 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:56:17.091087 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m16:56:17.091381 [debug] [MainThread]: On master: COMMIT
[0m16:56:17.091564 [debug] [MainThread]: Using duckdb connection "master"
[0m16:56:17.091727 [debug] [MainThread]: On master: COMMIT
[0m16:56:17.091944 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:56:17.092116 [debug] [MainThread]: On master: Close
[0m16:56:17.093199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:17.093384 [debug] [MainThread]: Connection 'seed.my_star_schema_project.sales' was properly closed.
[0m16:56:17.093579 [info ] [MainThread]: 
[0m16:56:17.093763 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m16:56:17.094304 [debug] [MainThread]: Command end result
[0m16:56:17.136311 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:56:17.137821 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:56:17.141245 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m16:56:17.141464 [info ] [MainThread]: 
[0m16:56:17.141700 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:56:17.141879 [info ] [MainThread]: 
[0m16:56:17.142058 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:56:17.143152 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.7369693, "process_in_blocks": "0", "process_kernel_time": 0.165242, "process_mem_max_rss": "148930560", "process_out_blocks": "0", "process_user_time": 1.153912}
[0m16:56:17.143380 [debug] [MainThread]: Command `dbt seed` succeeded at 16:56:17.143337 after 0.74 seconds
[0m16:56:17.143584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ac1240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d7e680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117b4d90>]}
[0m16:56:17.143788 [debug] [MainThread]: Flushing usage events
[0m16:56:17.878655 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:57:14.880807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c12d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bf2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064beb60>]}


============================== 16:57:14.883719 | 93cdee39-1b1e-487f-a1c2-42675d17457f ==============================
[0m16:57:14.883719 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:57:14.884073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:57:15.034096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93cdee39-1b1e-487f-a1c2-42675d17457f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106615630>]}
[0m16:57:15.065360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93cdee39-1b1e-487f-a1c2-42675d17457f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646ca60>]}
[0m16:57:15.068233 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:57:15.123881 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:57:15.192786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:57:15.193058 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:57:15.215884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93cdee39-1b1e-487f-a1c2-42675d17457f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b34130>]}
[0m16:57:15.255658 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:57:15.257071 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:57:15.268393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93cdee39-1b1e-487f-a1c2-42675d17457f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b34850>]}
[0m16:57:15.268719 [info ] [MainThread]: Found 5 models, 4 seeds, 426 macros
[0m16:57:15.268921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93cdee39-1b1e-487f-a1c2-42675d17457f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b347c0>]}
[0m16:57:15.269970 [info ] [MainThread]: 
[0m16:57:15.270192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:57:15.270355 [info ] [MainThread]: 
[0m16:57:15.270647 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:57:15.273463 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb'
[0m16:57:15.304976 [debug] [ThreadPool]: Using duckdb connection "list_duckdb"
[0m16:57:15.305256 [debug] [ThreadPool]: On list_duckdb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duckdb"'
    
  
  
[0m16:57:15.305429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:15.374222 [debug] [ThreadPool]: SQL status: OK in 0.069 seconds
[0m16:57:15.375103 [debug] [ThreadPool]: On list_duckdb: Close
[0m16:57:15.377031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_duckdb, now create_duckdb_main)
[0m16:57:15.377317 [debug] [ThreadPool]: Creating schema "database: "duckdb"
schema: "main"
"
[0m16:57:15.381085 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:57:15.381292 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='duckdb'
        and type='sqlite'
    
  
[0m16:57:15.381459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:15.387402 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:57:15.388487 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:57:15.388679 [debug] [ThreadPool]: On create_duckdb_main: BEGIN
[0m16:57:15.388944 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:57:15.389108 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:57:15.389271 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
    
        create schema if not exists "duckdb"."main"
    
[0m16:57:15.389830 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:57:15.390380 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m16:57:15.390587 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m16:57:15.390757 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m16:57:15.391004 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:57:15.391180 [debug] [ThreadPool]: On create_duckdb_main: Close
[0m16:57:15.393115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_duckdb_main, now list_duckdb_main)
[0m16:57:15.397123 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m16:57:15.397560 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m16:57:15.397732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:15.403569 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:57:15.403831 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m16:57:15.404007 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m16:57:15.415876 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m16:57:15.416723 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m16:57:15.417290 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m16:57:15.417465 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m16:57:15.419451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93cdee39-1b1e-487f-a1c2-42675d17457f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106594850>]}
[0m16:57:15.419783 [debug] [MainThread]: Using duckdb connection "master"
[0m16:57:15.419991 [debug] [MainThread]: On master: BEGIN
[0m16:57:15.420159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:57:15.425344 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:57:15.425562 [debug] [MainThread]: On master: COMMIT
[0m16:57:15.425742 [debug] [MainThread]: Using duckdb connection "master"
[0m16:57:15.425901 [debug] [MainThread]: On master: COMMIT
[0m16:57:15.426113 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:57:15.426278 [debug] [MainThread]: On master: Close
[0m16:57:15.427709 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_customers
[0m16:57:15.428009 [info ] [Thread-1 (]: 1 of 5 START sql view model main.dim_customers ................................. [RUN]
[0m16:57:15.428265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now model.my_star_schema_project.dim_customers)
[0m16:57:15.428466 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_customers
[0m16:57:15.433008 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_customers"
[0m16:57:15.433612 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_customers
[0m16:57:15.451452 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.dim_customers"
[0m16:57:15.451995 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m16:57:15.452199 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: BEGIN
[0m16:57:15.452376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:15.457907 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:57:15.458189 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m16:57:15.458387 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */

  
  create view "duckdb"."main"."dim_customers__dbt_tmp" as (
    -- models/dim_customers.sql
select 
    customer_id,
    customer_name,
    customer_city,
    customer_state
from "duckdb"."main"."customers"
  );

[0m16:57:15.458757 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.462405 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m16:57:15.462669 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */
alter view "duckdb"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m16:57:15.463621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:57:15.465931 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m16:57:15.466237 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */
alter view "duckdb"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m16:57:15.466672 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.474914 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: COMMIT
[0m16:57:15.475268 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m16:57:15.475485 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: COMMIT
[0m16:57:15.476340 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:57:15.480218 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m16:57:15.480516 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */
drop view if exists "duckdb"."main"."dim_customers__dbt_backup" cascade
[0m16:57:15.481030 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.482520 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: Close
[0m16:57:15.487721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93cdee39-1b1e-487f-a1c2-42675d17457f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103357f10>]}
[0m16:57:15.488207 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.dim_customers ............................ [[32mOK[0m in 0.06s]
[0m16:57:15.488548 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_customers
[0m16:57:15.488777 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_dates
[0m16:57:15.489078 [info ] [Thread-1 (]: 2 of 5 START sql view model main.dim_dates ..................................... [RUN]
[0m16:57:15.489359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_customers, now model.my_star_schema_project.dim_dates)
[0m16:57:15.489557 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_dates
[0m16:57:15.491267 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_dates"
[0m16:57:15.491669 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_dates
[0m16:57:15.494280 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.dim_dates"
[0m16:57:15.495011 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m16:57:15.495269 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: BEGIN
[0m16:57:15.495467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:15.502341 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:57:15.502717 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m16:57:15.503072 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */

  
  create view "duckdb"."main"."dim_dates__dbt_tmp" as (
    -- models/dim_dates.sql
select 
    date_key,
    date,
    year,
    month,
    day
from "duckdb"."main"."dates"
  );

[0m16:57:15.504158 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:57:15.510318 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m16:57:15.510653 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */
alter view "duckdb"."main"."dim_dates" rename to "dim_dates__dbt_backup"
[0m16:57:15.511111 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.513534 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m16:57:15.513823 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */
alter view "duckdb"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m16:57:15.514281 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.515222 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: COMMIT
[0m16:57:15.515448 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m16:57:15.515634 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: COMMIT
[0m16:57:15.516211 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.517797 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m16:57:15.518036 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */
drop view if exists "duckdb"."main"."dim_dates__dbt_backup" cascade
[0m16:57:15.518514 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.519305 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: Close
[0m16:57:15.522068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93cdee39-1b1e-487f-a1c2-42675d17457f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107185060>]}
[0m16:57:15.522579 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.dim_dates ................................ [[32mOK[0m in 0.03s]
[0m16:57:15.522986 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_dates
[0m16:57:15.523263 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_products
[0m16:57:15.523602 [info ] [Thread-1 (]: 3 of 5 START sql view model main.dim_products .................................. [RUN]
[0m16:57:15.524097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_dates, now model.my_star_schema_project.dim_products)
[0m16:57:15.524438 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_products
[0m16:57:15.526586 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_products"
[0m16:57:15.527078 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_products
[0m16:57:15.602900 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.dim_products"
[0m16:57:15.603767 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m16:57:15.604258 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: BEGIN
[0m16:57:15.604473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:15.638934 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m16:57:15.640750 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m16:57:15.641160 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */

  
  create view "duckdb"."main"."dim_products__dbt_tmp" as (
    -- models/dim_products.sql
select 
    product_id,
    product_name,
    product_category,
    price
from "duckdb"."main"."products"
  );

[0m16:57:15.642403 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:57:15.655163 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m16:57:15.655530 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */
alter view "duckdb"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m16:57:15.656028 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.658073 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m16:57:15.658345 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */
alter view "duckdb"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m16:57:15.658777 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.659728 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: COMMIT
[0m16:57:15.660026 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m16:57:15.660215 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: COMMIT
[0m16:57:15.661049 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:57:15.662669 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m16:57:15.662930 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */
drop view if exists "duckdb"."main"."dim_products__dbt_backup" cascade
[0m16:57:15.663481 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.664507 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: Close
[0m16:57:15.667097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93cdee39-1b1e-487f-a1c2-42675d17457f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103357f10>]}
[0m16:57:15.667649 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.dim_products ............................. [[32mOK[0m in 0.14s]
[0m16:57:15.667996 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_products
[0m16:57:15.668225 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.fact_sales
[0m16:57:15.668523 [info ] [Thread-1 (]: 4 of 5 START sql view model main.fact_sales .................................... [RUN]
[0m16:57:15.668840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_products, now model.my_star_schema_project.fact_sales)
[0m16:57:15.669183 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.fact_sales
[0m16:57:15.671789 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.fact_sales"
[0m16:57:15.672427 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.fact_sales
[0m16:57:15.676646 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.fact_sales"
[0m16:57:15.677288 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m16:57:15.677521 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: BEGIN
[0m16:57:15.677717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:15.684556 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:57:15.685446 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m16:57:15.685905 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */

  
  create view "duckdb"."main"."fact_sales__dbt_tmp" as (
    -- models/fact_sales.sql
select 
    sale_id,
    customer_id,
    product_id,
    date_key,
    quantity,
    total_amount
from "duckdb"."main"."sales"
  );

[0m16:57:15.686917 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:57:15.689878 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m16:57:15.690269 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */
alter view "duckdb"."main"."fact_sales" rename to "fact_sales__dbt_backup"
[0m16:57:15.691094 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.694009 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m16:57:15.694263 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */
alter view "duckdb"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m16:57:15.694667 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.695581 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: COMMIT
[0m16:57:15.695793 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m16:57:15.695976 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: COMMIT
[0m16:57:15.696527 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.698455 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m16:57:15.698721 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */
drop view if exists "duckdb"."main"."fact_sales__dbt_backup" cascade
[0m16:57:15.699278 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.700162 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: Close
[0m16:57:15.702902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93cdee39-1b1e-487f-a1c2-42675d17457f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1002b7c10>]}
[0m16:57:15.703854 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.fact_sales ............................... [[32mOK[0m in 0.03s]
[0m16:57:15.704332 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.fact_sales
[0m16:57:15.705203 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.star_schema_view
[0m16:57:15.705522 [info ] [Thread-1 (]: 5 of 5 START sql view model main.star_schema_view .............................. [RUN]
[0m16:57:15.706069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.fact_sales, now model.my_star_schema_project.star_schema_view)
[0m16:57:15.706288 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.star_schema_view
[0m16:57:15.709326 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.star_schema_view"
[0m16:57:15.710538 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.star_schema_view
[0m16:57:15.713230 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.star_schema_view"
[0m16:57:15.713796 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m16:57:15.714010 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: BEGIN
[0m16:57:15.714199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:15.720877 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:57:15.721227 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m16:57:15.721888 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */

  
  create view "duckdb"."main"."star_schema_view__dbt_tmp" as (
    -- models/star_schema_view.sql
with fact as (
    select * from "duckdb"."main"."fact_sales"
),
customers as (
    select * from "duckdb"."main"."dim_customers"
),
products as (
    select * from "duckdb"."main"."dim_products"
),
dates as (
    select * from "duckdb"."main"."dim_dates"
)
select
    f.sale_id,
    f.quantity,
    f.total_amount,
    c.customer_id,
    c.customer_name,
    c.customer_city,
    c.customer_state,
    p.product_id,
    p.product_name,
    p.product_category,
    p.price,
    d.date_key,
    d.date,
    d.year,
    d.month,
    d.day
from fact f
left join customers c on f.customer_id = c.customer_id
left join products p on f.product_id = p.product_id
left join dates d on f.date_key = d.date_key
  );

[0m16:57:15.723137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:57:15.726073 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m16:57:15.726425 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */
alter view "duckdb"."main"."star_schema_view" rename to "star_schema_view__dbt_backup"
[0m16:57:15.726885 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.728755 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m16:57:15.728988 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */
alter view "duckdb"."main"."star_schema_view__dbt_tmp" rename to "star_schema_view"
[0m16:57:15.729350 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.730275 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: COMMIT
[0m16:57:15.730507 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m16:57:15.730697 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: COMMIT
[0m16:57:15.731262 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.732877 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m16:57:15.733192 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */
drop view if exists "duckdb"."main"."star_schema_view__dbt_backup" cascade
[0m16:57:15.733761 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:57:15.734688 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: Close
[0m16:57:15.738721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93cdee39-1b1e-487f-a1c2-42675d17457f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103357f10>]}
[0m16:57:15.739310 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.star_schema_view ......................... [[32mOK[0m in 0.03s]
[0m16:57:15.739673 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.star_schema_view
[0m16:57:15.741814 [debug] [MainThread]: Using duckdb connection "master"
[0m16:57:15.742675 [debug] [MainThread]: On master: BEGIN
[0m16:57:15.743931 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:57:15.749961 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m16:57:15.750256 [debug] [MainThread]: On master: COMMIT
[0m16:57:15.750438 [debug] [MainThread]: Using duckdb connection "master"
[0m16:57:15.750594 [debug] [MainThread]: On master: COMMIT
[0m16:57:15.750802 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:57:15.750962 [debug] [MainThread]: On master: Close
[0m16:57:15.751985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:15.752159 [debug] [MainThread]: Connection 'model.my_star_schema_project.star_schema_view' was properly closed.
[0m16:57:15.752365 [info ] [MainThread]: 
[0m16:57:15.752547 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m16:57:15.753405 [debug] [MainThread]: Command end result
[0m16:57:15.766932 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m16:57:15.767867 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m16:57:15.772264 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m16:57:15.772656 [info ] [MainThread]: 
[0m16:57:15.773033 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:57:15.773247 [info ] [MainThread]: 
[0m16:57:15.773447 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:57:15.774568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.93634963, "process_in_blocks": "0", "process_kernel_time": 0.187605, "process_mem_max_rss": "137576448", "process_out_blocks": "0", "process_user_time": 1.263763}
[0m16:57:15.774826 [debug] [MainThread]: Command `dbt run` succeeded at 16:57:15.774779 after 0.94 seconds
[0m16:57:15.775041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c12d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104170c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c6260>]}
[0m16:57:15.775248 [debug] [MainThread]: Flushing usage events
[0m16:57:16.910767 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:03:41.742384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c0d1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a1f1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a1ea70>]}


============================== 17:03:41.745530 | e6ac952f-ab69-436a-bdfe-4f8a44b8cac2 ==============================
[0m17:03:41.745530 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:03:41.745880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:03:41.906906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6ac952f-ab69-436a-bdfe-4f8a44b8cac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e7040>]}
[0m17:03:41.936836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6ac952f-ab69-436a-bdfe-4f8a44b8cac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048cd7e0>]}
[0m17:03:41.939892 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:03:41.996776 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:03:42.063645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:03:42.064032 [debug] [MainThread]: Partial parsing: updated file: my_star_schema_project://models/dim_products.sql
[0m17:03:42.064255 [debug] [MainThread]: Partial parsing: updated file: my_star_schema_project://seeds/products.csv
[0m17:03:42.275970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6ac952f-ab69-436a-bdfe-4f8a44b8cac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105268130>]}
[0m17:03:42.314700 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:03:42.316174 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:03:42.329757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6ac952f-ab69-436a-bdfe-4f8a44b8cac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f740d0>]}
[0m17:03:42.330136 [info ] [MainThread]: Found 5 models, 4 seeds, 426 macros
[0m17:03:42.330351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6ac952f-ab69-436a-bdfe-4f8a44b8cac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7d240>]}
[0m17:03:42.331405 [info ] [MainThread]: 
[0m17:03:42.331659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:03:42.331834 [info ] [MainThread]: 
[0m17:03:42.332164 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:03:42.335383 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb'
[0m17:03:42.409138 [debug] [ThreadPool]: Using duckdb connection "list_duckdb"
[0m17:03:42.409412 [debug] [ThreadPool]: On list_duckdb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duckdb"'
    
  
  
[0m17:03:42.409585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:42.456174 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m17:03:42.457047 [debug] [ThreadPool]: On list_duckdb: Close
[0m17:03:42.458865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_duckdb, now create_duckdb_main)
[0m17:03:42.459172 [debug] [ThreadPool]: Creating schema "database: "duckdb"
schema: "main"
"
[0m17:03:42.462881 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m17:03:42.463085 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='duckdb'
        and type='sqlite'
    
  
[0m17:03:42.463252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:42.468728 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:03:42.469697 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m17:03:42.469880 [debug] [ThreadPool]: On create_duckdb_main: BEGIN
[0m17:03:42.470106 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:03:42.470264 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m17:03:42.470425 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
    
        create schema if not exists "duckdb"."main"
    
[0m17:03:42.470704 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:03:42.471128 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m17:03:42.471296 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m17:03:42.471454 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m17:03:42.471715 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:03:42.471923 [debug] [ThreadPool]: On create_duckdb_main: Close
[0m17:03:42.473689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_duckdb_main, now list_duckdb_main)
[0m17:03:42.477430 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:03:42.477663 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m17:03:42.477822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:42.482997 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:03:42.483192 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:03:42.483365 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m17:03:42.494538 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:03:42.495451 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m17:03:42.496062 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m17:03:42.496233 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m17:03:42.498213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6ac952f-ab69-436a-bdfe-4f8a44b8cac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b55ed0>]}
[0m17:03:42.498492 [debug] [MainThread]: Using duckdb connection "master"
[0m17:03:42.498661 [debug] [MainThread]: On master: BEGIN
[0m17:03:42.498813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:03:42.504009 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m17:03:42.504241 [debug] [MainThread]: On master: COMMIT
[0m17:03:42.504426 [debug] [MainThread]: Using duckdb connection "master"
[0m17:03:42.504595 [debug] [MainThread]: On master: COMMIT
[0m17:03:42.504843 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:03:42.505061 [debug] [MainThread]: On master: Close
[0m17:03:42.506599 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.customers
[0m17:03:42.506901 [info ] [Thread-1 (]: 1 of 4 START seed file main.customers .......................................... [RUN]
[0m17:03:42.507161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now seed.my_star_schema_project.customers)
[0m17:03:42.507361 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.customers
[0m17:03:42.507552 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.customers
[0m17:03:42.525881 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m17:03:42.526189 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: BEGIN
[0m17:03:42.526381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:42.531861 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:03:42.532222 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m17:03:42.532481 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.customers"} */
truncate table "duckdb"."main"."customers"
[0m17:03:42.533091 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:42.539378 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m17:03:42.539647 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: 
          COPY "duckdb"."main"."customers" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:03:42.543247 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:03:42.546207 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.customers"
[0m17:03:42.551826 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: COMMIT
[0m17:03:42.552190 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m17:03:42.552446 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: COMMIT
[0m17:03:42.554257 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:03:42.555621 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: Close
[0m17:03:42.560418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6ac952f-ab69-436a-bdfe-4f8a44b8cac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510d150>]}
[0m17:03:42.560788 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file main.customers ...................................... [[32mINSERT 3[0m in 0.05s]
[0m17:03:42.561111 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.customers
[0m17:03:42.561337 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.dates
[0m17:03:42.561660 [info ] [Thread-1 (]: 2 of 4 START seed file main.dates .............................................. [RUN]
[0m17:03:42.561936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.customers, now seed.my_star_schema_project.dates)
[0m17:03:42.562151 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.dates
[0m17:03:42.562356 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.dates
[0m17:03:42.565340 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m17:03:42.565571 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: BEGIN
[0m17:03:42.565758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:42.571835 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:03:42.572173 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m17:03:42.572391 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.dates"} */
truncate table "duckdb"."main"."dates"
[0m17:03:42.572820 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:42.573962 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m17:03:42.574288 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: 
          COPY "duckdb"."main"."dates" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/dates.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:03:42.575711 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:03:42.576158 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.dates"
[0m17:03:42.577196 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: COMMIT
[0m17:03:42.577420 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m17:03:42.577601 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: COMMIT
[0m17:03:42.578459 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:03:42.578869 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: Close
[0m17:03:42.581242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6ac952f-ab69-436a-bdfe-4f8a44b8cac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a59c90>]}
[0m17:03:42.581557 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file main.dates .......................................... [[32mINSERT 3[0m in 0.02s]
[0m17:03:42.581877 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.dates
[0m17:03:42.582125 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.products
[0m17:03:42.582440 [info ] [Thread-1 (]: 3 of 4 START seed file main.products ........................................... [RUN]
[0m17:03:42.582710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.dates, now seed.my_star_schema_project.products)
[0m17:03:42.582919 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.products
[0m17:03:42.583098 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.products
[0m17:03:42.587189 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m17:03:42.587498 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: BEGIN
[0m17:03:42.588090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:42.594256 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:03:42.594557 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m17:03:42.594755 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.products"} */
truncate table "duckdb"."main"."products"
[0m17:03:42.595106 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:42.595889 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m17:03:42.596087 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: 
          COPY "duckdb"."main"."products" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:03:42.597197 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:03:42.597559 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.products"
[0m17:03:42.598495 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: COMMIT
[0m17:03:42.598690 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m17:03:42.598863 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: COMMIT
[0m17:03:42.599803 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:03:42.600277 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: Close
[0m17:03:42.603665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6ac952f-ab69-436a-bdfe-4f8a44b8cac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a2f130>]}
[0m17:03:42.603996 [info ] [Thread-1 (]: 3 of 4 OK loaded seed file main.products ....................................... [[32mINSERT 3[0m in 0.02s]
[0m17:03:42.604302 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.products
[0m17:03:42.604521 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.sales
[0m17:03:42.604898 [info ] [Thread-1 (]: 4 of 4 START seed file main.sales .............................................. [RUN]
[0m17:03:42.605310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.products, now seed.my_star_schema_project.sales)
[0m17:03:42.605552 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.sales
[0m17:03:42.605757 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.sales
[0m17:03:42.609498 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m17:03:42.609775 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: BEGIN
[0m17:03:42.609962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:42.615603 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:03:42.615895 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m17:03:42.616089 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.sales"} */
truncate table "duckdb"."main"."sales"
[0m17:03:42.616445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:42.617228 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m17:03:42.617450 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: 
          COPY "duckdb"."main"."sales" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/sales.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:03:42.618937 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:03:42.619631 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.sales"
[0m17:03:42.620910 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: COMMIT
[0m17:03:42.621281 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m17:03:42.621654 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: COMMIT
[0m17:03:42.623305 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:03:42.623896 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: Close
[0m17:03:42.626906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6ac952f-ab69-436a-bdfe-4f8a44b8cac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a2f130>]}
[0m17:03:42.627304 [info ] [Thread-1 (]: 4 of 4 OK loaded seed file main.sales .......................................... [[32mINSERT 3[0m in 0.02s]
[0m17:03:42.627615 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.sales
[0m17:03:42.628223 [debug] [MainThread]: Using duckdb connection "master"
[0m17:03:42.628432 [debug] [MainThread]: On master: BEGIN
[0m17:03:42.628611 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:03:42.634444 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m17:03:42.634779 [debug] [MainThread]: On master: COMMIT
[0m17:03:42.634955 [debug] [MainThread]: Using duckdb connection "master"
[0m17:03:42.635114 [debug] [MainThread]: On master: COMMIT
[0m17:03:42.635337 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:03:42.635513 [debug] [MainThread]: On master: Close
[0m17:03:42.636603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:42.636781 [debug] [MainThread]: Connection 'seed.my_star_schema_project.sales' was properly closed.
[0m17:03:42.636975 [info ] [MainThread]: 
[0m17:03:42.637158 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m17:03:42.637894 [debug] [MainThread]: Command end result
[0m17:03:42.651326 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:03:42.652426 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:03:42.657019 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m17:03:42.657300 [info ] [MainThread]: 
[0m17:03:42.657545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:03:42.657722 [info ] [MainThread]: 
[0m17:03:42.657906 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:03:42.659315 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.96132123, "process_in_blocks": "0", "process_kernel_time": 0.199554, "process_mem_max_rss": "153911296", "process_out_blocks": "0", "process_user_time": 1.390736}
[0m17:03:42.659657 [debug] [MainThread]: Command `dbt seed` succeeded at 17:03:42.659604 after 0.96 seconds
[0m17:03:42.659898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c0d1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ccf760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048cd7e0>]}
[0m17:03:42.660118 [debug] [MainThread]: Flushing usage events
[0m17:03:43.639153 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:03:46.384972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11101d240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129bf220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129bead0>]}


============================== 17:03:46.389607 | 177fd834-22eb-47d4-875d-8d8254d2c968 ==============================
[0m17:03:46.389607 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:03:46.390068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:03:46.523752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '177fd834-22eb-47d4-875d-8d8254d2c968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11235e320>]}
[0m17:03:46.553738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '177fd834-22eb-47d4-875d-8d8254d2c968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce94e0>]}
[0m17:03:46.556405 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:03:46.611439 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:03:46.676609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:03:46.676913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:03:46.700380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '177fd834-22eb-47d4-875d-8d8254d2c968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113834130>]}
[0m17:03:46.741085 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:03:46.742078 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:03:46.748508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '177fd834-22eb-47d4-875d-8d8254d2c968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113836f20>]}
[0m17:03:46.748832 [info ] [MainThread]: Found 5 models, 4 seeds, 426 macros
[0m17:03:46.749059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '177fd834-22eb-47d4-875d-8d8254d2c968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113836fb0>]}
[0m17:03:46.750031 [info ] [MainThread]: 
[0m17:03:46.750231 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:03:46.750396 [info ] [MainThread]: 
[0m17:03:46.750685 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:03:46.754037 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb'
[0m17:03:46.781863 [debug] [ThreadPool]: Using duckdb connection "list_duckdb"
[0m17:03:46.782313 [debug] [ThreadPool]: On list_duckdb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duckdb"'
    
  
  
[0m17:03:46.782489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:46.790123 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:03:46.790893 [debug] [ThreadPool]: On list_duckdb: Close
[0m17:03:46.792095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_duckdb, now create_duckdb_main)
[0m17:03:46.792376 [debug] [ThreadPool]: Creating schema "database: "duckdb"
schema: "main"
"
[0m17:03:46.796024 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m17:03:46.796232 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='duckdb'
        and type='sqlite'
    
  
[0m17:03:46.796403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:46.801977 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:03:46.802764 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m17:03:46.802945 [debug] [ThreadPool]: On create_duckdb_main: BEGIN
[0m17:03:46.803164 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:03:46.803315 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m17:03:46.803462 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
    
        create schema if not exists "duckdb"."main"
    
[0m17:03:46.803690 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:03:46.804091 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m17:03:46.804249 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m17:03:46.804392 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m17:03:46.804588 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:03:46.804862 [debug] [ThreadPool]: On create_duckdb_main: Close
[0m17:03:46.806570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_duckdb_main, now list_duckdb_main)
[0m17:03:46.810071 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:03:46.810286 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m17:03:46.810442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:46.815769 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:03:46.816011 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:03:46.816191 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m17:03:46.826507 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:03:46.827381 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m17:03:46.827761 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m17:03:46.827926 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m17:03:46.829983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '177fd834-22eb-47d4-875d-8d8254d2c968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a97130>]}
[0m17:03:46.830279 [debug] [MainThread]: Using duckdb connection "master"
[0m17:03:46.830453 [debug] [MainThread]: On master: BEGIN
[0m17:03:46.830606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:03:46.836042 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m17:03:46.836332 [debug] [MainThread]: On master: COMMIT
[0m17:03:46.836507 [debug] [MainThread]: Using duckdb connection "master"
[0m17:03:46.836664 [debug] [MainThread]: On master: COMMIT
[0m17:03:46.836877 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:03:46.837045 [debug] [MainThread]: On master: Close
[0m17:03:46.838629 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_customers
[0m17:03:46.838964 [info ] [Thread-1 (]: 1 of 5 START sql view model main.dim_customers ................................. [RUN]
[0m17:03:46.839235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now model.my_star_schema_project.dim_customers)
[0m17:03:46.839436 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_customers
[0m17:03:46.843815 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_customers"
[0m17:03:46.844232 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_customers
[0m17:03:46.863043 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.dim_customers"
[0m17:03:46.863832 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m17:03:46.864050 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: BEGIN
[0m17:03:46.864239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:46.869679 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:03:46.869966 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m17:03:46.870168 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */

  
  create view "duckdb"."main"."dim_customers__dbt_tmp" as (
    -- models/dim_customers.sql
select 
    customer_id,
    customer_name,
    customer_city,
    customer_state
from "duckdb"."main"."customers"
  );

[0m17:03:46.870528 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.874209 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m17:03:46.874454 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */
alter view "duckdb"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m17:03:46.874840 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.876402 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m17:03:46.876615 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */
alter view "duckdb"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m17:03:46.876912 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.883214 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: COMMIT
[0m17:03:46.883517 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m17:03:46.883712 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: COMMIT
[0m17:03:46.884369 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.888556 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m17:03:46.888859 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */
drop view if exists "duckdb"."main"."dim_customers__dbt_backup" cascade
[0m17:03:46.889344 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.890699 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: Close
[0m17:03:46.893278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '177fd834-22eb-47d4-875d-8d8254d2c968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e57e80>]}
[0m17:03:46.893659 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.dim_customers ............................ [[32mOK[0m in 0.05s]
[0m17:03:46.893977 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_customers
[0m17:03:46.894201 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_dates
[0m17:03:46.894519 [info ] [Thread-1 (]: 2 of 5 START sql view model main.dim_dates ..................................... [RUN]
[0m17:03:46.894799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_customers, now model.my_star_schema_project.dim_dates)
[0m17:03:46.895078 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_dates
[0m17:03:46.896671 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_dates"
[0m17:03:46.897023 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_dates
[0m17:03:46.898986 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.dim_dates"
[0m17:03:46.899327 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m17:03:46.899516 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: BEGIN
[0m17:03:46.899692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:46.905474 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:03:46.905769 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m17:03:46.905966 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */

  
  create view "duckdb"."main"."dim_dates__dbt_tmp" as (
    -- models/dim_dates.sql
select 
    date_key,
    date,
    year,
    month,
    day
from "duckdb"."main"."dates"
  );

[0m17:03:46.906371 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.908918 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m17:03:46.909222 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */
alter view "duckdb"."main"."dim_dates" rename to "dim_dates__dbt_backup"
[0m17:03:46.909635 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.911311 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m17:03:46.911509 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */
alter view "duckdb"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m17:03:46.911792 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.912575 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: COMMIT
[0m17:03:46.912762 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m17:03:46.912930 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: COMMIT
[0m17:03:46.913407 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.914724 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m17:03:46.914929 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */
drop view if exists "duckdb"."main"."dim_dates__dbt_backup" cascade
[0m17:03:46.915351 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.916069 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: Close
[0m17:03:46.918153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '177fd834-22eb-47d4-875d-8d8254d2c968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d85030>]}
[0m17:03:46.918556 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.dim_dates ................................ [[32mOK[0m in 0.02s]
[0m17:03:46.918867 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_dates
[0m17:03:46.919113 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_products
[0m17:03:46.919461 [info ] [Thread-1 (]: 3 of 5 START sql view model main.dim_products .................................. [RUN]
[0m17:03:46.919732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_dates, now model.my_star_schema_project.dim_products)
[0m17:03:46.919934 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_products
[0m17:03:46.922642 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_products"
[0m17:03:46.923207 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_products
[0m17:03:46.959136 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.dim_products"
[0m17:03:46.959648 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m17:03:46.959849 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: BEGIN
[0m17:03:46.960022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:46.965204 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:03:46.965448 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m17:03:46.965664 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */

  
  create view "duckdb"."main"."dim_products__dbt_tmp" as (
    -- models/dim_products.sql

with avg_calc as (
  -- products テーブルから price の平均値（NULL は除外）を計算
  select
    avg(price) as avg_price
  from "duckdb"."main"."products"
  where price is not null
)
select
  p.product_id,
  p.product_name,
  p.product_category,
  -- 欠損している場合は avg_price を利用
  coalesce(p.price, a.avg_price) as price
from "duckdb"."main"."products" as p
cross join avg_calc as a
  );

[0m17:03:46.966156 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.968042 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m17:03:46.968256 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */
alter view "duckdb"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m17:03:46.968587 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.970198 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m17:03:46.970404 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */
alter view "duckdb"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m17:03:46.970704 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.971724 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: COMMIT
[0m17:03:46.971979 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m17:03:46.972167 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: COMMIT
[0m17:03:46.972679 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.973992 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m17:03:46.974184 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */
drop view if exists "duckdb"."main"."dim_products__dbt_backup" cascade
[0m17:03:46.974526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.975187 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: Close
[0m17:03:46.977132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '177fd834-22eb-47d4-875d-8d8254d2c968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e57e80>]}
[0m17:03:46.977519 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.dim_products ............................. [[32mOK[0m in 0.06s]
[0m17:03:46.977829 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_products
[0m17:03:46.978048 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.fact_sales
[0m17:03:46.978335 [info ] [Thread-1 (]: 4 of 5 START sql view model main.fact_sales .................................... [RUN]
[0m17:03:46.978585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_products, now model.my_star_schema_project.fact_sales)
[0m17:03:46.978783 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.fact_sales
[0m17:03:46.980340 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.fact_sales"
[0m17:03:46.980709 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.fact_sales
[0m17:03:46.982658 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.fact_sales"
[0m17:03:46.982988 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m17:03:46.983332 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: BEGIN
[0m17:03:46.983528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:46.990955 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:03:46.991260 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m17:03:46.991452 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */

  
  create view "duckdb"."main"."fact_sales__dbt_tmp" as (
    -- models/fact_sales.sql
select 
    sale_id,
    customer_id,
    product_id,
    date_key,
    quantity,
    total_amount
from "duckdb"."main"."sales"
  );

[0m17:03:46.991820 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.993631 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m17:03:46.993830 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */
alter view "duckdb"."main"."fact_sales" rename to "fact_sales__dbt_backup"
[0m17:03:46.994111 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.996437 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m17:03:46.996632 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */
alter view "duckdb"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m17:03:46.996908 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.997679 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: COMMIT
[0m17:03:46.997861 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m17:03:46.998030 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: COMMIT
[0m17:03:46.998518 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:46.999950 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m17:03:47.000204 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */
drop view if exists "duckdb"."main"."fact_sales__dbt_backup" cascade
[0m17:03:47.000683 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:47.001411 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: Close
[0m17:03:47.003452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '177fd834-22eb-47d4-875d-8d8254d2c968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e57e80>]}
[0m17:03:47.003812 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.fact_sales ............................... [[32mOK[0m in 0.02s]
[0m17:03:47.004110 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.fact_sales
[0m17:03:47.004507 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.star_schema_view
[0m17:03:47.004882 [info ] [Thread-1 (]: 5 of 5 START sql view model main.star_schema_view .............................. [RUN]
[0m17:03:47.005219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.fact_sales, now model.my_star_schema_project.star_schema_view)
[0m17:03:47.005448 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.star_schema_view
[0m17:03:47.007484 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.star_schema_view"
[0m17:03:47.007861 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.star_schema_view
[0m17:03:47.009895 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.star_schema_view"
[0m17:03:47.010405 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m17:03:47.010618 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: BEGIN
[0m17:03:47.010804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:47.016712 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:03:47.017102 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m17:03:47.017362 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */

  
  create view "duckdb"."main"."star_schema_view__dbt_tmp" as (
    -- models/star_schema_view.sql
with fact as (
    select * from "duckdb"."main"."fact_sales"
),
customers as (
    select * from "duckdb"."main"."dim_customers"
),
products as (
    select * from "duckdb"."main"."dim_products"
),
dates as (
    select * from "duckdb"."main"."dim_dates"
)
select
    f.sale_id,
    f.quantity,
    f.total_amount,
    c.customer_id,
    c.customer_name,
    c.customer_city,
    c.customer_state,
    p.product_id,
    p.product_name,
    p.product_category,
    p.price,
    d.date_key,
    d.date,
    d.year,
    d.month,
    d.day
from fact f
left join customers c on f.customer_id = c.customer_id
left join products p on f.product_id = p.product_id
left join dates d on f.date_key = d.date_key
  );

[0m17:03:47.018163 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:03:47.020544 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m17:03:47.020924 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */
alter view "duckdb"."main"."star_schema_view" rename to "star_schema_view__dbt_backup"
[0m17:03:47.021788 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:03:47.024051 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m17:03:47.024293 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */
alter view "duckdb"."main"."star_schema_view__dbt_tmp" rename to "star_schema_view"
[0m17:03:47.024718 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:47.025571 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: COMMIT
[0m17:03:47.025765 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m17:03:47.025949 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: COMMIT
[0m17:03:47.026493 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:47.027802 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m17:03:47.027996 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */
drop view if exists "duckdb"."main"."star_schema_view__dbt_backup" cascade
[0m17:03:47.028367 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:03:47.029081 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: Close
[0m17:03:47.031240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '177fd834-22eb-47d4-875d-8d8254d2c968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e57e80>]}
[0m17:03:47.031680 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.star_schema_view ......................... [[32mOK[0m in 0.03s]
[0m17:03:47.032036 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.star_schema_view
[0m17:03:47.032713 [debug] [MainThread]: Using duckdb connection "master"
[0m17:03:47.032899 [debug] [MainThread]: On master: BEGIN
[0m17:03:47.033058 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:03:47.038892 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m17:03:47.039174 [debug] [MainThread]: On master: COMMIT
[0m17:03:47.039359 [debug] [MainThread]: Using duckdb connection "master"
[0m17:03:47.039525 [debug] [MainThread]: On master: COMMIT
[0m17:03:47.039768 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:03:47.039938 [debug] [MainThread]: On master: Close
[0m17:03:47.041082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:47.041295 [debug] [MainThread]: Connection 'model.my_star_schema_project.star_schema_view' was properly closed.
[0m17:03:47.041528 [info ] [MainThread]: 
[0m17:03:47.041940 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m17:03:47.042617 [debug] [MainThread]: Command end result
[0m17:03:47.056005 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:03:47.057061 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:03:47.061077 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m17:03:47.061325 [info ] [MainThread]: 
[0m17:03:47.061550 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:03:47.061725 [info ] [MainThread]: 
[0m17:03:47.061908 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:03:47.062774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.73635566, "process_in_blocks": "0", "process_kernel_time": 0.157137, "process_mem_max_rss": "136216576", "process_out_blocks": "0", "process_user_time": 1.2422}
[0m17:03:47.063012 [debug] [MainThread]: Command `dbt run` succeeded at 17:03:47.062968 after 0.74 seconds
[0m17:03:47.063231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11101d240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e1cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111440d30>]}
[0m17:03:47.063447 [debug] [MainThread]: Flushing usage events
[0m17:03:48.012746 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:04:38.059231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf52a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b572b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b56b60>]}


============================== 17:04:38.062199 | 0c83ec9c-e7f6-4ec6-82e8-17ef9125f78d ==============================
[0m17:04:38.062199 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:04:38.062606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:04:38.222972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c83ec9c-e7f6-4ec6-82e8-17ef9125f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c887f0>]}
[0m17:04:38.254105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c83ec9c-e7f6-4ec6-82e8-17ef9125f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661f1c0>]}
[0m17:04:38.257286 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:04:38.321123 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:04:38.409247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:04:38.409615 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:04:38.440706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c83ec9c-e7f6-4ec6-82e8-17ef9125f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c81c60>]}
[0m17:04:38.483372 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:04:38.485394 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:04:38.496545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c83ec9c-e7f6-4ec6-82e8-17ef9125f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ac160>]}
[0m17:04:38.496933 [info ] [MainThread]: Found 5 models, 4 seeds, 426 macros
[0m17:04:38.497182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c83ec9c-e7f6-4ec6-82e8-17ef9125f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105780430>]}
[0m17:04:38.498270 [info ] [MainThread]: 
[0m17:04:38.498521 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:04:38.498693 [info ] [MainThread]: 
[0m17:04:38.498987 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:04:38.501752 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb'
[0m17:04:38.535031 [debug] [ThreadPool]: Using duckdb connection "list_duckdb"
[0m17:04:38.535329 [debug] [ThreadPool]: On list_duckdb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duckdb"'
    
  
  
[0m17:04:38.535528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:38.579512 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m17:04:38.580687 [debug] [ThreadPool]: On list_duckdb: Close
[0m17:04:38.583120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_duckdb, now create_duckdb_main)
[0m17:04:38.583673 [debug] [ThreadPool]: Creating schema "database: "duckdb"
schema: "main"
"
[0m17:04:38.587558 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m17:04:38.587765 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='duckdb'
        and type='sqlite'
    
  
[0m17:04:38.587927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:38.593635 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:04:38.594447 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m17:04:38.594630 [debug] [ThreadPool]: On create_duckdb_main: BEGIN
[0m17:04:38.594857 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:04:38.595013 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m17:04:38.595173 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
    
        create schema if not exists "duckdb"."main"
    
[0m17:04:38.595468 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:04:38.595924 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m17:04:38.596090 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m17:04:38.596241 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m17:04:38.596452 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:04:38.596622 [debug] [ThreadPool]: On create_duckdb_main: Close
[0m17:04:38.598411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_duckdb_main, now list_duckdb_main)
[0m17:04:38.601981 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:04:38.602183 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m17:04:38.602339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:38.607658 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:04:38.607910 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:04:38.608093 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m17:04:38.619574 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:04:38.620514 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m17:04:38.621098 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m17:04:38.621273 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m17:04:38.623537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c83ec9c-e7f6-4ec6-82e8-17ef9125f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad2bc0>]}
[0m17:04:38.623852 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:38.624024 [debug] [MainThread]: On master: BEGIN
[0m17:04:38.624182 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:04:38.629675 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m17:04:38.629947 [debug] [MainThread]: On master: COMMIT
[0m17:04:38.630134 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:38.630303 [debug] [MainThread]: On master: COMMIT
[0m17:04:38.630534 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:04:38.630711 [debug] [MainThread]: On master: Close
[0m17:04:38.632434 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.customers
[0m17:04:38.632807 [info ] [Thread-1 (]: 1 of 4 START seed file main.customers .......................................... [RUN]
[0m17:04:38.633075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now seed.my_star_schema_project.customers)
[0m17:04:38.633278 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.customers
[0m17:04:38.633473 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.customers
[0m17:04:38.651898 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m17:04:38.652223 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: BEGIN
[0m17:04:38.652417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:38.658142 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:04:38.658495 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m17:04:38.658710 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.customers"} */
truncate table "duckdb"."main"."customers"
[0m17:04:38.659606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:04:38.666833 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m17:04:38.667192 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: 
          COPY "duckdb"."main"."customers" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:04:38.670932 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:04:38.674622 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.customers"
[0m17:04:38.680245 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: COMMIT
[0m17:04:38.680539 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.customers"
[0m17:04:38.680759 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: COMMIT
[0m17:04:38.682634 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:04:38.684216 [debug] [Thread-1 (]: On seed.my_star_schema_project.customers: Close
[0m17:04:38.689326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c83ec9c-e7f6-4ec6-82e8-17ef9125f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070befe0>]}
[0m17:04:38.689756 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file main.customers ...................................... [[32mINSERT 3[0m in 0.05s]
[0m17:04:38.690081 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.customers
[0m17:04:38.690321 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.dates
[0m17:04:38.690674 [info ] [Thread-1 (]: 2 of 4 START seed file main.dates .............................................. [RUN]
[0m17:04:38.690991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.customers, now seed.my_star_schema_project.dates)
[0m17:04:38.691213 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.dates
[0m17:04:38.691401 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.dates
[0m17:04:38.694452 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m17:04:38.694663 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: BEGIN
[0m17:04:38.694842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:38.701099 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:04:38.701421 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m17:04:38.701619 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.dates"} */
truncate table "duckdb"."main"."dates"
[0m17:04:38.702032 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:38.702853 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m17:04:38.703059 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: 
          COPY "duckdb"."main"."dates" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/dates.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:04:38.704244 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:04:38.704625 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.dates"
[0m17:04:38.705974 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: COMMIT
[0m17:04:38.706264 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.dates"
[0m17:04:38.706494 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: COMMIT
[0m17:04:38.707607 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:04:38.708098 [debug] [Thread-1 (]: On seed.my_star_schema_project.dates: Close
[0m17:04:38.710783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c83ec9c-e7f6-4ec6-82e8-17ef9125f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075fff40>]}
[0m17:04:38.711152 [info ] [Thread-1 (]: 2 of 4 OK loaded seed file main.dates .......................................... [[32mINSERT 3[0m in 0.02s]
[0m17:04:38.711465 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.dates
[0m17:04:38.711695 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.products
[0m17:04:38.712013 [info ] [Thread-1 (]: 3 of 4 START seed file main.products ........................................... [RUN]
[0m17:04:38.712283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.dates, now seed.my_star_schema_project.products)
[0m17:04:38.712494 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.products
[0m17:04:38.712688 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.products
[0m17:04:38.717936 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m17:04:38.718259 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: BEGIN
[0m17:04:38.718441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:38.724708 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:04:38.725068 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m17:04:38.725284 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.products"} */
truncate table "duckdb"."main"."products"
[0m17:04:38.726015 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:38.726922 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m17:04:38.727203 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: 
          COPY "duckdb"."main"."products" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:04:38.728469 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:04:38.728868 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.products"
[0m17:04:38.729911 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: COMMIT
[0m17:04:38.730145 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.products"
[0m17:04:38.730331 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: COMMIT
[0m17:04:38.731412 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:04:38.731847 [debug] [Thread-1 (]: On seed.my_star_schema_project.products: Close
[0m17:04:38.735141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c83ec9c-e7f6-4ec6-82e8-17ef9125f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760b640>]}
[0m17:04:38.735499 [info ] [Thread-1 (]: 3 of 4 OK loaded seed file main.products ....................................... [[32mINSERT 3[0m in 0.02s]
[0m17:04:38.735798 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.products
[0m17:04:38.736024 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.sales
[0m17:04:38.736361 [info ] [Thread-1 (]: 4 of 4 START seed file main.sales .............................................. [RUN]
[0m17:04:38.736651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.products, now seed.my_star_schema_project.sales)
[0m17:04:38.736873 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.sales
[0m17:04:38.737067 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.sales
[0m17:04:38.740705 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m17:04:38.740966 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: BEGIN
[0m17:04:38.741137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:38.746852 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:04:38.747171 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m17:04:38.747386 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "seed.my_star_schema_project.sales"} */
truncate table "duckdb"."main"."sales"
[0m17:04:38.747952 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:38.749086 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m17:04:38.749369 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: 
          COPY "duckdb"."main"."sales" FROM '/Users/takeshiiijima/github/duckdb-dbt/seeds/sales.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:04:38.750914 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:04:38.751471 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_star_schema_project.sales"
[0m17:04:38.752553 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: COMMIT
[0m17:04:38.752760 [debug] [Thread-1 (]: Using duckdb connection "seed.my_star_schema_project.sales"
[0m17:04:38.752934 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: COMMIT
[0m17:04:38.753871 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:04:38.754298 [debug] [Thread-1 (]: On seed.my_star_schema_project.sales: Close
[0m17:04:38.757431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c83ec9c-e7f6-4ec6-82e8-17ef9125f78d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d4160>]}
[0m17:04:38.757831 [info ] [Thread-1 (]: 4 of 4 OK loaded seed file main.sales .......................................... [[32mINSERT 3[0m in 0.02s]
[0m17:04:38.758167 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.sales
[0m17:04:38.758936 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:38.759161 [debug] [MainThread]: On master: BEGIN
[0m17:04:38.759329 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:04:38.765368 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m17:04:38.765681 [debug] [MainThread]: On master: COMMIT
[0m17:04:38.765866 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:38.766020 [debug] [MainThread]: On master: COMMIT
[0m17:04:38.766269 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:04:38.766444 [debug] [MainThread]: On master: Close
[0m17:04:38.767536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:38.767733 [debug] [MainThread]: Connection 'seed.my_star_schema_project.sales' was properly closed.
[0m17:04:38.767930 [info ] [MainThread]: 
[0m17:04:38.768116 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m17:04:38.768669 [debug] [MainThread]: Command end result
[0m17:04:38.814772 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:04:38.816162 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:04:38.820485 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m17:04:38.820707 [info ] [MainThread]: 
[0m17:04:38.820948 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:04:38.821242 [info ] [MainThread]: 
[0m17:04:38.821493 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:04:38.822624 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.8113289, "process_in_blocks": "0", "process_kernel_time": 0.212231, "process_mem_max_rss": "149454848", "process_out_blocks": "0", "process_user_time": 1.267836}
[0m17:04:38.822878 [debug] [MainThread]: Command `dbt seed` succeeded at 17:04:38.822832 after 0.81 seconds
[0m17:04:38.823087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf52a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fec8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c9e40>]}
[0m17:04:38.823297 [debug] [MainThread]: Flushing usage events
[0m17:04:39.617459 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:04:41.515839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10531d2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10612f2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10612eb60>]}


============================== 17:04:41.518165 | 4b87e448-6984-4210-8dad-5633f27ed526 ==============================
[0m17:04:41.518165 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:04:41.518543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:04:41.642561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b87e448-6984-4210-8dad-5633f27ed526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b0b50>]}
[0m17:04:41.672840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b87e448-6984-4210-8dad-5633f27ed526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cb460>]}
[0m17:04:41.675331 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:04:41.727355 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:04:41.784827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:04:41.785176 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:04:41.808757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b87e448-6984-4210-8dad-5633f27ed526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a7fa0>]}
[0m17:04:41.849656 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:04:41.850903 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:04:41.858640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b87e448-6984-4210-8dad-5633f27ed526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066cc160>]}
[0m17:04:41.858977 [info ] [MainThread]: Found 5 models, 4 seeds, 426 macros
[0m17:04:41.859194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b87e448-6984-4210-8dad-5633f27ed526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da4430>]}
[0m17:04:41.860101 [info ] [MainThread]: 
[0m17:04:41.860315 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:04:41.860479 [info ] [MainThread]: 
[0m17:04:41.860750 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:04:41.863513 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb'
[0m17:04:41.890095 [debug] [ThreadPool]: Using duckdb connection "list_duckdb"
[0m17:04:41.890393 [debug] [ThreadPool]: On list_duckdb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duckdb"'
    
  
  
[0m17:04:41.890572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:41.897275 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:04:41.897980 [debug] [ThreadPool]: On list_duckdb: Close
[0m17:04:41.899211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_duckdb, now create_duckdb_main)
[0m17:04:41.899565 [debug] [ThreadPool]: Creating schema "database: "duckdb"
schema: "main"
"
[0m17:04:41.903307 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m17:04:41.903516 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='duckdb'
        and type='sqlite'
    
  
[0m17:04:41.903681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:41.909389 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:04:41.910159 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m17:04:41.910345 [debug] [ThreadPool]: On create_duckdb_main: BEGIN
[0m17:04:41.910560 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:04:41.910716 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m17:04:41.910861 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
    
        create schema if not exists "duckdb"."main"
    
[0m17:04:41.911155 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:04:41.911610 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m17:04:41.911791 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m17:04:41.911946 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m17:04:41.912167 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:04:41.912334 [debug] [ThreadPool]: On create_duckdb_main: Close
[0m17:04:41.913900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_duckdb_main, now list_duckdb_main)
[0m17:04:41.917439 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:04:41.917727 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m17:04:41.917930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:41.924231 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:04:41.924561 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:04:41.924745 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m17:04:41.935279 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:04:41.936182 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m17:04:41.936532 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m17:04:41.936699 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m17:04:41.938863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b87e448-6984-4210-8dad-5633f27ed526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d6b00>]}
[0m17:04:41.939191 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:41.939364 [debug] [MainThread]: On master: BEGIN
[0m17:04:41.939517 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:04:41.944758 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m17:04:41.944974 [debug] [MainThread]: On master: COMMIT
[0m17:04:41.945139 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:41.945292 [debug] [MainThread]: On master: COMMIT
[0m17:04:41.945503 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:04:41.945668 [debug] [MainThread]: On master: Close
[0m17:04:41.947097 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_customers
[0m17:04:41.947404 [info ] [Thread-1 (]: 1 of 5 START sql view model main.dim_customers ................................. [RUN]
[0m17:04:41.947671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now model.my_star_schema_project.dim_customers)
[0m17:04:41.947870 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_customers
[0m17:04:41.952662 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_customers"
[0m17:04:41.953613 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_customers
[0m17:04:41.971380 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.dim_customers"
[0m17:04:41.972401 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m17:04:41.972641 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: BEGIN
[0m17:04:41.972844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:41.978142 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:04:41.978378 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m17:04:41.978585 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */

  
  create view "duckdb"."main"."dim_customers__dbt_tmp" as (
    -- models/dim_customers.sql
select 
    customer_id,
    customer_name,
    customer_city,
    customer_state
from "duckdb"."main"."customers"
  );

[0m17:04:41.978940 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:41.982524 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m17:04:41.982750 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */
alter view "duckdb"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m17:04:41.983101 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:41.984967 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m17:04:41.985236 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */
alter view "duckdb"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m17:04:41.985623 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:41.992649 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: COMMIT
[0m17:04:41.992957 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m17:04:41.993151 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: COMMIT
[0m17:04:41.993774 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:41.997077 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m17:04:41.997299 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */
drop view if exists "duckdb"."main"."dim_customers__dbt_backup" cascade
[0m17:04:41.997689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:41.999020 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: Close
[0m17:04:42.001849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b87e448-6984-4210-8dad-5633f27ed526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043cbee0>]}
[0m17:04:42.002255 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.dim_customers ............................ [[32mOK[0m in 0.05s]
[0m17:04:42.002578 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_customers
[0m17:04:42.002809 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_dates
[0m17:04:42.003085 [info ] [Thread-1 (]: 2 of 5 START sql view model main.dim_dates ..................................... [RUN]
[0m17:04:42.003338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_customers, now model.my_star_schema_project.dim_dates)
[0m17:04:42.003538 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_dates
[0m17:04:42.005330 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_dates"
[0m17:04:42.005770 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_dates
[0m17:04:42.007767 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.dim_dates"
[0m17:04:42.008111 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m17:04:42.008306 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: BEGIN
[0m17:04:42.008751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:42.014666 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:04:42.014987 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m17:04:42.015186 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */

  
  create view "duckdb"."main"."dim_dates__dbt_tmp" as (
    -- models/dim_dates.sql
select 
    date_key,
    date,
    year,
    month,
    day
from "duckdb"."main"."dates"
  );

[0m17:04:42.015699 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.017532 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m17:04:42.017739 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */
alter view "duckdb"."main"."dim_dates" rename to "dim_dates__dbt_backup"
[0m17:04:42.018071 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.019751 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m17:04:42.019982 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */
alter view "duckdb"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m17:04:42.020327 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.021584 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: COMMIT
[0m17:04:42.022357 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m17:04:42.022599 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: COMMIT
[0m17:04:42.023523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:04:42.025091 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m17:04:42.025297 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */
drop view if exists "duckdb"."main"."dim_dates__dbt_backup" cascade
[0m17:04:42.025738 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.026490 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: Close
[0m17:04:42.028580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b87e448-6984-4210-8dad-5633f27ed526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1d090>]}
[0m17:04:42.028948 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.dim_dates ................................ [[32mOK[0m in 0.03s]
[0m17:04:42.029263 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_dates
[0m17:04:42.029484 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_products
[0m17:04:42.029777 [info ] [Thread-1 (]: 3 of 5 START sql view model main.dim_products .................................. [RUN]
[0m17:04:42.030032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_dates, now model.my_star_schema_project.dim_products)
[0m17:04:42.030235 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_products
[0m17:04:42.032082 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_products"
[0m17:04:42.032603 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_products
[0m17:04:42.068104 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.dim_products"
[0m17:04:42.068627 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m17:04:42.068830 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: BEGIN
[0m17:04:42.069006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:42.074631 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:04:42.074906 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m17:04:42.075116 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */

  
  create view "duckdb"."main"."dim_products__dbt_tmp" as (
    -- models/dim_products.sql

with avg_calc as (
  -- products テーブルから price の平均値（NULL は除外）を計算
  select
    avg(price) as avg_price
  from "duckdb"."main"."products"
  where price is not null
)
select
  p.product_id,
  p.product_name,
  p.product_category,
  -- 欠損している場合は avg_price を利用
  coalesce(p.price, a.avg_price) as price
from "duckdb"."main"."products" as p
cross join avg_calc as a
  );

[0m17:04:42.075567 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.077421 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m17:04:42.077625 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */
alter view "duckdb"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m17:04:42.077951 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.079513 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m17:04:42.079716 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */
alter view "duckdb"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m17:04:42.080012 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.080891 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: COMMIT
[0m17:04:42.081085 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m17:04:42.081263 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: COMMIT
[0m17:04:42.081748 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.083064 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m17:04:42.083254 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */
drop view if exists "duckdb"."main"."dim_products__dbt_backup" cascade
[0m17:04:42.083608 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.084321 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: Close
[0m17:04:42.086871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b87e448-6984-4210-8dad-5633f27ed526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510a7d0>]}
[0m17:04:42.087484 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.dim_products ............................. [[32mOK[0m in 0.06s]
[0m17:04:42.087862 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_products
[0m17:04:42.088131 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.fact_sales
[0m17:04:42.088560 [info ] [Thread-1 (]: 4 of 5 START sql view model main.fact_sales .................................... [RUN]
[0m17:04:42.088876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_products, now model.my_star_schema_project.fact_sales)
[0m17:04:42.089094 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.fact_sales
[0m17:04:42.090766 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.fact_sales"
[0m17:04:42.091167 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.fact_sales
[0m17:04:42.093094 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.fact_sales"
[0m17:04:42.093438 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m17:04:42.093631 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: BEGIN
[0m17:04:42.093807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:42.099567 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:04:42.099845 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m17:04:42.100041 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */

  
  create view "duckdb"."main"."fact_sales__dbt_tmp" as (
    -- models/fact_sales.sql
select 
    sale_id,
    customer_id,
    product_id,
    date_key,
    quantity,
    total_amount
from "duckdb"."main"."sales"
  );

[0m17:04:42.100426 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.102208 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m17:04:42.102408 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */
alter view "duckdb"."main"."fact_sales" rename to "fact_sales__dbt_backup"
[0m17:04:42.102698 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.105136 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m17:04:42.105471 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */
alter view "duckdb"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m17:04:42.105869 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.106804 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: COMMIT
[0m17:04:42.107046 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m17:04:42.107229 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: COMMIT
[0m17:04:42.107811 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.109556 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m17:04:42.109859 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */
drop view if exists "duckdb"."main"."fact_sales__dbt_backup" cascade
[0m17:04:42.110364 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.111091 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: Close
[0m17:04:42.113114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b87e448-6984-4210-8dad-5633f27ed526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043cbee0>]}
[0m17:04:42.113488 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.fact_sales ............................... [[32mOK[0m in 0.02s]
[0m17:04:42.113835 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.fact_sales
[0m17:04:42.114210 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.star_schema_view
[0m17:04:42.114520 [info ] [Thread-1 (]: 5 of 5 START sql view model main.star_schema_view .............................. [RUN]
[0m17:04:42.114768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.fact_sales, now model.my_star_schema_project.star_schema_view)
[0m17:04:42.114965 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.star_schema_view
[0m17:04:42.117139 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.star_schema_view"
[0m17:04:42.117687 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.star_schema_view
[0m17:04:42.120044 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.star_schema_view"
[0m17:04:42.120802 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m17:04:42.121019 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: BEGIN
[0m17:04:42.121248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:42.128407 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:04:42.128721 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m17:04:42.128941 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */

  
  create view "duckdb"."main"."star_schema_view__dbt_tmp" as (
    -- models/star_schema_view.sql
with fact as (
    select * from "duckdb"."main"."fact_sales"
),
customers as (
    select * from "duckdb"."main"."dim_customers"
),
products as (
    select * from "duckdb"."main"."dim_products"
),
dates as (
    select * from "duckdb"."main"."dim_dates"
)
select
    f.sale_id,
    f.quantity,
    f.total_amount,
    c.customer_id,
    c.customer_name,
    c.customer_city,
    c.customer_state,
    p.product_id,
    p.product_name,
    p.product_category,
    p.price,
    d.date_key,
    d.date,
    d.year,
    d.month,
    d.day
from fact f
left join customers c on f.customer_id = c.customer_id
left join products p on f.product_id = p.product_id
left join dates d on f.date_key = d.date_key
  );

[0m17:04:42.129683 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:04:42.131671 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m17:04:42.131965 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */
alter view "duckdb"."main"."star_schema_view" rename to "star_schema_view__dbt_backup"
[0m17:04:42.132341 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.134157 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m17:04:42.134397 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */
alter view "duckdb"."main"."star_schema_view__dbt_tmp" rename to "star_schema_view"
[0m17:04:42.134763 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.135604 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: COMMIT
[0m17:04:42.135792 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m17:04:42.135968 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: COMMIT
[0m17:04:42.136482 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.137771 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m17:04:42.137956 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */
drop view if exists "duckdb"."main"."star_schema_view__dbt_backup" cascade
[0m17:04:42.138382 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:04:42.139353 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: Close
[0m17:04:42.141513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b87e448-6984-4210-8dad-5633f27ed526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d4820>]}
[0m17:04:42.141901 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.star_schema_view ......................... [[32mOK[0m in 0.03s]
[0m17:04:42.142205 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.star_schema_view
[0m17:04:42.142779 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:42.142969 [debug] [MainThread]: On master: BEGIN
[0m17:04:42.143126 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:04:42.148314 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m17:04:42.148538 [debug] [MainThread]: On master: COMMIT
[0m17:04:42.148955 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:42.149149 [debug] [MainThread]: On master: COMMIT
[0m17:04:42.149428 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:04:42.149602 [debug] [MainThread]: On master: Close
[0m17:04:42.150735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:42.150902 [debug] [MainThread]: Connection 'model.my_star_schema_project.star_schema_view' was properly closed.
[0m17:04:42.151108 [info ] [MainThread]: 
[0m17:04:42.151298 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m17:04:42.151977 [debug] [MainThread]: Command end result
[0m17:04:42.167825 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:04:42.168876 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:04:42.173040 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m17:04:42.173326 [info ] [MainThread]: 
[0m17:04:42.173618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:04:42.173842 [info ] [MainThread]: 
[0m17:04:42.174042 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:04:42.174932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.69724566, "process_in_blocks": "0", "process_kernel_time": 0.139992, "process_mem_max_rss": "138543104", "process_out_blocks": "0", "process_user_time": 1.219676}
[0m17:04:42.175290 [debug] [MainThread]: Command `dbt run` succeeded at 17:04:42.175215 after 0.70 seconds
[0m17:04:42.175618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10531d2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ab220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c5e290>]}
[0m17:04:42.175874 [debug] [MainThread]: Flushing usage events
[0m17:04:43.169170 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:47.593340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fc9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd6b60>]}


============================== 17:10:47.596623 | 7a2eaf2d-adf5-4ec3-a369-24cee119c673 ==============================
[0m17:10:47.596623 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:10:47.596982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:10:47.743295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a2eaf2d-adf5-4ec3-a369-24cee119c673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038a2fe0>]}
[0m17:10:47.773400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a2eaf2d-adf5-4ec3-a369-24cee119c673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c89870>]}
[0m17:10:47.776451 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:10:47.831741 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:10:47.904408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:10:47.904681 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:10:47.928720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a2eaf2d-adf5-4ec3-a369-24cee119c673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10437c130>]}
[0m17:10:47.969805 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:10:47.971089 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:10:47.982072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a2eaf2d-adf5-4ec3-a369-24cee119c673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043529e0>]}
[0m17:10:47.982407 [info ] [MainThread]: Found 5 models, 4 seeds, 426 macros
[0m17:10:47.982600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a2eaf2d-adf5-4ec3-a369-24cee119c673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104352a10>]}
[0m17:10:47.983522 [info ] [MainThread]: 
[0m17:10:47.983719 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:47.983877 [info ] [MainThread]: 
[0m17:10:47.984140 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:10:47.986853 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb'
[0m17:10:48.016910 [debug] [ThreadPool]: Using duckdb connection "list_duckdb"
[0m17:10:48.017170 [debug] [ThreadPool]: On list_duckdb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duckdb"'
    
  
  
[0m17:10:48.017337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:48.022393 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duckdb"'
    
  
  
[0m17:10:48.022697 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:10:48.023148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:48.023311 [debug] [MainThread]: Connection 'list_duckdb' was properly closed.
[0m17:10:48.023466 [info ] [MainThread]: 
[0m17:10:48.023766 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m17:10:48.024182 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/takeshiiijima/github/duckdb-dbt/./duckdb.db": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.2.0/bin/duckdb (PID 95818) by user takeshiiijima. See also https://duckdb.org/docs/connect/concurrency
[0m17:10:48.025332 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5238514, "process_in_blocks": "0", "process_kernel_time": 0.211586, "process_mem_max_rss": "121585664", "process_out_blocks": "0", "process_user_time": 1.107625}
[0m17:10:48.025630 [debug] [MainThread]: Command `dbt run` failed at 17:10:48.025576 after 0.52 seconds
[0m17:10:48.025919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fc9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104353190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439f6d0>]}
[0m17:10:48.026155 [debug] [MainThread]: Flushing usage events
[0m17:10:48.939992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:03.550050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c1150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10601c100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10601dd50>]}


============================== 17:12:03.553366 | 82118bf3-8cae-433f-8686-dca31c127239 ==============================
[0m17:12:03.553366 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:12:03.553720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:12:03.694521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82118bf3-8cae-433f-8686-dca31c127239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9efe0>]}
[0m17:12:03.726476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82118bf3-8cae-433f-8686-dca31c127239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e81870>]}
[0m17:12:03.729411 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:12:03.786509 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:12:03.858659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:12:03.858950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:12:03.883527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82118bf3-8cae-433f-8686-dca31c127239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107934130>]}
[0m17:12:03.926598 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:12:03.928197 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:12:03.940789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82118bf3-8cae-433f-8686-dca31c127239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790ea10>]}
[0m17:12:03.941377 [info ] [MainThread]: Found 5 models, 4 seeds, 426 macros
[0m17:12:03.941658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82118bf3-8cae-433f-8686-dca31c127239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107947550>]}
[0m17:12:03.942794 [info ] [MainThread]: 
[0m17:12:03.943020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:12:03.943191 [info ] [MainThread]: 
[0m17:12:03.943487 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:12:03.946247 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb'
[0m17:12:03.977968 [debug] [ThreadPool]: Using duckdb connection "list_duckdb"
[0m17:12:03.978256 [debug] [ThreadPool]: On list_duckdb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duckdb"'
    
  
  
[0m17:12:03.978436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:03.983287 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duckdb"'
    
  
  
[0m17:12:03.983660 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:12:03.984196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:03.984382 [debug] [MainThread]: Connection 'list_duckdb' was properly closed.
[0m17:12:03.984562 [info ] [MainThread]: 
[0m17:12:03.984757 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m17:12:03.985049 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/takeshiiijima/github/duckdb-dbt/./duckdb.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.10/3.10.16/Frameworks/Python.framework/Versions/3.10/Resources/Python.app/Contents/MacOS/Python (PID 67038) by user takeshiiijima. See also https://duckdb.org/docs/connect/concurrency
[0m17:12:03.986080 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.48070458, "process_in_blocks": "0", "process_kernel_time": 0.231614, "process_mem_max_rss": "121094144", "process_out_blocks": "0", "process_user_time": 1.138389}
[0m17:12:03.986353 [debug] [MainThread]: Command `dbt seed` failed at 17:12:03.986301 after 0.48 seconds
[0m17:12:03.986574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c1150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107947550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079592d0>]}
[0m17:12:03.986798 [debug] [MainThread]: Flushing usage events
[0m17:12:04.731217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:25.592593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b1d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897ae30>]}


============================== 17:23:25.595781 | 8817d667-a139-4ebe-998c-80d228504f84 ==============================
[0m17:23:25.595781 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:23:25.596134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:23:25.732936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8817d667-a139-4ebe-998c-80d228504f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab0fa0>]}
[0m17:23:25.763431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8817d667-a139-4ebe-998c-80d228504f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a127d0>]}
[0m17:23:25.766591 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:23:25.822751 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:23:25.893263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:23:25.893579 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:23:25.918391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8817d667-a139-4ebe-998c-80d228504f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ecc040>]}
[0m17:23:25.963415 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:23:25.966365 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:23:25.982747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8817d667-a139-4ebe-998c-80d228504f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbc2e0>]}
[0m17:23:25.983456 [info ] [MainThread]: Found 5 models, 4 seeds, 426 macros
[0m17:23:25.983709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8817d667-a139-4ebe-998c-80d228504f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbc940>]}
[0m17:23:25.984400 [info ] [MainThread]: my_star_schema_project.dim_customers
[0m17:23:25.984718 [info ] [MainThread]: my_star_schema_project.dim_dates
[0m17:23:25.985019 [info ] [MainThread]: my_star_schema_project.dim_products
[0m17:23:25.985583 [info ] [MainThread]: my_star_schema_project.fact_sales
[0m17:23:25.985786 [info ] [MainThread]: my_star_schema_project.star_schema_view
[0m17:23:25.986070 [info ] [MainThread]: my_star_schema_project.customers
[0m17:23:25.986230 [info ] [MainThread]: my_star_schema_project.dates
[0m17:23:25.986382 [info ] [MainThread]: my_star_schema_project.products
[0m17:23:25.986533 [info ] [MainThread]: my_star_schema_project.sales
[0m17:23:25.987666 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.4408838, "process_in_blocks": "0", "process_kernel_time": 0.129538, "process_mem_max_rss": "109494272", "process_out_blocks": "0", "process_user_time": 0.947333}
[0m17:23:25.987961 [debug] [MainThread]: Command `dbt ls` succeeded at 17:23:25.987908 after 0.44 seconds
[0m17:23:25.988215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b1d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eabd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbcb50>]}
[0m17:23:25.988444 [debug] [MainThread]: Flushing usage events
[0m17:23:27.058407 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:35.869935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca5270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab6c80>]}


============================== 17:23:35.872668 | 7d50ff5b-e349-448f-8d01-c7150d3df5bc ==============================
[0m17:23:35.872668 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:23:35.873021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m17:23:36.002501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d50ff5b-e349-448f-8d01-c7150d3df5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c3a260>]}
[0m17:23:36.033253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d50ff5b-e349-448f-8d01-c7150d3df5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089642e0>]}
[0m17:23:36.036924 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:23:36.095777 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:23:36.163036 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:23:36.163306 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:23:36.187718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d50ff5b-e349-448f-8d01-c7150d3df5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e7fc40>]}
[0m17:23:36.198302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d50ff5b-e349-448f-8d01-c7150d3df5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e7ce20>]}
[0m17:23:36.198785 [info ] [MainThread]: Found 5 models, 4 seeds, 426 macros
[0m17:23:36.199014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d50ff5b-e349-448f-8d01-c7150d3df5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e7ce80>]}
[0m17:23:36.199973 [info ] [MainThread]: 
[0m17:23:36.200193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:36.200362 [info ] [MainThread]: 
[0m17:23:36.200639 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:23:36.203540 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb_main'
[0m17:23:36.237224 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:23:36.237500 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m17:23:36.237677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:36.243369 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m17:23:36.243830 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:23:36.244385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:36.244600 [debug] [MainThread]: Connection 'list_duckdb_main' was properly closed.
[0m17:23:36.244960 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/takeshiiijima/github/duckdb-dbt/./duckdb.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.10/3.10.16/Frameworks/Python.framework/Versions/3.10/Resources/Python.app/Contents/MacOS/Python (PID 67038) by user takeshiiijima. See also https://duckdb.org/docs/connect/concurrency
[0m17:23:36.246267 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.41693485, "process_in_blocks": "0", "process_kernel_time": 0.152737, "process_mem_max_rss": "120520704", "process_out_blocks": "0", "process_user_time": 0.944215}
[0m17:23:36.246566 [debug] [MainThread]: Command `dbt docs generate` failed at 17:23:36.246513 after 0.42 seconds
[0m17:23:36.246799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca5270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e7dc30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c7400>]}
[0m17:23:36.247074 [debug] [MainThread]: Flushing usage events
[0m17:23:37.018664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:46.803405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ac5270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bc33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bc2c80>]}


============================== 17:23:46.806064 | 7878160f-7b02-4c0e-a1d9-347ef591cf2f ==============================
[0m17:23:46.806064 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:23:46.806407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:23:46.930759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7878160f-7b02-4c0e-a1d9-347ef591cf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e1a260>]}
[0m17:23:46.960646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7878160f-7b02-4c0e-a1d9-347ef591cf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a442e0>]}
[0m17:23:46.964020 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:23:47.019844 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:23:47.085415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:23:47.085683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:23:47.108713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7878160f-7b02-4c0e-a1d9-347ef591cf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11331fc40>]}
[0m17:23:47.125610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7878160f-7b02-4c0e-a1d9-347ef591cf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11331ce20>]}
[0m17:23:47.129463 [info ] [MainThread]: Found 5 models, 4 seeds, 426 macros
[0m17:23:47.129700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7878160f-7b02-4c0e-a1d9-347ef591cf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11331ce80>]}
[0m17:23:47.130727 [info ] [MainThread]: 
[0m17:23:47.130960 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:47.131138 [info ] [MainThread]: 
[0m17:23:47.131435 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:23:47.134870 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb_main'
[0m17:23:47.169597 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:23:47.169866 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m17:23:47.170037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:47.174663 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m17:23:47.174895 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:23:47.175327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:47.175515 [debug] [MainThread]: Connection 'list_duckdb_main' was properly closed.
[0m17:23:47.175862 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/takeshiiijima/github/duckdb-dbt/./duckdb.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.10/3.10.16/Frameworks/Python.framework/Versions/3.10/Resources/Python.app/Contents/MacOS/Python (PID 67038) by user takeshiiijima. See also https://duckdb.org/docs/connect/concurrency
[0m17:23:47.176898 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.41229156, "process_in_blocks": "0", "process_kernel_time": 0.143952, "process_mem_max_rss": "120815616", "process_out_blocks": "0", "process_user_time": 0.938037}
[0m17:23:47.177152 [debug] [MainThread]: Command `dbt docs generate` failed at 17:23:47.177105 after 0.41 seconds
[0m17:23:47.177357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ac5270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11331dc30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134a7400>]}
[0m17:23:47.177563 [debug] [MainThread]: Flushing usage events
[0m17:23:48.094232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:39.826517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10316d1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fab370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103faac20>]}


============================== 17:24:39.829692 | 9037ad38-ef08-4fb6-bb9a-742da2057773 ==============================
[0m17:24:39.829692 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:24:39.830043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:24:39.980942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9037ad38-ef08-4fb6-bb9a-742da2057773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104102b60>]}
[0m17:24:40.027272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9037ad38-ef08-4fb6-bb9a-742da2057773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1bbb0>]}
[0m17:24:40.031351 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:24:40.094953 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:24:40.161362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:24:40.161626 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:24:40.184737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9037ad38-ef08-4fb6-bb9a-742da2057773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040abe80>]}
[0m17:24:40.195944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9037ad38-ef08-4fb6-bb9a-742da2057773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104358eb0>]}
[0m17:24:40.196261 [info ] [MainThread]: Found 5 models, 4 seeds, 426 macros
[0m17:24:40.196465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9037ad38-ef08-4fb6-bb9a-742da2057773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104358f10>]}
[0m17:24:40.197357 [info ] [MainThread]: 
[0m17:24:40.197634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:40.197982 [info ] [MainThread]: 
[0m17:24:40.198307 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:24:40.201175 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb_main'
[0m17:24:40.232814 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:24:40.233081 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m17:24:40.233246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:40.255561 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m17:24:40.255850 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:24:40.256037 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m17:24:40.269694 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m17:24:40.270762 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m17:24:40.271303 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m17:24:40.271475 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m17:24:40.273874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9037ad38-ef08-4fb6-bb9a-742da2057773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104359c90>]}
[0m17:24:40.275222 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.customers
[0m17:24:40.275475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now seed.my_star_schema_project.customers)
[0m17:24:40.275671 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.customers
[0m17:24:40.279969 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.customers
[0m17:24:40.280344 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.customers
[0m17:24:40.280546 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.dates
[0m17:24:40.280808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.customers, now seed.my_star_schema_project.dates)
[0m17:24:40.280999 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.dates
[0m17:24:40.282009 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.dates
[0m17:24:40.282491 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.dates
[0m17:24:40.282694 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.products
[0m17:24:40.282943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.dates, now seed.my_star_schema_project.products)
[0m17:24:40.283133 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.products
[0m17:24:40.284137 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.products
[0m17:24:40.284446 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.products
[0m17:24:40.284634 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.sales
[0m17:24:40.284857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.products, now seed.my_star_schema_project.sales)
[0m17:24:40.285035 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.sales
[0m17:24:40.286020 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.sales
[0m17:24:40.286335 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.sales
[0m17:24:40.286526 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_customers
[0m17:24:40.286750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.sales, now model.my_star_schema_project.dim_customers)
[0m17:24:40.286933 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_customers
[0m17:24:40.288392 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_customers"
[0m17:24:40.289056 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_customers
[0m17:24:40.289389 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_customers
[0m17:24:40.289580 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_dates
[0m17:24:40.289773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_customers, now model.my_star_schema_project.dim_dates)
[0m17:24:40.289952 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_dates
[0m17:24:40.291342 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_dates"
[0m17:24:40.291776 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_dates
[0m17:24:40.292084 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_dates
[0m17:24:40.292273 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_products
[0m17:24:40.292479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_dates, now model.my_star_schema_project.dim_products)
[0m17:24:40.292662 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_products
[0m17:24:40.294183 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_products"
[0m17:24:40.294484 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_products
[0m17:24:40.294797 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_products
[0m17:24:40.294985 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.fact_sales
[0m17:24:40.295200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_products, now model.my_star_schema_project.fact_sales)
[0m17:24:40.295431 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.fact_sales
[0m17:24:40.296738 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.fact_sales"
[0m17:24:40.297026 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.fact_sales
[0m17:24:40.297339 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.fact_sales
[0m17:24:40.297665 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.star_schema_view
[0m17:24:40.297965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.fact_sales, now model.my_star_schema_project.star_schema_view)
[0m17:24:40.298172 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.star_schema_view
[0m17:24:40.300766 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.star_schema_view"
[0m17:24:40.301295 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.star_schema_view
[0m17:24:40.301650 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.star_schema_view
[0m17:24:40.302103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:40.302277 [debug] [MainThread]: Connection 'model.my_star_schema_project.star_schema_view' was properly closed.
[0m17:24:40.303027 [debug] [MainThread]: Command end result
[0m17:24:40.341714 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:24:40.343076 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:24:40.347129 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m17:24:40.349635 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m17:24:40.349887 [info ] [MainThread]: Building catalog
[0m17:24:40.355098 [debug] [ThreadPool]: Acquiring new duckdb connection 'duckdb.information_schema'
[0m17:24:40.359716 [debug] [ThreadPool]: Using duckdb connection "duckdb.information_schema"
[0m17:24:40.360014 [debug] [ThreadPool]: On duckdb.information_schema: BEGIN
[0m17:24:40.360180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:40.365724 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:24:40.366021 [debug] [ThreadPool]: Using duckdb connection "duckdb.information_schema"
[0m17:24:40.366236 [debug] [ThreadPool]: On duckdb.information_schema: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "duckdb.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'duckdb'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'duckdb'
    )
    select
        'duckdb' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m17:24:40.378540 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m17:24:40.394442 [debug] [ThreadPool]: On duckdb.information_schema: ROLLBACK
[0m17:24:40.394782 [debug] [ThreadPool]: Failed to rollback 'duckdb.information_schema'
[0m17:24:40.394946 [debug] [ThreadPool]: On duckdb.information_schema: Close
[0m17:24:40.410715 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/takeshiiijima/github/duckdb-dbt/target/catalog.json
[0m17:24:40.450566 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:24:40.451481 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:24:40.451666 [info ] [MainThread]: Catalog written to /Users/takeshiiijima/github/duckdb-dbt/target/catalog.json
[0m17:24:40.452809 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.6642435, "process_in_blocks": "0", "process_kernel_time": 0.166724, "process_mem_max_rss": "137084928", "process_out_blocks": "0", "process_user_time": 1.12801}
[0m17:24:40.453087 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:24:40.453038 after 0.66 seconds
[0m17:24:40.453286 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:24:40.453441 [debug] [MainThread]: Connection 'duckdb.information_schema' was properly closed.
[0m17:24:40.453624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10316d1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020e6e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022d9f60>]}
[0m17:24:40.453838 [debug] [MainThread]: Flushing usage events
[0m17:24:41.209065 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:05.382254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036992d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a3ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a2d40>]}


============================== 17:25:05.385303 | 50109cc3-3018-4223-9b53-bf37ea70edcb ==============================
[0m17:25:05.385303 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:25:05.385651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:25:05.535428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50109cc3-3018-4223-9b53-bf37ea70edcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102747640>]}
[0m17:25:05.565937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50109cc3-3018-4223-9b53-bf37ea70edcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104359930>]}
[0m17:31:05.973545 [error] [MainThread]: Encountered an error:

[0m17:31:05.984014 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/opt/homebrew/Cellar/python@3.10/3.10.16/Frameworks/Python.framework/Versions/3.10/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.10/3.10.16/Frameworks/Python.framework/Versions/3.10/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m17:31:05.990221 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 360.66196, "process_in_blocks": "0", "process_kernel_time": 0.153575, "process_mem_max_rss": "105316352", "process_out_blocks": "0", "process_user_time": 0.833521}
[0m17:31:05.992367 [debug] [MainThread]: Command `dbt docs serve` failed at 17:31:05.991365 after 360.66 seconds
[0m17:31:05.993839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036992d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475ba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475b9a0>]}
[0m17:31:05.994766 [debug] [MainThread]: Flushing usage events
[0m17:31:11.138649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103055240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eb73a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eb6c50>]}


============================== 17:31:11.141519 | ec0f98a6-43ce-446e-ad88-8e2fd47592d9 ==============================
[0m17:31:11.141519 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:31:11.141939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:31:11.281553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec0f98a6-43ce-446e-ad88-8e2fd47592d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fe9180>]}
[0m17:31:11.312207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec0f98a6-43ce-446e-ad88-8e2fd47592d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f55600>]}
[0m17:31:11.315390 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:31:11.371532 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:31:11.441832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:31:11.442260 [debug] [MainThread]: Partial parsing: added file: my_star_schema_project://models/schema.yml
[0m17:31:11.591458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec0f98a6-43ce-446e-ad88-8e2fd47592d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b44f0>]}
[0m17:31:11.642270 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:31:11.643862 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:31:11.662172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec0f98a6-43ce-446e-ad88-8e2fd47592d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b6380>]}
[0m17:31:11.662563 [info ] [MainThread]: Found 5 models, 4 seeds, 5 data tests, 426 macros
[0m17:31:11.662779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec0f98a6-43ce-446e-ad88-8e2fd47592d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b63e0>]}
[0m17:31:11.663776 [info ] [MainThread]: 
[0m17:31:11.663984 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:11.664155 [info ] [MainThread]: 
[0m17:31:11.664446 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:31:11.667388 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb_main'
[0m17:31:11.729514 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:31:11.729853 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m17:31:11.730036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:11.774161 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m17:31:11.774452 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:31:11.774634 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m17:31:11.790908 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m17:31:11.792045 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m17:31:11.792667 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m17:31:11.792895 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m17:31:11.795700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec0f98a6-43ce-446e-ad88-8e2fd47592d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b5c60>]}
[0m17:31:11.796021 [debug] [MainThread]: Using duckdb connection "master"
[0m17:31:11.796190 [debug] [MainThread]: On master: BEGIN
[0m17:31:11.796344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:31:11.801735 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m17:31:11.802002 [debug] [MainThread]: On master: COMMIT
[0m17:31:11.802188 [debug] [MainThread]: Using duckdb connection "master"
[0m17:31:11.802350 [debug] [MainThread]: On master: COMMIT
[0m17:31:11.802583 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:31:11.802754 [debug] [MainThread]: On master: Close
[0m17:31:11.804196 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:31:11.804451 [info ] [Thread-1 (]: 1 of 5 START test not_null_dim_products_price .................................. [RUN]
[0m17:31:11.804713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now test.my_star_schema_project.not_null_dim_products_price.93519fc0ed)
[0m17:31:11.804924 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:31:11.815578 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:31:11.816190 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:31:11.824686 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:31:11.825308 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:31:11.825539 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_price.93519fc0ed: BEGIN
[0m17:31:11.825736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:11.831691 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:31:11.832048 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:31:11.832271 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from "duckdb"."main"."dim_products"
where price is null



      
    ) dbt_internal_test
[0m17:31:11.835196 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:31:11.837643 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m17:31:11.837922 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_price.93519fc0ed'
[0m17:31:11.838118 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_price.93519fc0ed: Close
[0m17:31:11.839429 [info ] [Thread-1 (]: 1 of 5 PASS not_null_dim_products_price ........................................ [[32mPASS[0m in 0.03s]
[0m17:31:11.839795 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:31:11.840028 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:31:11.840288 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_products_product_category ....................... [RUN]
[0m17:31:11.840555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_price.93519fc0ed, now test.my_star_schema_project.not_null_dim_products_product_category.069796c541)
[0m17:31:11.840769 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:31:11.843307 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:31:11.843831 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:31:11.846151 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:31:11.847061 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:31:11.847321 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_category.069796c541: BEGIN
[0m17:31:11.847552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:11.854225 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:31:11.854556 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:31:11.854762 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_category.069796c541: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_category
from "duckdb"."main"."dim_products"
where product_category is null



      
    ) dbt_internal_test
[0m17:31:11.855605 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:31:11.856469 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_category.069796c541: ROLLBACK
[0m17:31:11.856730 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_product_category.069796c541'
[0m17:31:11.856912 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_category.069796c541: Close
[0m17:31:11.858068 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_products_product_category ............................. [[32mPASS[0m in 0.02s]
[0m17:31:11.858439 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:31:11.858675 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:31:11.858890 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_products_product_id ............................. [RUN]
[0m17:31:11.859183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_category.069796c541, now test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1)
[0m17:31:11.859391 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:31:11.862311 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:31:11.862826 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:31:11.864459 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:31:11.864962 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:31:11.865170 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m17:31:11.865345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:11.871430 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:31:11.871794 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:31:11.872006 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "duckdb"."main"."dim_products"
where product_id is null



      
    ) dbt_internal_test
[0m17:31:11.872862 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:31:11.873722 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m17:31:11.873972 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1'
[0m17:31:11.874153 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m17:31:11.875399 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_products_product_id ................................... [[32mPASS[0m in 0.02s]
[0m17:31:11.875756 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:31:11.875986 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:31:11.876236 [info ] [Thread-1 (]: 4 of 5 START test not_null_dim_products_product_name ........................... [RUN]
[0m17:31:11.876489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1, now test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3)
[0m17:31:11.876696 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:31:11.879312 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:31:11.879764 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:31:11.881096 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:31:11.881436 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:31:11.881829 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3: BEGIN
[0m17:31:11.882049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:11.888065 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:31:11.888395 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:31:11.888604 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_name
from "duckdb"."main"."dim_products"
where product_name is null



      
    ) dbt_internal_test
[0m17:31:11.889400 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:31:11.890274 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3: ROLLBACK
[0m17:31:11.890529 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3'
[0m17:31:11.890713 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3: Close
[0m17:31:11.891903 [info ] [Thread-1 (]: 4 of 5 PASS not_null_dim_products_product_name ................................. [[32mPASS[0m in 0.02s]
[0m17:31:11.892229 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:31:11.892446 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:31:11.892651 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_products_product_id ............................... [RUN]
[0m17:31:11.892997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3, now test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985)
[0m17:31:11.893239 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:31:11.898013 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:31:11.898696 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:31:11.900079 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:31:11.900432 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:31:11.900628 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m17:31:11.900851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:11.907148 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:31:11.907474 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:31:11.907676 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "duckdb"."main"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:31:11.909876 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:31:11.911024 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m17:31:11.911348 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985'
[0m17:31:11.911551 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m17:31:11.912838 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_products_product_id ..................................... [[32mPASS[0m in 0.02s]
[0m17:31:11.913171 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:31:11.913743 [debug] [MainThread]: Using duckdb connection "master"
[0m17:31:11.913939 [debug] [MainThread]: On master: BEGIN
[0m17:31:11.914092 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:31:11.920057 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m17:31:11.920373 [debug] [MainThread]: On master: COMMIT
[0m17:31:11.920550 [debug] [MainThread]: Using duckdb connection "master"
[0m17:31:11.920699 [debug] [MainThread]: On master: COMMIT
[0m17:31:11.920913 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:31:11.921081 [debug] [MainThread]: On master: Close
[0m17:31:11.922158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:11.922333 [debug] [MainThread]: Connection 'test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m17:31:11.922520 [info ] [MainThread]: 
[0m17:31:11.922707 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m17:31:11.923276 [debug] [MainThread]: Command end result
[0m17:31:11.937668 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:31:11.938873 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:31:11.942934 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m17:31:11.943166 [info ] [MainThread]: 
[0m17:31:11.943395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:31:11.943581 [info ] [MainThread]: 
[0m17:31:11.943773 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:31:11.944900 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.88234603, "process_in_blocks": "0", "process_kernel_time": 0.184486, "process_mem_max_rss": "139214848", "process_out_blocks": "0", "process_user_time": 1.324057}
[0m17:31:11.945152 [debug] [MainThread]: Command `dbt test` succeeded at 17:31:11.945106 after 0.88 seconds
[0m17:31:11.945440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103055240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10311bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ea2f0>]}
[0m17:31:11.945719 [debug] [MainThread]: Flushing usage events
[0m17:31:12.709626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:31:15.878274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107735210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853f280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853eb30>]}


============================== 17:31:15.880589 | 42dfab29-97f5-467c-a114-212f0ccf8b01 ==============================
[0m17:31:15.880589 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:31:15.880928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:31:16.000159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42dfab29-97f5-467c-a114-212f0ccf8b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805c7c0>]}
[0m17:31:16.029321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42dfab29-97f5-467c-a114-212f0ccf8b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108668880>]}
[0m17:38:36.388482 [error] [MainThread]: Encountered an error:

[0m17:38:36.399002 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/opt/homebrew/Cellar/python@3.10/3.10.16/Frameworks/Python.framework/Versions/3.10/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.10/3.10.16/Frameworks/Python.framework/Versions/3.10/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m17:38:36.403588 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 440.56662, "process_in_blocks": "0", "process_kernel_time": 0.128198, "process_mem_max_rss": "105725952", "process_out_blocks": "0", "process_user_time": 0.82929}
[0m17:38:36.404655 [debug] [MainThread]: Command `dbt docs serve` failed at 17:38:36.404450 after 440.57 seconds
[0m17:38:36.405829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107735210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108851000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088510f0>]}
[0m17:38:36.406734 [debug] [MainThread]: Flushing usage events
[0m17:38:38.548037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193c5270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab973d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab96c80>]}


============================== 17:38:38.550897 | c690cb81-38aa-4bfb-821c-81ce1121c8a1 ==============================
[0m17:38:38.550897 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:38:38.551242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:38.685899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c690cb81-38aa-4bfb-821c-81ce1121c8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad19780>]}
[0m17:38:38.714658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c690cb81-38aa-4bfb-821c-81ce1121c8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa442e0>]}
[0m17:38:38.717660 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:38:38.771613 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:38:38.854096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:38.854383 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:38.884816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c690cb81-38aa-4bfb-821c-81ce1121c8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b463e80>]}
[0m17:38:38.895706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c690cb81-38aa-4bfb-821c-81ce1121c8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b42a2c0>]}
[0m17:38:38.896021 [info ] [MainThread]: Found 5 models, 4 seeds, 5 data tests, 426 macros
[0m17:38:38.896236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c690cb81-38aa-4bfb-821c-81ce1121c8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b429bd0>]}
[0m17:38:38.897314 [info ] [MainThread]: 
[0m17:38:38.897556 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:38.897733 [info ] [MainThread]: 
[0m17:38:38.898015 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:38:38.900845 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb_main'
[0m17:38:38.933315 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:38:38.933596 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m17:38:38.933761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:38.940854 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:38:38.941124 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:38:38.941315 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m17:38:38.951496 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:38:38.952379 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m17:38:38.953129 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m17:38:38.953339 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m17:38:38.955382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c690cb81-38aa-4bfb-821c-81ce1121c8a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b42bac0>]}
[0m17:38:38.956967 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.customers
[0m17:38:38.957214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now seed.my_star_schema_project.customers)
[0m17:38:38.957410 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.customers
[0m17:38:38.961451 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.customers
[0m17:38:38.961844 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.customers
[0m17:38:38.962053 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.dates
[0m17:38:38.962340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.customers, now seed.my_star_schema_project.dates)
[0m17:38:38.962533 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.dates
[0m17:38:38.963553 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.dates
[0m17:38:38.963964 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.dates
[0m17:38:38.964183 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.products
[0m17:38:38.964463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.dates, now seed.my_star_schema_project.products)
[0m17:38:38.964685 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.products
[0m17:38:38.965748 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.products
[0m17:38:38.966073 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.products
[0m17:38:38.966264 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.sales
[0m17:38:38.966454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.products, now seed.my_star_schema_project.sales)
[0m17:38:38.966632 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.sales
[0m17:38:38.967612 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.sales
[0m17:38:38.967923 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.sales
[0m17:38:38.968111 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_customers
[0m17:38:38.968298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.sales, now model.my_star_schema_project.dim_customers)
[0m17:38:38.968475 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_customers
[0m17:38:38.970049 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_customers"
[0m17:38:38.970619 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_customers
[0m17:38:38.970948 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_customers
[0m17:38:38.971142 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_dates
[0m17:38:38.971335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_customers, now model.my_star_schema_project.dim_dates)
[0m17:38:38.971516 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_dates
[0m17:38:38.972944 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_dates"
[0m17:38:38.973261 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_dates
[0m17:38:38.973578 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_dates
[0m17:38:38.973767 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_products
[0m17:38:38.973980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_dates, now model.my_star_schema_project.dim_products)
[0m17:38:38.974164 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_products
[0m17:38:38.975739 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_products"
[0m17:38:38.976067 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_products
[0m17:38:38.976396 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_products
[0m17:38:38.976591 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.fact_sales
[0m17:38:38.976876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_products, now model.my_star_schema_project.fact_sales)
[0m17:38:38.977060 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.fact_sales
[0m17:38:38.979093 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.fact_sales"
[0m17:38:38.979549 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.fact_sales
[0m17:38:38.979860 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.fact_sales
[0m17:38:38.980052 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:38:38.980350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.fact_sales, now test.my_star_schema_project.not_null_dim_products_price.93519fc0ed)
[0m17:38:38.980560 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:38:38.986561 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:38:38.987000 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:38:38.987378 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:38:38.987606 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:38:38.987895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_price.93519fc0ed, now test.my_star_schema_project.not_null_dim_products_product_category.069796c541)
[0m17:38:38.988100 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:38:38.990667 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:38:38.991234 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:38:38.991603 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:38:38.991808 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:38:38.992053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_category.069796c541, now test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1)
[0m17:38:38.992253 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:38:38.994343 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:38:38.994669 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:38:38.994998 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:38:38.995196 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:38:38.995422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1, now test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3)
[0m17:38:38.995611 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:38:38.997789 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:38:38.998317 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:38:38.998675 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:38:38.998877 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:38:38.999109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3, now test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985)
[0m17:38:38.999299 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:38:39.002565 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:38:39.002878 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:38:39.003215 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:38:39.003417 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.star_schema_view
[0m17:38:39.003635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985, now model.my_star_schema_project.star_schema_view)
[0m17:38:39.003822 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.star_schema_view
[0m17:38:39.005589 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.star_schema_view"
[0m17:38:39.006052 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.star_schema_view
[0m17:38:39.006375 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.star_schema_view
[0m17:38:39.006801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:39.006972 [debug] [MainThread]: Connection 'model.my_star_schema_project.star_schema_view' was properly closed.
[0m17:38:39.008009 [debug] [MainThread]: Command end result
[0m17:38:39.056398 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:38:39.057841 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:38:39.062063 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m17:38:39.065063 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m17:38:39.065315 [info ] [MainThread]: Building catalog
[0m17:38:39.100731 [debug] [ThreadPool]: Acquiring new duckdb connection 'duckdb.information_schema'
[0m17:38:39.104520 [debug] [ThreadPool]: Using duckdb connection "duckdb.information_schema"
[0m17:38:39.104758 [debug] [ThreadPool]: On duckdb.information_schema: BEGIN
[0m17:38:39.104958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:39.110429 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:38:39.110693 [debug] [ThreadPool]: Using duckdb connection "duckdb.information_schema"
[0m17:38:39.110896 [debug] [ThreadPool]: On duckdb.information_schema: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "duckdb.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'duckdb'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'duckdb'
    )
    select
        'duckdb' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m17:38:39.125467 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m17:38:39.141927 [debug] [ThreadPool]: On duckdb.information_schema: ROLLBACK
[0m17:38:39.142316 [debug] [ThreadPool]: Failed to rollback 'duckdb.information_schema'
[0m17:38:39.142484 [debug] [ThreadPool]: On duckdb.information_schema: Close
[0m17:38:39.158082 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/takeshiiijima/github/duckdb-dbt/target/catalog.json
[0m17:38:39.170775 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:38:39.171796 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:38:39.171988 [info ] [MainThread]: Catalog written to /Users/takeshiiijima/github/duckdb-dbt/target/catalog.json
[0m17:38:39.172855 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.6655512, "process_in_blocks": "0", "process_kernel_time": 0.173333, "process_mem_max_rss": "138067968", "process_out_blocks": "0", "process_user_time": 1.202976}
[0m17:38:39.173100 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:38:39.173055 after 0.67 seconds
[0m17:38:39.173280 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:38:39.173426 [debug] [MainThread]: Connection 'duckdb.information_schema' was properly closed.
[0m17:38:39.173597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193c5270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a805de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abb1d80>]}
[0m17:38:39.173802 [debug] [MainThread]: Flushing usage events
[0m17:38:39.942224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:44.461753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac1240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de32b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de2b60>]}


============================== 17:38:44.464559 | b4e67eeb-c913-47d7-bbc7-fb4fed33ef80 ==============================
[0m17:38:44.464559 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:38:44.464921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:38:44.588042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4e67eeb-c913-47d7-bbc7-fb4fed33ef80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f16aa0>]}
[0m17:38:44.617174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4e67eeb-c913-47d7-bbc7-fb4fed33ef80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ec19c0>]}
[0m17:47:39.352441 [error] [MainThread]: Encountered an error:

[0m17:47:39.361450 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/opt/homebrew/Cellar/python@3.10/3.10.16/Frameworks/Python.framework/Versions/3.10/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.10/3.10.16/Frameworks/Python.framework/Versions/3.10/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m17:47:39.367058 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 534.95886, "process_in_blocks": "0", "process_kernel_time": 0.15014, "process_mem_max_rss": "106004480", "process_out_blocks": "0", "process_user_time": 0.851841}
[0m17:47:39.369333 [debug] [MainThread]: Command `dbt docs serve` failed at 17:47:39.368128 after 534.96 seconds
[0m17:47:39.370829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac1240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120a1030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120a1360>]}
[0m17:47:39.371624 [debug] [MainThread]: Flushing usage events
[0m17:47:41.854500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec12d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1eda0>]}


============================== 17:47:41.857322 | 4b840d7a-2247-41a6-87ab-f3334977d281 ==============================
[0m17:47:41.857322 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:47:41.857687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:47:41.991812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b840d7a-2247-41a6-87ab-f3334977d281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e577c0>]}
[0m17:47:42.022203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b840d7a-2247-41a6-87ab-f3334977d281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd74f0>]}
[0m17:47:44.350039 [error] [MainThread]: Encountered an error:

[0m17:47:44.352947 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/opt/homebrew/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/opt/homebrew/Cellar/python@3.10/3.10.16/Frameworks/Python.framework/Versions/3.10/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.10/3.10.16/Frameworks/Python.framework/Versions/3.10/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m17:47:44.356652 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 2.5436523, "process_in_blocks": "0", "process_kernel_time": 0.118309, "process_mem_max_rss": "104120320", "process_out_blocks": "0", "process_user_time": 0.790528}
[0m17:47:44.357910 [debug] [MainThread]: Command `dbt docs serve` failed at 17:47:44.357696 after 2.55 seconds
[0m17:47:44.358898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec12d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fdd0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fdd390>]}
[0m17:47:44.359723 [debug] [MainThread]: Flushing usage events
[0m17:47:50.727793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a19270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae6cb0>]}


============================== 17:47:50.730325 | 1f7593ff-ef2e-462d-8412-90051d63d77d ==============================
[0m17:47:50.730325 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:47:50.730650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:47:50.853828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f7593ff-ef2e-462d-8412-90051d63d77d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c19780>]}
[0m17:47:50.884152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f7593ff-ef2e-462d-8412-90051d63d77d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079442e0>]}
[0m17:47:50.887405 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:47:50.942574 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:47:51.023567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:47:51.024065 [debug] [MainThread]: Partial parsing: updated file: my_star_schema_project://models/schema.yml
[0m17:47:51.315940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f7593ff-ef2e-462d-8412-90051d63d77d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11058c100>]}
[0m17:47:51.374107 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:47:51.375723 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:47:51.428045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f7593ff-ef2e-462d-8412-90051d63d77d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110393a90>]}
[0m17:47:51.428404 [info ] [MainThread]: Found 5 models, 4 seeds, 11 data tests, 426 macros
[0m17:47:51.428616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f7593ff-ef2e-462d-8412-90051d63d77d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110391c60>]}
[0m17:47:51.429712 [info ] [MainThread]: 
[0m17:47:51.429916 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:47:51.430081 [info ] [MainThread]: 
[0m17:47:51.430355 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:47:51.433405 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb_main'
[0m17:47:51.471151 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:47:51.471634 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m17:47:51.472636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:51.488357 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m17:47:51.488965 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:47:51.489553 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m17:47:51.504275 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m17:47:51.505777 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m17:47:51.506857 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m17:47:51.507164 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m17:47:51.512600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f7593ff-ef2e-462d-8412-90051d63d77d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110398c40>]}
[0m17:47:51.513039 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:51.513236 [debug] [MainThread]: On master: BEGIN
[0m17:47:51.513420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:51.520682 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m17:47:51.521098 [debug] [MainThread]: On master: COMMIT
[0m17:47:51.521326 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:51.521511 [debug] [MainThread]: On master: COMMIT
[0m17:47:51.521816 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:47:51.522003 [debug] [MainThread]: On master: Close
[0m17:47:51.532328 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m17:47:51.534014 [info ] [Thread-1 (]: 1 of 11 START test not_null_dim_customers_customer_city ........................ [RUN]
[0m17:47:51.534732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d)
[0m17:47:51.535356 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m17:47:51.555033 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"
[0m17:47:51.555728 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m17:47:51.565065 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"
[0m17:47:51.565791 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"
[0m17:47:51.566032 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d: BEGIN
[0m17:47:51.566235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:51.622740 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m17:47:51.623186 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"
[0m17:47:51.623472 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_city
from "duckdb"."main"."dim_customers"
where customer_city is null



      
    ) dbt_internal_test
[0m17:47:51.626072 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:51.631017 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d: ROLLBACK
[0m17:47:51.631507 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d'
[0m17:47:51.631769 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d: Close
[0m17:47:51.633766 [info ] [Thread-1 (]: 1 of 11 PASS not_null_dim_customers_customer_city .............................. [[32mPASS[0m in 0.10s]
[0m17:47:51.634235 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m17:47:51.634486 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:47:51.634857 [info ] [Thread-1 (]: 2 of 11 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m17:47:51.635298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d, now test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m17:47:51.635862 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:47:51.641129 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:47:51.644965 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:47:51.648387 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:47:51.649579 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:47:51.649885 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m17:47:51.650096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:51.658338 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:47:51.658680 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:47:51.659135 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "duckdb"."main"."dim_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m17:47:51.660352 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:51.665309 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m17:47:51.666195 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m17:47:51.666551 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m17:47:51.668202 [info ] [Thread-1 (]: 2 of 11 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.03s]
[0m17:47:51.668577 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:47:51.668888 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m17:47:51.669803 [info ] [Thread-1 (]: 3 of 11 START test not_null_dim_customers_customer_name ........................ [RUN]
[0m17:47:51.670462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d)
[0m17:47:51.670708 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m17:47:51.676028 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"
[0m17:47:51.678119 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m17:47:51.683987 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"
[0m17:47:51.686085 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"
[0m17:47:51.687377 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d: BEGIN
[0m17:47:51.687787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:51.693608 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:47:51.693920 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"
[0m17:47:51.694134 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_name
from "duckdb"."main"."dim_customers"
where customer_name is null



      
    ) dbt_internal_test
[0m17:47:51.694689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:47:51.695542 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d: ROLLBACK
[0m17:47:51.695804 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d'
[0m17:47:51.695995 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d: Close
[0m17:47:51.697183 [info ] [Thread-1 (]: 3 of 11 PASS not_null_dim_customers_customer_name .............................. [[32mPASS[0m in 0.03s]
[0m17:47:51.697553 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m17:47:51.697786 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m17:47:51.698061 [info ] [Thread-1 (]: 4 of 11 START test not_null_dim_customers_customer_state ....................... [RUN]
[0m17:47:51.698349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d, now test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa)
[0m17:47:51.698566 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m17:47:51.700918 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"
[0m17:47:51.701328 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m17:47:51.702793 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"
[0m17:47:51.703221 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"
[0m17:47:51.703631 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa: BEGIN
[0m17:47:51.703905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:51.710147 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:47:51.710535 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"
[0m17:47:51.710742 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_state
from "duckdb"."main"."dim_customers"
where customer_state is null



      
    ) dbt_internal_test
[0m17:47:51.711324 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:47:51.712160 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa: ROLLBACK
[0m17:47:51.712420 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa'
[0m17:47:51.712613 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa: Close
[0m17:47:51.714339 [info ] [Thread-1 (]: 4 of 11 PASS not_null_dim_customers_customer_state ............................. [[32mPASS[0m in 0.02s]
[0m17:47:51.714842 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m17:47:51.715083 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_metadata.b384715228
[0m17:47:51.715374 [info ] [Thread-1 (]: 5 of 11 START test not_null_dim_products_metadata .............................. [RUN]
[0m17:47:51.715711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa, now test.my_star_schema_project.not_null_dim_products_metadata.b384715228)
[0m17:47:51.715935 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_metadata.b384715228
[0m17:47:51.718654 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_metadata.b384715228"
[0m17:47:51.719147 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_metadata.b384715228
[0m17:47:51.721187 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_metadata.b384715228"
[0m17:47:51.721731 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_metadata.b384715228"
[0m17:47:51.721924 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_metadata.b384715228: BEGIN
[0m17:47:51.722100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:51.727486 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:47:51.727750 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_metadata.b384715228"
[0m17:47:51.727950 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_metadata.b384715228: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_metadata.b384715228"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metadata
from "duckdb"."main"."dim_products"
where metadata is null



      
    ) dbt_internal_test
[0m17:47:51.732194 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_metadata.b384715228"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metadata
from "duckdb"."main"."dim_products"
where metadata is null



      
    ) dbt_internal_test
[0m17:47:51.732557 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:47:51.732877 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_metadata.b384715228: ROLLBACK
[0m17:47:51.736310 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_metadata.b384715228'
[0m17:47:51.736689 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_metadata.b384715228: Close
[0m17:47:51.738380 [debug] [Thread-1 (]: Runtime Error in test not_null_dim_products_metadata (models/schema.yml)
  Binder Error: Referenced column "metadata" not found in FROM clause!
  Candidate bindings: "product_category"
  
  LINE 15: where metadata is null
                 ^
[0m17:47:51.738744 [error] [Thread-1 (]: 5 of 11 ERROR not_null_dim_products_metadata ................................... [[31mERROR[0m in 0.02s]
[0m17:47:51.739071 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_metadata.b384715228
[0m17:47:51.739296 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:47:51.739559 [debug] [Thread-4 (]: Marking all children of 'test.my_star_schema_project.not_null_dim_products_metadata.b384715228' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_dim_products_metadata (models/schema.yml)
  Binder Error: Referenced column "metadata" not found in FROM clause!
  Candidate bindings: "product_category"
  
  LINE 15: where metadata is null
                 ^.
[0m17:47:51.739840 [info ] [Thread-1 (]: 6 of 11 START test not_null_dim_products_price ................................. [RUN]
[0m17:47:51.740679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_metadata.b384715228, now test.my_star_schema_project.not_null_dim_products_price.93519fc0ed)
[0m17:47:51.740923 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:47:51.744375 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:47:51.744833 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:47:51.746121 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:47:51.746563 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:47:51.746806 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_price.93519fc0ed: BEGIN
[0m17:47:51.746977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:51.752519 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:47:51.752931 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:47:51.753204 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from "duckdb"."main"."dim_products"
where price is null



      
    ) dbt_internal_test
[0m17:47:51.756272 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:47:51.757428 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m17:47:51.757801 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_price.93519fc0ed'
[0m17:47:51.758027 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_price.93519fc0ed: Close
[0m17:47:51.759523 [info ] [Thread-1 (]: 6 of 11 PASS not_null_dim_products_price ....................................... [[32mPASS[0m in 0.02s]
[0m17:47:51.759911 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:47:51.760136 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:47:51.760372 [info ] [Thread-1 (]: 7 of 11 START test not_null_dim_products_product_category ...................... [RUN]
[0m17:47:51.760614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_price.93519fc0ed, now test.my_star_schema_project.not_null_dim_products_product_category.069796c541)
[0m17:47:51.760818 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:47:51.763618 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:47:51.764080 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:47:51.765564 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:47:51.766585 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:47:51.766836 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_category.069796c541: BEGIN
[0m17:47:51.767035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:51.773461 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:47:51.774049 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:47:51.774306 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_category.069796c541: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_category
from "duckdb"."main"."dim_products"
where product_category is null



      
    ) dbt_internal_test
[0m17:47:51.775332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:51.776301 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_category.069796c541: ROLLBACK
[0m17:47:51.776582 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_product_category.069796c541'
[0m17:47:51.776782 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_category.069796c541: Close
[0m17:47:51.778175 [info ] [Thread-1 (]: 7 of 11 PASS not_null_dim_products_product_category ............................ [[32mPASS[0m in 0.02s]
[0m17:47:51.778535 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:47:51.778763 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:47:51.779011 [info ] [Thread-1 (]: 8 of 11 START test not_null_dim_products_product_id ............................ [RUN]
[0m17:47:51.779265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_category.069796c541, now test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1)
[0m17:47:51.779473 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:47:51.782351 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:47:51.782913 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:47:51.784922 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:47:51.785453 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:47:51.785664 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m17:47:51.785927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:51.792389 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:47:51.792698 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:47:51.792901 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "duckdb"."main"."dim_products"
where product_id is null



      
    ) dbt_internal_test
[0m17:47:51.793705 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:51.794594 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m17:47:51.794856 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1'
[0m17:47:51.795052 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m17:47:51.796348 [info ] [Thread-1 (]: 8 of 11 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.02s]
[0m17:47:51.796703 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:47:51.796939 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:47:51.797201 [info ] [Thread-1 (]: 9 of 11 START test not_null_dim_products_product_name .......................... [RUN]
[0m17:47:51.797472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1, now test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3)
[0m17:47:51.797681 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:47:51.800628 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:47:51.801280 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:47:51.804554 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:47:51.805135 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:47:51.805347 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3: BEGIN
[0m17:47:51.805529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:51.812135 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:47:51.812481 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:47:51.812703 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_name
from "duckdb"."main"."dim_products"
where product_name is null



      
    ) dbt_internal_test
[0m17:47:51.813702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:51.814866 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3: ROLLBACK
[0m17:47:51.815176 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3'
[0m17:47:51.815371 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3: Close
[0m17:47:51.816792 [info ] [Thread-1 (]: 9 of 11 PASS not_null_dim_products_product_name ................................ [[32mPASS[0m in 0.02s]
[0m17:47:51.817115 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:47:51.817332 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:47:51.817599 [info ] [Thread-1 (]: 10 of 11 START test unique_dim_customers_customer_id ........................... [RUN]
[0m17:47:51.817883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3, now test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m17:47:51.818095 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:47:51.822162 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:47:51.822691 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:47:51.824440 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:47:51.824887 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:47:51.825087 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m17:47:51.825260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:51.830611 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:47:51.830880 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:47:51.831085 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "duckdb"."main"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:47:51.833422 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:47:51.834399 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m17:47:51.834659 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m17:47:51.834849 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m17:47:51.836211 [info ] [Thread-1 (]: 10 of 11 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.02s]
[0m17:47:51.836669 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:47:51.836905 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:47:51.837151 [info ] [Thread-1 (]: 11 of 11 START test unique_dim_products_product_id ............................. [RUN]
[0m17:47:51.837426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985)
[0m17:47:51.837630 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:47:51.840571 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:47:51.841106 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:47:51.842589 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:47:51.843115 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:47:51.843328 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m17:47:51.843502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:51.848873 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:47:51.849212 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:47:51.849435 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "duckdb"."main"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:47:51.850498 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:47:51.851421 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m17:47:51.851694 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985'
[0m17:47:51.851880 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m17:47:51.853317 [info ] [Thread-1 (]: 11 of 11 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.02s]
[0m17:47:51.853692 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:47:51.854334 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:51.854536 [debug] [MainThread]: On master: BEGIN
[0m17:47:51.854698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:51.860585 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m17:47:51.860884 [debug] [MainThread]: On master: COMMIT
[0m17:47:51.861057 [debug] [MainThread]: Using duckdb connection "master"
[0m17:47:51.861209 [debug] [MainThread]: On master: COMMIT
[0m17:47:51.861423 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:47:51.861592 [debug] [MainThread]: On master: Close
[0m17:47:51.862644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:51.862832 [debug] [MainThread]: Connection 'test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m17:47:51.863029 [info ] [MainThread]: 
[0m17:47:51.863213 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m17:47:51.864158 [debug] [MainThread]: Command end result
[0m17:47:51.878959 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:47:51.880196 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:47:51.884354 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m17:47:51.884590 [info ] [MainThread]: 
[0m17:47:51.884815 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:47:51.884999 [info ] [MainThread]: 
[0m17:47:51.885213 [error] [MainThread]:   Runtime Error in test not_null_dim_products_metadata (models/schema.yml)
  Binder Error: Referenced column "metadata" not found in FROM clause!
  Candidate bindings: "product_category"
  
  LINE 15: where metadata is null
                 ^
[0m17:47:51.885394 [info ] [MainThread]: 
[0m17:47:51.885574 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m17:47:51.887097 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.1979688, "process_in_blocks": "0", "process_kernel_time": 0.183349, "process_mem_max_rss": "139673600", "process_out_blocks": "0", "process_user_time": 1.527925}
[0m17:47:51.887421 [debug] [MainThread]: Command `dbt test` failed at 17:47:51.887368 after 1.20 seconds
[0m17:47:51.887665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9ac80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105c6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105c7e80>]}
[0m17:47:51.887902 [debug] [MainThread]: Flushing usage events
[0m17:47:52.648913 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:48:59.467349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12041d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121de73a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121de6c50>]}


============================== 17:48:59.470292 | 87bc8731-17a5-4a24-8f1f-f2f41357ce84 ==============================
[0m17:48:59.470292 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:48:59.470690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m17:48:59.625358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87bc8731-17a5-4a24-8f1f-f2f41357ce84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12201bee0>]}
[0m17:48:59.654634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87bc8731-17a5-4a24-8f1f-f2f41357ce84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121d2f430>]}
[0m17:48:59.657504 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:48:59.757049 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:48:59.839725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:48:59.839995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:48:59.870930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87bc8731-17a5-4a24-8f1f-f2f41357ce84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12246c130>]}
[0m17:48:59.920823 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:48:59.922332 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:48:59.940386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87bc8731-17a5-4a24-8f1f-f2f41357ce84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12243f430>]}
[0m17:48:59.940740 [info ] [MainThread]: Found 5 models, 4 seeds, 11 data tests, 426 macros
[0m17:48:59.940945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87bc8731-17a5-4a24-8f1f-f2f41357ce84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12224c550>]}
[0m17:48:59.942062 [info ] [MainThread]: 
[0m17:48:59.942283 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:48:59.942448 [info ] [MainThread]: 
[0m17:48:59.942732 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:48:59.946070 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb_main'
[0m17:48:59.976771 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:48:59.977048 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m17:48:59.977217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:00.018856 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m17:49:00.019151 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:49:00.019333 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m17:49:00.034285 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m17:49:00.035408 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m17:49:00.035961 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m17:49:00.036135 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m17:49:00.038775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87bc8731-17a5-4a24-8f1f-f2f41357ce84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12243ec80>]}
[0m17:49:00.039111 [debug] [MainThread]: Using duckdb connection "master"
[0m17:49:00.039283 [debug] [MainThread]: On master: BEGIN
[0m17:49:00.039435 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:00.044667 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m17:49:00.044882 [debug] [MainThread]: On master: COMMIT
[0m17:49:00.045052 [debug] [MainThread]: Using duckdb connection "master"
[0m17:49:00.045204 [debug] [MainThread]: On master: COMMIT
[0m17:49:00.045413 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:49:00.045579 [debug] [MainThread]: On master: Close
[0m17:49:00.047390 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m17:49:00.047632 [info ] [Thread-1 (]: 1 of 11 START test not_null_dim_customers_customer_city ........................ [RUN]
[0m17:49:00.047884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d)
[0m17:49:00.048088 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m17:49:00.058685 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"
[0m17:49:00.059258 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m17:49:00.067372 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"
[0m17:49:00.067831 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"
[0m17:49:00.068037 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d: BEGIN
[0m17:49:00.068214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:00.074041 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:49:00.074362 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"
[0m17:49:00.074572 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_city
from "duckdb"."main"."dim_customers"
where customer_city is null



      
    ) dbt_internal_test
[0m17:49:00.075594 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:49:00.078048 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d: ROLLBACK
[0m17:49:00.078351 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d'
[0m17:49:00.078557 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d: Close
[0m17:49:00.080194 [info ] [Thread-1 (]: 1 of 11 PASS not_null_dim_customers_customer_city .............................. [[32mPASS[0m in 0.03s]
[0m17:49:00.080586 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m17:49:00.080817 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:49:00.081073 [info ] [Thread-1 (]: 2 of 11 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m17:49:00.081330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d, now test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m17:49:00.081531 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:49:00.083887 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:49:00.084306 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:49:00.085553 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:49:00.085886 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:49:00.086073 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m17:49:00.086711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:00.093104 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:49:00.093420 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:49:00.093628 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "duckdb"."main"."dim_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m17:49:00.094190 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:49:00.095004 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m17:49:00.095245 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m17:49:00.095425 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m17:49:00.096590 [info ] [Thread-1 (]: 2 of 11 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.02s]
[0m17:49:00.096939 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:49:00.097158 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m17:49:00.097358 [info ] [Thread-1 (]: 3 of 11 START test not_null_dim_customers_customer_name ........................ [RUN]
[0m17:49:00.097629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d)
[0m17:49:00.097823 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m17:49:00.100242 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"
[0m17:49:00.100680 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m17:49:00.101984 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"
[0m17:49:00.102305 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"
[0m17:49:00.102491 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d: BEGIN
[0m17:49:00.102780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:00.109487 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:49:00.109797 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"
[0m17:49:00.110004 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_name
from "duckdb"."main"."dim_customers"
where customer_name is null



      
    ) dbt_internal_test
[0m17:49:00.110571 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:49:00.111413 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d: ROLLBACK
[0m17:49:00.111667 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d'
[0m17:49:00.111853 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d: Close
[0m17:49:00.113005 [info ] [Thread-1 (]: 3 of 11 PASS not_null_dim_customers_customer_name .............................. [[32mPASS[0m in 0.02s]
[0m17:49:00.113322 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m17:49:00.113557 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m17:49:00.113764 [info ] [Thread-1 (]: 4 of 11 START test not_null_dim_customers_customer_state ....................... [RUN]
[0m17:49:00.114043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d, now test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa)
[0m17:49:00.114252 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m17:49:00.116494 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"
[0m17:49:00.116884 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m17:49:00.118172 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"
[0m17:49:00.118500 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"
[0m17:49:00.118686 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa: BEGIN
[0m17:49:00.118858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:00.124919 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:49:00.125213 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"
[0m17:49:00.125419 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_state
from "duckdb"."main"."dim_customers"
where customer_state is null



      
    ) dbt_internal_test
[0m17:49:00.125953 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:49:00.126758 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa: ROLLBACK
[0m17:49:00.127021 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa'
[0m17:49:00.127219 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa: Close
[0m17:49:00.128399 [info ] [Thread-1 (]: 4 of 11 PASS not_null_dim_customers_customer_state ............................. [[32mPASS[0m in 0.01s]
[0m17:49:00.128782 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m17:49:00.129015 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_metadata.b384715228
[0m17:49:00.129237 [info ] [Thread-1 (]: 5 of 11 START test not_null_dim_products_metadata .............................. [RUN]
[0m17:49:00.129525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa, now test.my_star_schema_project.not_null_dim_products_metadata.b384715228)
[0m17:49:00.129818 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_metadata.b384715228
[0m17:49:00.132934 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_metadata.b384715228"
[0m17:49:00.133371 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_metadata.b384715228
[0m17:49:00.164160 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_metadata.b384715228"
[0m17:49:00.164687 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_metadata.b384715228"
[0m17:49:00.164932 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_metadata.b384715228: BEGIN
[0m17:49:00.165110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:00.170435 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:49:00.170707 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_metadata.b384715228"
[0m17:49:00.170918 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_metadata.b384715228: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_metadata.b384715228"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metadata
from "duckdb"."main"."dim_products"
where metadata is null



      
    ) dbt_internal_test
[0m17:49:00.174385 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_metadata.b384715228"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select metadata
from "duckdb"."main"."dim_products"
where metadata is null



      
    ) dbt_internal_test
[0m17:49:00.174642 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:49:00.174924 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_metadata.b384715228: ROLLBACK
[0m17:49:00.178017 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_metadata.b384715228'
[0m17:49:00.178215 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_metadata.b384715228: Close
[0m17:49:00.179590 [debug] [Thread-1 (]: Runtime Error in test not_null_dim_products_metadata (models/schema.yml)
  Binder Error: Referenced column "metadata" not found in FROM clause!
  Candidate bindings: "product_category"
  
  LINE 15: where metadata is null
                 ^
[0m17:49:00.179872 [error] [Thread-1 (]: 5 of 11 ERROR not_null_dim_products_metadata ................................... [[31mERROR[0m in 0.05s]
[0m17:49:00.180200 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_metadata.b384715228
[0m17:49:00.180445 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:49:00.180688 [debug] [Thread-4 (]: Marking all children of 'test.my_star_schema_project.not_null_dim_products_metadata.b384715228' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_dim_products_metadata (models/schema.yml)
  Binder Error: Referenced column "metadata" not found in FROM clause!
  Candidate bindings: "product_category"
  
  LINE 15: where metadata is null
                 ^.
[0m17:49:00.180897 [info ] [Thread-1 (]: 6 of 11 START test not_null_dim_products_price ................................. [RUN]
[0m17:49:00.181461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_metadata.b384715228, now test.my_star_schema_project.not_null_dim_products_price.93519fc0ed)
[0m17:49:00.181659 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:49:00.184049 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:49:00.184571 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:49:00.185816 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:49:00.186632 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:49:00.186882 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_price.93519fc0ed: BEGIN
[0m17:49:00.187076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:00.192400 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:49:00.192654 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:49:00.192862 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from "duckdb"."main"."dim_products"
where price is null



      
    ) dbt_internal_test
[0m17:49:00.195547 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:49:00.196413 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m17:49:00.196667 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_price.93519fc0ed'
[0m17:49:00.196854 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_price.93519fc0ed: Close
[0m17:49:00.197970 [info ] [Thread-1 (]: 6 of 11 PASS not_null_dim_products_price ....................................... [[32mPASS[0m in 0.02s]
[0m17:49:00.198304 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:49:00.198528 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:49:00.198765 [info ] [Thread-1 (]: 7 of 11 START test not_null_dim_products_product_category ...................... [RUN]
[0m17:49:00.198998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_price.93519fc0ed, now test.my_star_schema_project.not_null_dim_products_product_category.069796c541)
[0m17:49:00.199208 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:49:00.201554 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:49:00.201945 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:49:00.203313 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:49:00.203849 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:49:00.204065 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_category.069796c541: BEGIN
[0m17:49:00.204252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:00.210781 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:49:00.211096 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:49:00.211300 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_category.069796c541: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_category
from "duckdb"."main"."dim_products"
where product_category is null



      
    ) dbt_internal_test
[0m17:49:00.212137 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:49:00.213011 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_category.069796c541: ROLLBACK
[0m17:49:00.213268 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_product_category.069796c541'
[0m17:49:00.213458 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_category.069796c541: Close
[0m17:49:00.214853 [info ] [Thread-1 (]: 7 of 11 PASS not_null_dim_products_product_category ............................ [[32mPASS[0m in 0.02s]
[0m17:49:00.215198 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:49:00.215422 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:49:00.215669 [info ] [Thread-1 (]: 8 of 11 START test not_null_dim_products_product_id ............................ [RUN]
[0m17:49:00.215925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_category.069796c541, now test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1)
[0m17:49:00.216130 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:49:00.218397 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:49:00.218776 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:49:00.220302 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:49:00.220921 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:49:00.221137 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m17:49:00.221319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:00.227479 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:49:00.227804 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:49:00.228012 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "duckdb"."main"."dim_products"
where product_id is null



      
    ) dbt_internal_test
[0m17:49:00.228803 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:49:00.229700 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m17:49:00.229955 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1'
[0m17:49:00.230133 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m17:49:00.231289 [info ] [Thread-1 (]: 8 of 11 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.02s]
[0m17:49:00.231611 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:49:00.231843 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:49:00.232052 [info ] [Thread-1 (]: 9 of 11 START test not_null_dim_products_product_name .......................... [RUN]
[0m17:49:00.232412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1, now test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3)
[0m17:49:00.232648 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:49:00.237063 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:49:00.238100 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:49:00.239763 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:49:00.240561 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:49:00.241022 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3: BEGIN
[0m17:49:00.241268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:00.247173 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:49:00.247545 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:49:00.247854 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_name
from "duckdb"."main"."dim_products"
where product_name is null



      
    ) dbt_internal_test
[0m17:49:00.248764 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:49:00.249617 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3: ROLLBACK
[0m17:49:00.249868 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3'
[0m17:49:00.250048 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3: Close
[0m17:49:00.251288 [info ] [Thread-1 (]: 9 of 11 PASS not_null_dim_products_product_name ................................ [[32mPASS[0m in 0.02s]
[0m17:49:00.251606 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:49:00.251814 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:49:00.252006 [info ] [Thread-1 (]: 10 of 11 START test unique_dim_customers_customer_id ........................... [RUN]
[0m17:49:00.252313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3, now test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m17:49:00.252527 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:49:00.257072 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:49:00.258040 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:49:00.259721 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:49:00.260115 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:49:00.260309 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m17:49:00.260486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:00.266405 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:49:00.266742 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:49:00.266968 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "duckdb"."main"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:49:00.269588 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:49:00.271408 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m17:49:00.271782 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m17:49:00.271997 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m17:49:00.273478 [info ] [Thread-1 (]: 10 of 11 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.02s]
[0m17:49:00.274030 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:49:00.274288 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:49:00.274568 [info ] [Thread-1 (]: 11 of 11 START test unique_dim_products_product_id ............................. [RUN]
[0m17:49:00.274884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985)
[0m17:49:00.275155 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:49:00.277618 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:49:00.278059 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:49:00.279768 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:49:00.280711 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:49:00.280970 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m17:49:00.281166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:00.286652 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:49:00.287081 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:49:00.287345 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "duckdb"."main"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:49:00.288393 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:49:00.289327 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m17:49:00.289611 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985'
[0m17:49:00.289865 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m17:49:00.291264 [info ] [Thread-1 (]: 11 of 11 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.02s]
[0m17:49:00.291624 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:49:00.292228 [debug] [MainThread]: Using duckdb connection "master"
[0m17:49:00.292414 [debug] [MainThread]: On master: BEGIN
[0m17:49:00.292567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:49:00.298380 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m17:49:00.298631 [debug] [MainThread]: On master: COMMIT
[0m17:49:00.298792 [debug] [MainThread]: Using duckdb connection "master"
[0m17:49:00.298942 [debug] [MainThread]: On master: COMMIT
[0m17:49:00.299149 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:49:00.299309 [debug] [MainThread]: On master: Close
[0m17:49:00.300345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:00.300524 [debug] [MainThread]: Connection 'test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m17:49:00.300716 [info ] [MainThread]: 
[0m17:49:00.300896 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m17:49:00.301824 [debug] [MainThread]: Command end result
[0m17:49:00.318443 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:49:00.319492 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:49:00.324898 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m17:49:00.325166 [info ] [MainThread]: 
[0m17:49:00.325377 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:49:00.325570 [info ] [MainThread]: 
[0m17:49:00.325773 [error] [MainThread]:   Runtime Error in test not_null_dim_products_metadata (models/schema.yml)
  Binder Error: Referenced column "metadata" not found in FROM clause!
  Candidate bindings: "product_category"
  
  LINE 15: where metadata is null
                 ^
[0m17:49:00.325951 [info ] [MainThread]: 
[0m17:49:00.326127 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m17:49:00.327288 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.9009107, "process_in_blocks": "0", "process_kernel_time": 0.206422, "process_mem_max_rss": "142180352", "process_out_blocks": "0", "process_user_time": 1.307022}
[0m17:49:00.327565 [debug] [MainThread]: Command `dbt test` failed at 17:49:00.327518 after 0.90 seconds
[0m17:49:00.327813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12041d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122497be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122494130>]}
[0m17:49:00.328050 [debug] [MainThread]: Flushing usage events
[0m17:49:01.310115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:49:16.842374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c19240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e73a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e6c50>]}


============================== 17:49:16.845173 | 00848dc9-ad72-4c66-b5f1-55c3d167bfb5 ==============================
[0m17:49:16.845173 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:49:16.845540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m17:49:16.987534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00848dc9-ad72-4c66-b5f1-55c3d167bfb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107719180>]}
[0m17:49:17.016447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00848dc9-ad72-4c66-b5f1-55c3d167bfb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107585600>]}
[0m17:49:17.019206 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:49:17.072651 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:49:17.151734 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:49:17.152917 [debug] [MainThread]: Partial parsing: updated file: my_star_schema_project://models/schema.yml
[0m17:49:17.364510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00848dc9-ad72-4c66-b5f1-55c3d167bfb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110088130>]}
[0m17:49:17.412597 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:49:17.413829 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:49:17.460644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00848dc9-ad72-4c66-b5f1-55c3d167bfb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ead090>]}
[0m17:49:17.460998 [info ] [MainThread]: Found 5 models, 4 seeds, 10 data tests, 426 macros
[0m17:49:17.461206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00848dc9-ad72-4c66-b5f1-55c3d167bfb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eaf460>]}
[0m17:49:17.462253 [info ] [MainThread]: 
[0m17:49:17.462450 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:49:17.462613 [info ] [MainThread]: 
[0m17:49:17.462892 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:49:17.465785 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb_main'
[0m17:49:17.496755 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:49:17.497019 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m17:49:17.497181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:17.560543 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m17:49:17.560869 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m17:49:17.561055 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m17:49:17.584761 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:49:17.585920 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m17:49:17.586490 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m17:49:17.586746 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m17:49:17.589322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00848dc9-ad72-4c66-b5f1-55c3d167bfb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eacee0>]}
[0m17:49:17.589648 [debug] [MainThread]: Using duckdb connection "master"
[0m17:49:17.589815 [debug] [MainThread]: On master: BEGIN
[0m17:49:17.589966 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:17.595178 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m17:49:17.595393 [debug] [MainThread]: On master: COMMIT
[0m17:49:17.595564 [debug] [MainThread]: Using duckdb connection "master"
[0m17:49:17.595716 [debug] [MainThread]: On master: COMMIT
[0m17:49:17.595924 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:49:17.596094 [debug] [MainThread]: On master: Close
[0m17:49:17.597776 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m17:49:17.598011 [info ] [Thread-1 (]: 1 of 10 START test not_null_dim_customers_customer_city ........................ [RUN]
[0m17:49:17.598265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d)
[0m17:49:17.598478 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m17:49:17.608572 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"
[0m17:49:17.609263 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m17:49:17.617299 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"
[0m17:49:17.617830 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"
[0m17:49:17.618045 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d: BEGIN
[0m17:49:17.618232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:17.624604 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:49:17.624921 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"
[0m17:49:17.625135 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_city
from "duckdb"."main"."dim_customers"
where customer_city is null



      
    ) dbt_internal_test
[0m17:49:17.627089 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:49:17.629755 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d: ROLLBACK
[0m17:49:17.630114 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d'
[0m17:49:17.630322 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d: Close
[0m17:49:17.631597 [info ] [Thread-1 (]: 1 of 10 PASS not_null_dim_customers_customer_city .............................. [[32mPASS[0m in 0.03s]
[0m17:49:17.631948 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m17:49:17.632176 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:49:17.632415 [info ] [Thread-1 (]: 2 of 10 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m17:49:17.632652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d, now test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m17:49:17.632854 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:49:17.635228 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:49:17.635619 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:49:17.637926 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:49:17.638435 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:49:17.638654 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m17:49:17.638843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:17.644591 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:49:17.644908 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:49:17.645119 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "duckdb"."main"."dim_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m17:49:17.645652 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:49:17.646487 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m17:49:17.646736 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m17:49:17.646917 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m17:49:17.648360 [info ] [Thread-1 (]: 2 of 10 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.02s]
[0m17:49:17.648709 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:49:17.648941 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m17:49:17.649200 [info ] [Thread-1 (]: 3 of 10 START test not_null_dim_customers_customer_name ........................ [RUN]
[0m17:49:17.649464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d)
[0m17:49:17.649672 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m17:49:17.652068 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"
[0m17:49:17.652464 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m17:49:17.654079 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"
[0m17:49:17.654565 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"
[0m17:49:17.654775 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d: BEGIN
[0m17:49:17.654950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:17.660449 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:49:17.660711 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"
[0m17:49:17.660913 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_name
from "duckdb"."main"."dim_customers"
where customer_name is null



      
    ) dbt_internal_test
[0m17:49:17.661487 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:49:17.662308 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d: ROLLBACK
[0m17:49:17.662555 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d'
[0m17:49:17.662736 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d: Close
[0m17:49:17.663892 [info ] [Thread-1 (]: 3 of 10 PASS not_null_dim_customers_customer_name .............................. [[32mPASS[0m in 0.01s]
[0m17:49:17.664225 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m17:49:17.664446 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m17:49:17.664691 [info ] [Thread-1 (]: 4 of 10 START test not_null_dim_customers_customer_state ....................... [RUN]
[0m17:49:17.664946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d, now test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa)
[0m17:49:17.665159 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m17:49:17.667923 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"
[0m17:49:17.668530 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m17:49:17.670355 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"
[0m17:49:17.670964 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"
[0m17:49:17.671244 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa: BEGIN
[0m17:49:17.671471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:17.677226 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:49:17.677526 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"
[0m17:49:17.677728 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_state
from "duckdb"."main"."dim_customers"
where customer_state is null



      
    ) dbt_internal_test
[0m17:49:17.678279 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:49:17.679151 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa: ROLLBACK
[0m17:49:17.679407 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa'
[0m17:49:17.679595 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa: Close
[0m17:49:17.680943 [info ] [Thread-1 (]: 4 of 10 PASS not_null_dim_customers_customer_state ............................. [[32mPASS[0m in 0.02s]
[0m17:49:17.681296 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m17:49:17.681525 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:49:17.681779 [info ] [Thread-1 (]: 5 of 10 START test not_null_dim_products_price ................................. [RUN]
[0m17:49:17.682047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa, now test.my_star_schema_project.not_null_dim_products_price.93519fc0ed)
[0m17:49:17.682254 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:49:17.684830 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:49:17.685256 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:49:17.686526 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:49:17.687072 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:49:17.687672 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_price.93519fc0ed: BEGIN
[0m17:49:17.687864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:17.693702 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:49:17.694022 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m17:49:17.694236 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from "duckdb"."main"."dim_products"
where price is null



      
    ) dbt_internal_test
[0m17:49:17.698011 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:49:17.698958 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m17:49:17.699210 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_price.93519fc0ed'
[0m17:49:17.699396 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_price.93519fc0ed: Close
[0m17:49:17.700641 [info ] [Thread-1 (]: 5 of 10 PASS not_null_dim_products_price ....................................... [[32mPASS[0m in 0.02s]
[0m17:49:17.700984 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m17:49:17.701211 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:49:17.701443 [info ] [Thread-1 (]: 6 of 10 START test not_null_dim_products_product_category ...................... [RUN]
[0m17:49:17.701685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_price.93519fc0ed, now test.my_star_schema_project.not_null_dim_products_product_category.069796c541)
[0m17:49:17.701889 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:49:17.705519 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:49:17.706062 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:49:17.708522 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:49:17.709127 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:49:17.709343 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_category.069796c541: BEGIN
[0m17:49:17.709541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:17.715496 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:49:17.715849 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m17:49:17.716067 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_category.069796c541: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_category
from "duckdb"."main"."dim_products"
where product_category is null



      
    ) dbt_internal_test
[0m17:49:17.717175 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:49:17.718147 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_category.069796c541: ROLLBACK
[0m17:49:17.718417 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_product_category.069796c541'
[0m17:49:17.718624 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_category.069796c541: Close
[0m17:49:17.719963 [info ] [Thread-1 (]: 6 of 10 PASS not_null_dim_products_product_category ............................ [[32mPASS[0m in 0.02s]
[0m17:49:17.720550 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m17:49:17.720836 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:49:17.721093 [info ] [Thread-1 (]: 7 of 10 START test not_null_dim_products_product_id ............................ [RUN]
[0m17:49:17.721415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_category.069796c541, now test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1)
[0m17:49:17.721651 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:49:17.724449 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:49:17.724917 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:49:17.726329 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:49:17.726973 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:49:17.727187 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m17:49:17.727370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:17.733368 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:49:17.733782 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m17:49:17.733989 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "duckdb"."main"."dim_products"
where product_id is null



      
    ) dbt_internal_test
[0m17:49:17.734861 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:49:17.735731 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m17:49:17.735991 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1'
[0m17:49:17.736174 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m17:49:17.737675 [info ] [Thread-1 (]: 7 of 10 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.02s]
[0m17:49:17.738066 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m17:49:17.738298 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:49:17.738569 [info ] [Thread-1 (]: 8 of 10 START test not_null_dim_products_product_name .......................... [RUN]
[0m17:49:17.738858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1, now test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3)
[0m17:49:17.739073 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:49:17.741769 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:49:17.742225 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:49:17.743501 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:49:17.743857 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:49:17.744345 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3: BEGIN
[0m17:49:17.744558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:17.750390 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:49:17.750694 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m17:49:17.750911 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_name
from "duckdb"."main"."dim_products"
where product_name is null



      
    ) dbt_internal_test
[0m17:49:17.751671 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:49:17.752542 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3: ROLLBACK
[0m17:49:17.752799 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3'
[0m17:49:17.752986 [debug] [Thread-1 (]: On test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3: Close
[0m17:49:17.754659 [info ] [Thread-1 (]: 8 of 10 PASS not_null_dim_products_product_name ................................ [[32mPASS[0m in 0.02s]
[0m17:49:17.755077 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m17:49:17.755316 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:49:17.755536 [info ] [Thread-1 (]: 9 of 10 START test unique_dim_customers_customer_id ............................ [RUN]
[0m17:49:17.755865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3, now test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m17:49:17.756085 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:49:17.760290 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:49:17.760756 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:49:17.763749 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:49:17.764336 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:49:17.764559 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m17:49:17.764752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:17.770562 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:49:17.770944 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:49:17.771188 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "duckdb"."main"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:49:17.774737 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:49:17.775788 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m17:49:17.776054 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m17:49:17.776251 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m17:49:17.777497 [info ] [Thread-1 (]: 9 of 10 PASS unique_dim_customers_customer_id .................................. [[32mPASS[0m in 0.02s]
[0m17:49:17.777869 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:49:17.778101 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:49:17.778351 [info ] [Thread-1 (]: 10 of 10 START test unique_dim_products_product_id ............................. [RUN]
[0m17:49:17.778602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985)
[0m17:49:17.778809 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:49:17.781609 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:49:17.782084 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:49:17.783531 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:49:17.784132 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:49:17.784366 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m17:49:17.784561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:17.790780 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:49:17.791075 [debug] [Thread-1 (]: Using duckdb connection "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m17:49:17.791285 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "duckdb"."main"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:49:17.792263 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:49:17.793186 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m17:49:17.793447 [debug] [Thread-1 (]: Failed to rollback 'test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985'
[0m17:49:17.793639 [debug] [Thread-1 (]: On test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m17:49:17.794934 [info ] [Thread-1 (]: 10 of 10 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.02s]
[0m17:49:17.795295 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m17:49:17.795954 [debug] [MainThread]: Using duckdb connection "master"
[0m17:49:17.796141 [debug] [MainThread]: On master: BEGIN
[0m17:49:17.796302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:49:17.801938 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m17:49:17.802236 [debug] [MainThread]: On master: COMMIT
[0m17:49:17.802419 [debug] [MainThread]: Using duckdb connection "master"
[0m17:49:17.802580 [debug] [MainThread]: On master: COMMIT
[0m17:49:17.802808 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:49:17.802987 [debug] [MainThread]: On master: Close
[0m17:49:17.804592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:17.804869 [debug] [MainThread]: Connection 'test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m17:49:17.805119 [info ] [MainThread]: 
[0m17:49:17.805319 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m17:49:17.806340 [debug] [MainThread]: Command end result
[0m17:49:17.826088 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m17:49:17.827193 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m17:49:17.831810 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m17:49:17.832071 [info ] [MainThread]: 
[0m17:49:17.832304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:49:17.832491 [info ] [MainThread]: 
[0m17:49:17.832684 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m17:49:17.833765 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.0294954, "process_in_blocks": "0", "process_kernel_time": 0.189569, "process_mem_max_rss": "143048704", "process_out_blocks": "0", "process_user_time": 1.458474}
[0m17:49:17.834037 [debug] [MainThread]: Command `dbt test` succeeded at 17:49:17.833988 after 1.03 seconds
[0m17:49:17.834264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c19240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdd540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed5a50>]}
[0m17:49:17.834496 [debug] [MainThread]: Flushing usage events
[0m17:49:18.628227 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:44.228587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bd2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061cfee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ced40>]}


============================== 18:05:44.231908 | 01037234-5481-41f2-809d-f0360ecd3568 ==============================
[0m18:05:44.231908 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:05:44.232269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile --select analysis:my_analysis', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:05:44.385904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01037234-5481-41f2-809d-f0360ecd3568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10446b640>]}
[0m18:05:44.415324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01037234-5481-41f2-809d-f0360ecd3568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ed4b0>]}
[0m18:05:44.418189 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m18:05:44.474210 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:05:44.558913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:05:44.559382 [debug] [MainThread]: Partial parsing: updated file: my_star_schema_project://models/schema.yml
[0m18:05:44.616548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01037234-5481-41f2-809d-f0360ecd3568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106787e80>]}
[0m18:05:44.666044 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m18:05:44.667517 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m18:05:44.678627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01037234-5481-41f2-809d-f0360ecd3568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ea680>]}
[0m18:05:44.678964 [info ] [MainThread]: Found 5 models, 4 seeds, 10 data tests, 426 macros
[0m18:05:44.679174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01037234-5481-41f2-809d-f0360ecd3568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fc100>]}
[0m18:05:44.679498 [error] [MainThread]: Encountered an error:
Runtime Error
  'analysis' is not a valid method name
[0m18:05:44.680680 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.49662536, "process_in_blocks": "0", "process_kernel_time": 0.163144, "process_mem_max_rss": "112427008", "process_out_blocks": "0", "process_user_time": 1.018084}
[0m18:05:44.680911 [debug] [MainThread]: Command `dbt compile` failed at 18:05:44.680866 after 0.50 seconds
[0m18:05:44.681112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bd2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ebfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e84f0>]}
[0m18:05:44.681297 [debug] [MainThread]: Flushing usage events
[0m18:05:45.619563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:15.357597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c5240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679aad0>]}


============================== 18:06:15.360620 | 1f4fa206-a5e7-4e01-ba2d-863d813fef1f ==============================
[0m18:06:15.360620 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:06:15.360970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:06:15.514274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f4fa206-a5e7-4e01-ba2d-863d813fef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615e320>]}
[0m18:06:15.548655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f4fa206-a5e7-4e01-ba2d-863d813fef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f14e0>]}
[0m18:06:15.552970 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m18:06:15.608520 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:06:15.690289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:15.690560 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:15.721456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f4fa206-a5e7-4e01-ba2d-863d813fef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b50730>]}
[0m18:06:15.771725 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m18:06:15.772933 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m18:06:15.782095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f4fa206-a5e7-4e01-ba2d-863d813fef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e946a0>]}
[0m18:06:15.782417 [info ] [MainThread]: Found 5 models, 4 seeds, 10 data tests, 426 macros
[0m18:06:15.782618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f4fa206-a5e7-4e01-ba2d-863d813fef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c252a0>]}
[0m18:06:15.783779 [info ] [MainThread]: 
[0m18:06:15.783993 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:15.784159 [info ] [MainThread]: 
[0m18:06:15.784505 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:06:15.787841 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb_main'
[0m18:06:15.819965 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m18:06:15.820460 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m18:06:15.820653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:15.876376 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m18:06:15.876699 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m18:06:15.876905 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m18:06:15.900045 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m18:06:15.901362 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m18:06:15.901994 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m18:06:15.902164 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m18:06:15.904615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f4fa206-a5e7-4e01-ba2d-863d813fef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e94cd0>]}
[0m18:06:15.906345 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.customers
[0m18:06:15.906617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now seed.my_star_schema_project.customers)
[0m18:06:15.906826 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.customers
[0m18:06:15.910760 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.customers
[0m18:06:15.911120 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.customers
[0m18:06:15.911322 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.dates
[0m18:06:15.911586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.customers, now seed.my_star_schema_project.dates)
[0m18:06:15.911771 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.dates
[0m18:06:15.912758 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.dates
[0m18:06:15.913063 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.dates
[0m18:06:15.913247 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.products
[0m18:06:15.913482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.dates, now seed.my_star_schema_project.products)
[0m18:06:15.913663 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.products
[0m18:06:15.914649 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.products
[0m18:06:15.914963 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.products
[0m18:06:15.915146 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.sales
[0m18:06:15.915368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.products, now seed.my_star_schema_project.sales)
[0m18:06:15.915543 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.sales
[0m18:06:15.916531 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.sales
[0m18:06:15.916827 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.sales
[0m18:06:15.917016 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_customers
[0m18:06:15.917267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.sales, now model.my_star_schema_project.dim_customers)
[0m18:06:15.917455 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_customers
[0m18:06:15.919806 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_customers"
[0m18:06:15.920364 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_customers
[0m18:06:15.920742 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_customers
[0m18:06:15.920955 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_dates
[0m18:06:15.921180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_customers, now model.my_star_schema_project.dim_dates)
[0m18:06:15.921369 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_dates
[0m18:06:15.922954 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_dates"
[0m18:06:15.923463 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_dates
[0m18:06:15.923781 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_dates
[0m18:06:15.923968 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_products
[0m18:06:15.924175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_dates, now model.my_star_schema_project.dim_products)
[0m18:06:15.924356 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_products
[0m18:06:15.926065 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_products"
[0m18:06:15.926368 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_products
[0m18:06:15.926679 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_products
[0m18:06:15.926865 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.fact_sales
[0m18:06:15.927136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_products, now model.my_star_schema_project.fact_sales)
[0m18:06:15.927318 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.fact_sales
[0m18:06:15.929470 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.fact_sales"
[0m18:06:15.929832 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.fact_sales
[0m18:06:15.930177 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.fact_sales
[0m18:06:15.930391 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m18:06:15.930664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.fact_sales, now test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d)
[0m18:06:15.930858 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m18:06:15.937320 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"
[0m18:06:15.938002 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m18:06:15.938369 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m18:06:15.938575 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:06:15.938815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d, now test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m18:06:15.939006 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:06:15.941165 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m18:06:15.941677 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:06:15.942094 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:06:15.942309 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m18:06:15.942570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d)
[0m18:06:15.942804 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m18:06:15.944877 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"
[0m18:06:15.945425 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m18:06:15.945757 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m18:06:15.945955 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m18:06:15.946176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d, now test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa)
[0m18:06:15.946434 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m18:06:15.948445 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"
[0m18:06:15.948762 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m18:06:15.949108 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m18:06:15.949333 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:06:15.949632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa, now test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m18:06:15.949850 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:06:15.953950 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m18:06:15.954574 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:06:15.954946 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:06:15.955159 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m18:06:15.955393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.my_star_schema_project.not_null_dim_products_price.93519fc0ed)
[0m18:06:15.955589 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m18:06:15.958485 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m18:06:15.958827 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m18:06:15.959153 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m18:06:15.959349 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m18:06:15.959563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_price.93519fc0ed, now test.my_star_schema_project.not_null_dim_products_product_category.069796c541)
[0m18:06:15.959748 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m18:06:15.992573 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m18:06:15.993071 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m18:06:15.993439 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m18:06:15.993656 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m18:06:15.993861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_category.069796c541, now test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1)
[0m18:06:15.994119 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m18:06:15.996214 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m18:06:15.996684 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m18:06:15.997013 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m18:06:15.997209 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m18:06:15.997426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1, now test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3)
[0m18:06:15.997610 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m18:06:15.999638 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m18:06:15.999944 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m18:06:16.000265 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m18:06:16.000465 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m18:06:16.000676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3, now test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985)
[0m18:06:16.000863 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m18:06:16.003045 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m18:06:16.003455 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m18:06:16.003816 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m18:06:16.004031 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.star_schema_view
[0m18:06:16.004274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985, now model.my_star_schema_project.star_schema_view)
[0m18:06:16.004489 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.star_schema_view
[0m18:06:16.006350 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.star_schema_view"
[0m18:06:16.006799 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.star_schema_view
[0m18:06:16.007130 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.star_schema_view
[0m18:06:16.007568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:16.007735 [debug] [MainThread]: Connection 'model.my_star_schema_project.star_schema_view' was properly closed.
[0m18:06:16.009019 [debug] [MainThread]: Command end result
[0m18:06:16.023103 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m18:06:16.024071 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m18:06:16.028718 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m18:06:16.029996 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.7150365, "process_in_blocks": "0", "process_kernel_time": 0.169775, "process_mem_max_rss": "130613248", "process_out_blocks": "0", "process_user_time": 1.135053}
[0m18:06:16.030288 [debug] [MainThread]: Command `dbt compile` succeeded at 18:06:16.030237 after 0.72 seconds
[0m18:06:16.030528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c5240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104787f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075bf5e0>]}
[0m18:06:16.030754 [debug] [MainThread]: Flushing usage events
[0m18:06:16.789869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:28.852791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036992d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f54e0>]}


============================== 18:08:28.855756 | 338602c9-746d-4ef6-8b71-de36fb1f98cc ==============================
[0m18:08:28.855756 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:08:28.856107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:08:29.011294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '338602c9-746d-4ef6-8b71-de36fb1f98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10462e3b0>]}
[0m18:08:29.042677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '338602c9-746d-4ef6-8b71-de36fb1f98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10402c280>]}
[0m18:08:29.045452 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m18:08:29.099539 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:08:29.184823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:08:29.185111 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:08:29.216550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '338602c9-746d-4ef6-8b71-de36fb1f98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a84070>]}
[0m18:08:29.266549 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m18:08:29.267879 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m18:08:29.279788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '338602c9-746d-4ef6-8b71-de36fb1f98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a59de0>]}
[0m18:08:29.280131 [info ] [MainThread]: Found 5 models, 4 seeds, 10 data tests, 426 macros
[0m18:08:29.280332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '338602c9-746d-4ef6-8b71-de36fb1f98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5bd60>]}
[0m18:08:29.281284 [info ] [MainThread]: 
[0m18:08:29.281487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:08:29.281653 [info ] [MainThread]: 
[0m18:08:29.281929 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:08:29.284643 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb'
[0m18:08:29.315981 [debug] [ThreadPool]: Using duckdb connection "list_duckdb"
[0m18:08:29.316251 [debug] [ThreadPool]: On list_duckdb: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duckdb"'
    
  
  
[0m18:08:29.316423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:29.362309 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m18:08:29.363346 [debug] [ThreadPool]: On list_duckdb: Close
[0m18:08:29.364984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_duckdb, now create_duckdb_main)
[0m18:08:29.365266 [debug] [ThreadPool]: Creating schema "database: "duckdb"
schema: "main"
"
[0m18:08:29.369002 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m18:08:29.369238 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='duckdb'
        and type='sqlite'
    
  
[0m18:08:29.369410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:29.374826 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:08:29.375557 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m18:08:29.375734 [debug] [ThreadPool]: On create_duckdb_main: BEGIN
[0m18:08:29.375953 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:29.376118 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m18:08:29.376276 [debug] [ThreadPool]: On create_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "create_duckdb_main"} */

    
    
        create schema if not exists "duckdb"."main"
    
[0m18:08:29.376914 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:29.377413 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m18:08:29.377596 [debug] [ThreadPool]: Using duckdb connection "create_duckdb_main"
[0m18:08:29.377752 [debug] [ThreadPool]: On create_duckdb_main: COMMIT
[0m18:08:29.377974 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:29.378146 [debug] [ThreadPool]: On create_duckdb_main: Close
[0m18:08:29.379888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_duckdb_main, now list_duckdb_main)
[0m18:08:29.382985 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m18:08:29.383172 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m18:08:29.383324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:29.388637 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:08:29.388882 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m18:08:29.389063 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m18:08:29.403032 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m18:08:29.404260 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m18:08:29.405092 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m18:08:29.405348 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m18:08:29.412854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '338602c9-746d-4ef6-8b71-de36fb1f98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102612860>]}
[0m18:08:29.415195 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:29.415956 [debug] [MainThread]: On master: BEGIN
[0m18:08:29.416190 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:29.424807 [debug] [MainThread]: SQL status: OK in 0.008 seconds
[0m18:08:29.425223 [debug] [MainThread]: On master: COMMIT
[0m18:08:29.425438 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:29.425618 [debug] [MainThread]: On master: COMMIT
[0m18:08:29.425875 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:29.426067 [debug] [MainThread]: On master: Close
[0m18:08:29.429357 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_customers
[0m18:08:29.429824 [info ] [Thread-1 (]: 1 of 5 START sql view model main.dim_customers ................................. [RUN]
[0m18:08:29.430433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now model.my_star_schema_project.dim_customers)
[0m18:08:29.430934 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_customers
[0m18:08:29.439876 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_customers"
[0m18:08:29.441249 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_customers
[0m18:08:29.472788 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.dim_customers"
[0m18:08:29.473495 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m18:08:29.473757 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: BEGIN
[0m18:08:29.473969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:29.480587 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m18:08:29.480955 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m18:08:29.481181 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */

  
  create view "duckdb"."main"."dim_customers__dbt_tmp" as (
    -- models/dim_customers.sql
select 
    customer_id,
    customer_name,
    customer_city,
    customer_state
from "duckdb"."main"."customers"
  );

[0m18:08:29.481646 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.486792 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m18:08:29.487159 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */
alter view "duckdb"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:08:29.488070 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:08:29.490390 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m18:08:29.490703 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */
alter view "duckdb"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:08:29.491170 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.499723 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: COMMIT
[0m18:08:29.500188 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m18:08:29.500441 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: COMMIT
[0m18:08:29.501914 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:08:29.506489 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_customers"
[0m18:08:29.506871 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_customers"} */
drop view if exists "duckdb"."main"."dim_customers__dbt_backup" cascade
[0m18:08:29.507686 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:08:29.509879 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_customers: Close
[0m18:08:29.516893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338602c9-746d-4ef6-8b71-de36fb1f98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102747f10>]}
[0m18:08:29.517464 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.dim_customers ............................ [[32mOK[0m in 0.09s]
[0m18:08:29.517874 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_customers
[0m18:08:29.518197 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_dates
[0m18:08:29.518666 [info ] [Thread-1 (]: 2 of 5 START sql view model main.dim_dates ..................................... [RUN]
[0m18:08:29.519074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_customers, now model.my_star_schema_project.dim_dates)
[0m18:08:29.519309 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_dates
[0m18:08:29.521352 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_dates"
[0m18:08:29.522095 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_dates
[0m18:08:29.525153 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.dim_dates"
[0m18:08:29.527045 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m18:08:29.527355 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: BEGIN
[0m18:08:29.527561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:29.537392 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m18:08:29.538196 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m18:08:29.538775 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */

  
  create view "duckdb"."main"."dim_dates__dbt_tmp" as (
    -- models/dim_dates.sql
select 
    date_key,
    date,
    year,
    month,
    day
from "duckdb"."main"."dates"
  );

[0m18:08:29.539744 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.543057 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m18:08:29.543347 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */
alter view "duckdb"."main"."dim_dates" rename to "dim_dates__dbt_backup"
[0m18:08:29.543773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.545613 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m18:08:29.545964 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */
alter view "duckdb"."main"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m18:08:29.546358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.547308 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: COMMIT
[0m18:08:29.547557 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m18:08:29.547750 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: COMMIT
[0m18:08:29.548382 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.550993 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_dates"
[0m18:08:29.551370 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_dates"} */
drop view if exists "duckdb"."main"."dim_dates__dbt_backup" cascade
[0m18:08:29.551897 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.552669 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_dates: Close
[0m18:08:29.554654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338602c9-746d-4ef6-8b71-de36fb1f98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105063550>]}
[0m18:08:29.555020 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.dim_dates ................................ [[32mOK[0m in 0.04s]
[0m18:08:29.555321 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_dates
[0m18:08:29.555533 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_products
[0m18:08:29.555802 [info ] [Thread-1 (]: 3 of 5 START sql view model main.dim_products .................................. [RUN]
[0m18:08:29.556041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_dates, now model.my_star_schema_project.dim_products)
[0m18:08:29.556240 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_products
[0m18:08:29.590631 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_products"
[0m18:08:29.591167 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_products
[0m18:08:29.593159 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.dim_products"
[0m18:08:29.593500 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m18:08:29.593690 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: BEGIN
[0m18:08:29.593862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:29.599559 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:08:29.599886 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m18:08:29.600102 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */

  
  create view "duckdb"."main"."dim_products__dbt_tmp" as (
    -- models/dim_products.sql

with avg_calc as (
  -- products テーブルから price の平均値（NULL は除外）を計算
  select
    avg(price) as avg_price
  from "duckdb"."main"."products"
  where price is not null
)
select
  p.product_id,
  p.product_name,
  p.product_category,
  -- 欠損している場合は avg_price を利用
  coalesce(p.price, a.avg_price) as price
from "duckdb"."main"."products" as p
cross join avg_calc as a
  );

[0m18:08:29.600810 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.603061 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m18:08:29.603371 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */
alter view "duckdb"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m18:08:29.603903 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.605945 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m18:08:29.606181 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */
alter view "duckdb"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m18:08:29.606555 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.607525 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: COMMIT
[0m18:08:29.607722 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m18:08:29.607897 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: COMMIT
[0m18:08:29.608442 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.609992 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.dim_products"
[0m18:08:29.610237 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.dim_products"} */
drop view if exists "duckdb"."main"."dim_products__dbt_backup" cascade
[0m18:08:29.610699 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.611436 [debug] [Thread-1 (]: On model.my_star_schema_project.dim_products: Close
[0m18:08:29.614036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338602c9-746d-4ef6-8b71-de36fb1f98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105063550>]}
[0m18:08:29.614563 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.dim_products ............................. [[32mOK[0m in 0.06s]
[0m18:08:29.614894 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_products
[0m18:08:29.615117 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.fact_sales
[0m18:08:29.615403 [info ] [Thread-1 (]: 4 of 5 START sql view model main.fact_sales .................................... [RUN]
[0m18:08:29.615671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_products, now model.my_star_schema_project.fact_sales)
[0m18:08:29.615874 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.fact_sales
[0m18:08:29.617602 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.fact_sales"
[0m18:08:29.618202 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.fact_sales
[0m18:08:29.621502 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.fact_sales"
[0m18:08:29.622054 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m18:08:29.622285 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: BEGIN
[0m18:08:29.622476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:29.628579 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:08:29.628891 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m18:08:29.629100 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */

  
  create view "duckdb"."main"."fact_sales__dbt_tmp" as (
    -- models/fact_sales.sql
select 
    sale_id,
    customer_id,
    product_id,
    date_key,
    quantity,
    total_amount
from "duckdb"."main"."sales"
  );

[0m18:08:29.629510 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.632013 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m18:08:29.632382 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */
alter view "duckdb"."main"."fact_sales" rename to "fact_sales__dbt_backup"
[0m18:08:29.632854 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.634880 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m18:08:29.635197 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */
alter view "duckdb"."main"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m18:08:29.635827 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.636905 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: COMMIT
[0m18:08:29.637141 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m18:08:29.637327 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: COMMIT
[0m18:08:29.637847 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.639242 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.fact_sales"
[0m18:08:29.639438 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.fact_sales"} */
drop view if exists "duckdb"."main"."fact_sales__dbt_backup" cascade
[0m18:08:29.639801 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.640508 [debug] [Thread-1 (]: On model.my_star_schema_project.fact_sales: Close
[0m18:08:29.642485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338602c9-746d-4ef6-8b71-de36fb1f98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105063550>]}
[0m18:08:29.642844 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.fact_sales ............................... [[32mOK[0m in 0.03s]
[0m18:08:29.643151 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.fact_sales
[0m18:08:29.643533 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.star_schema_view
[0m18:08:29.643835 [info ] [Thread-1 (]: 5 of 5 START sql view model main.star_schema_view .............................. [RUN]
[0m18:08:29.644116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.fact_sales, now model.my_star_schema_project.star_schema_view)
[0m18:08:29.644314 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.star_schema_view
[0m18:08:29.646524 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.star_schema_view"
[0m18:08:29.647012 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.star_schema_view
[0m18:08:29.649527 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_star_schema_project.star_schema_view"
[0m18:08:29.650011 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m18:08:29.650206 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: BEGIN
[0m18:08:29.650378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:29.657141 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m18:08:29.657449 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m18:08:29.657675 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */

  
  create view "duckdb"."main"."star_schema_view__dbt_tmp" as (
    -- models/star_schema_view.sql
with fact as (
    select * from "duckdb"."main"."fact_sales"
),
customers as (
    select * from "duckdb"."main"."dim_customers"
),
products as (
    select * from "duckdb"."main"."dim_products"
),
dates as (
    select * from "duckdb"."main"."dim_dates"
)
select
    f.sale_id,
    f.quantity,
    f.total_amount,
    c.customer_id,
    c.customer_name,
    c.customer_city,
    c.customer_state,
    p.product_id,
    p.product_name,
    p.product_category,
    p.price,
    d.date_key,
    d.date,
    d.year,
    d.month,
    d.day
from fact f
left join customers c on f.customer_id = c.customer_id
left join products p on f.product_id = p.product_id
left join dates d on f.date_key = d.date_key
  );

[0m18:08:29.658433 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:08:29.660328 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m18:08:29.660535 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */
alter view "duckdb"."main"."star_schema_view" rename to "star_schema_view__dbt_backup"
[0m18:08:29.660842 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.662362 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m18:08:29.662557 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */
alter view "duckdb"."main"."star_schema_view__dbt_tmp" rename to "star_schema_view"
[0m18:08:29.662839 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.663628 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: COMMIT
[0m18:08:29.664744 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m18:08:29.664918 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: COMMIT
[0m18:08:29.665461 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.666785 [debug] [Thread-1 (]: Using duckdb connection "model.my_star_schema_project.star_schema_view"
[0m18:08:29.666990 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "node_id": "model.my_star_schema_project.star_schema_view"} */
drop view if exists "duckdb"."main"."star_schema_view__dbt_backup" cascade
[0m18:08:29.667373 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:29.667998 [debug] [Thread-1 (]: On model.my_star_schema_project.star_schema_view: Close
[0m18:08:29.670391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338602c9-746d-4ef6-8b71-de36fb1f98cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104705ea0>]}
[0m18:08:29.670822 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.star_schema_view ......................... [[32mOK[0m in 0.03s]
[0m18:08:29.671127 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.star_schema_view
[0m18:08:29.671724 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:29.671927 [debug] [MainThread]: On master: BEGIN
[0m18:08:29.672086 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:29.677376 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m18:08:29.677835 [debug] [MainThread]: On master: COMMIT
[0m18:08:29.678052 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:29.678217 [debug] [MainThread]: On master: COMMIT
[0m18:08:29.678460 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:29.678634 [debug] [MainThread]: On master: Close
[0m18:08:29.679812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:29.679995 [debug] [MainThread]: Connection 'model.my_star_schema_project.star_schema_view' was properly closed.
[0m18:08:29.680210 [info ] [MainThread]: 
[0m18:08:29.680398 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m18:08:29.680987 [debug] [MainThread]: Command end result
[0m18:08:29.695665 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m18:08:29.696654 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m18:08:29.700178 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m18:08:29.700378 [info ] [MainThread]: 
[0m18:08:29.700601 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:08:29.700773 [info ] [MainThread]: 
[0m18:08:29.700957 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:08:29.702384 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.891371, "process_in_blocks": "0", "process_kernel_time": 0.186528, "process_mem_max_rss": "137543680", "process_out_blocks": "0", "process_user_time": 1.286115}
[0m18:08:29.702704 [debug] [MainThread]: Command `dbt run` succeeded at 18:08:29.702657 after 0.89 seconds
[0m18:08:29.702940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036992d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10375ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104939ea0>]}
[0m18:08:29.703189 [debug] [MainThread]: Flushing usage events
[0m18:08:30.901650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:18:21.752334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec52a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd6d10>]}


============================== 18:18:21.756383 | 05de036f-0d67-413f-bd52-3d77aa5ab2c1 ==============================
[0m18:18:21.756383 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:18:21.756881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate --static', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:18:21.976437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05de036f-0d67-413f-bd52-3d77aa5ab2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e591b0>]}
[0m18:18:22.008773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05de036f-0d67-413f-bd52-3d77aa5ab2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517d030>]}
[0m18:18:22.012443 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m18:18:22.068827 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:18:22.154340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:18:22.154639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:18:22.185699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05de036f-0d67-413f-bd52-3d77aa5ab2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ac100>]}
[0m18:18:22.197970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05de036f-0d67-413f-bd52-3d77aa5ab2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106275ea0>]}
[0m18:18:22.198330 [info ] [MainThread]: Found 5 models, 4 seeds, 10 data tests, 426 macros
[0m18:18:22.198541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05de036f-0d67-413f-bd52-3d77aa5ab2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106275930>]}
[0m18:18:22.199671 [info ] [MainThread]: 
[0m18:18:22.199887 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:18:22.200056 [info ] [MainThread]: 
[0m18:18:22.200339 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:18:22.203171 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb_main'
[0m18:18:22.236885 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m18:18:22.237147 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m18:18:22.237320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:22.279477 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m18:18:22.279852 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m18:18:22.280063 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m18:18:22.295671 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m18:18:22.296843 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m18:18:22.297464 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m18:18:22.297657 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m18:18:22.300196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05de036f-0d67-413f-bd52-3d77aa5ab2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106274070>]}
[0m18:18:22.301883 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.customers
[0m18:18:22.302137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now seed.my_star_schema_project.customers)
[0m18:18:22.302325 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.customers
[0m18:18:22.306170 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.customers
[0m18:18:22.306530 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.customers
[0m18:18:22.306728 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.dates
[0m18:18:22.306991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.customers, now seed.my_star_schema_project.dates)
[0m18:18:22.307179 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.dates
[0m18:18:22.308211 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.dates
[0m18:18:22.308532 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.dates
[0m18:18:22.308721 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.products
[0m18:18:22.308952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.dates, now seed.my_star_schema_project.products)
[0m18:18:22.309134 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.products
[0m18:18:22.310102 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.products
[0m18:18:22.310404 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.products
[0m18:18:22.310592 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.sales
[0m18:18:22.310817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.products, now seed.my_star_schema_project.sales)
[0m18:18:22.310997 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.sales
[0m18:18:22.311949 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.sales
[0m18:18:22.312254 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.sales
[0m18:18:22.312457 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_customers
[0m18:18:22.312726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.sales, now model.my_star_schema_project.dim_customers)
[0m18:18:22.312917 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_customers
[0m18:18:22.314696 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_customers"
[0m18:18:22.315348 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_customers
[0m18:18:22.315745 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_customers
[0m18:18:22.315955 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_dates
[0m18:18:22.316161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_customers, now model.my_star_schema_project.dim_dates)
[0m18:18:22.316349 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_dates
[0m18:18:22.317797 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_dates"
[0m18:18:22.318304 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_dates
[0m18:18:22.318650 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_dates
[0m18:18:22.318853 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_products
[0m18:18:22.319073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_dates, now model.my_star_schema_project.dim_products)
[0m18:18:22.319258 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_products
[0m18:18:22.320739 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_products"
[0m18:18:22.321033 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_products
[0m18:18:22.321348 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_products
[0m18:18:22.321536 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.fact_sales
[0m18:18:22.321804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_products, now model.my_star_schema_project.fact_sales)
[0m18:18:22.321984 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.fact_sales
[0m18:18:22.324029 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.fact_sales"
[0m18:18:22.324328 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.fact_sales
[0m18:18:22.324651 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.fact_sales
[0m18:18:22.324847 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m18:18:22.325076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.fact_sales, now test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d)
[0m18:18:22.325273 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m18:18:22.331416 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"
[0m18:18:22.332019 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m18:18:22.332399 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m18:18:22.332608 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:18:22.332846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d, now test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m18:18:22.333039 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:18:22.335145 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m18:18:22.335453 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:18:22.335780 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:18:22.335979 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m18:18:22.336190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d)
[0m18:18:22.336375 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m18:18:22.338380 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"
[0m18:18:22.338682 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m18:18:22.339010 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m18:18:22.339213 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m18:18:22.339423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d, now test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa)
[0m18:18:22.339612 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m18:18:22.341543 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"
[0m18:18:22.341839 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m18:18:22.342159 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m18:18:22.342353 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:18:22.342563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa, now test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m18:18:22.342749 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:18:22.345984 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m18:18:22.346584 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:18:22.347098 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:18:22.347340 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m18:18:22.347601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.my_star_schema_project.not_null_dim_products_price.93519fc0ed)
[0m18:18:22.347806 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m18:18:22.350796 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m18:18:22.351308 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m18:18:22.351643 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m18:18:22.351839 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m18:18:22.352052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_price.93519fc0ed, now test.my_star_schema_project.not_null_dim_products_product_category.069796c541)
[0m18:18:22.352241 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m18:18:22.354186 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m18:18:22.354492 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m18:18:22.354816 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m18:18:22.355010 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m18:18:22.355222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_category.069796c541, now test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1)
[0m18:18:22.355412 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m18:18:22.357399 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m18:18:22.357860 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m18:18:22.358212 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m18:18:22.358428 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m18:18:22.358657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1, now test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3)
[0m18:18:22.358845 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m18:18:22.360963 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m18:18:22.361286 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m18:18:22.361615 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m18:18:22.361812 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m18:18:22.362023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3, now test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985)
[0m18:18:22.362209 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m18:18:22.364348 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m18:18:22.364768 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m18:18:22.365135 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m18:18:22.365350 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.star_schema_view
[0m18:18:22.365588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985, now model.my_star_schema_project.star_schema_view)
[0m18:18:22.365778 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.star_schema_view
[0m18:18:22.367661 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.star_schema_view"
[0m18:18:22.368135 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.star_schema_view
[0m18:18:22.368477 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.star_schema_view
[0m18:18:22.368925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:22.369107 [debug] [MainThread]: Connection 'model.my_star_schema_project.star_schema_view' was properly closed.
[0m18:18:22.370420 [debug] [MainThread]: Command end result
[0m18:18:22.452317 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m18:18:22.454122 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m18:18:22.458464 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m18:18:22.460965 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m18:18:22.461177 [info ] [MainThread]: Building catalog
[0m18:18:22.466739 [debug] [ThreadPool]: Acquiring new duckdb connection 'duckdb.information_schema'
[0m18:18:22.471166 [debug] [ThreadPool]: Using duckdb connection "duckdb.information_schema"
[0m18:18:22.471583 [debug] [ThreadPool]: On duckdb.information_schema: BEGIN
[0m18:18:22.471785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:22.477467 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m18:18:22.477960 [debug] [ThreadPool]: Using duckdb connection "duckdb.information_schema"
[0m18:18:22.478221 [debug] [ThreadPool]: On duckdb.information_schema: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "duckdb.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'duckdb'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'duckdb'
    )
    select
        'duckdb' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m18:18:22.493036 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m18:18:22.509715 [debug] [ThreadPool]: On duckdb.information_schema: ROLLBACK
[0m18:18:22.510051 [debug] [ThreadPool]: Failed to rollback 'duckdb.information_schema'
[0m18:18:22.510224 [debug] [ThreadPool]: On duckdb.information_schema: Close
[0m18:18:22.526624 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/takeshiiijima/github/duckdb-dbt/target/catalog.json
[0m18:18:22.539689 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m18:18:22.540527 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m18:18:22.545790 [info ] [MainThread]: Catalog written to /Users/takeshiiijima/github/duckdb-dbt/target/catalog.json
[0m18:18:22.549583 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.8605573, "process_in_blocks": "0", "process_kernel_time": 0.197598, "process_mem_max_rss": "155140096", "process_out_blocks": "0", "process_user_time": 1.24894}
[0m18:18:22.549921 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:18:22.549872 after 0.86 seconds
[0m18:18:22.550125 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:18:22.550281 [debug] [MainThread]: Connection 'duckdb.information_schema' was properly closed.
[0m18:18:22.550476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec52a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517d030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d5e40>]}
[0m18:18:22.550699 [debug] [MainThread]: Flushing usage events
[0m18:18:23.575908 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:32:09.870517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc12d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107397eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107396ec0>]}


============================== 18:32:09.873504 | f74ad143-7bf0-435c-8ca3-e17adce632c8 ==============================
[0m18:32:09.873504 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:32:09.873923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate --static', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:32:10.026603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f74ad143-7bf0-435c-8ca3-e17adce632c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104957640>]}
[0m18:32:10.055434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f74ad143-7bf0-435c-8ca3-e17adce632c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10757b130>]}
[0m18:32:10.058363 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m18:32:10.112551 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:32:10.227303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:32:10.227678 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:32:10.272278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f74ad143-7bf0-435c-8ca3-e17adce632c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6c130>]}
[0m18:32:10.286117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f74ad143-7bf0-435c-8ca3-e17adce632c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6f1c0>]}
[0m18:32:10.286490 [info ] [MainThread]: Found 5 models, 4 seeds, 10 data tests, 426 macros
[0m18:32:10.286709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f74ad143-7bf0-435c-8ca3-e17adce632c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6f220>]}
[0m18:32:10.287946 [info ] [MainThread]: 
[0m18:32:10.288169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:32:10.288337 [info ] [MainThread]: 
[0m18:32:10.289893 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:32:10.302312 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb_main'
[0m18:32:10.334969 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m18:32:10.335241 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m18:32:10.335414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:10.379377 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m18:32:10.379667 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m18:32:10.379859 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m18:32:10.396632 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m18:32:10.397764 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m18:32:10.398362 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m18:32:10.398533 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m18:32:10.401153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f74ad143-7bf0-435c-8ca3-e17adce632c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6ce50>]}
[0m18:32:10.402906 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.customers
[0m18:32:10.403233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now seed.my_star_schema_project.customers)
[0m18:32:10.403451 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.customers
[0m18:32:10.407474 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.customers
[0m18:32:10.407886 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.customers
[0m18:32:10.408095 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.dates
[0m18:32:10.408391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.customers, now seed.my_star_schema_project.dates)
[0m18:32:10.408606 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.dates
[0m18:32:10.409636 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.dates
[0m18:32:10.409960 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.dates
[0m18:32:10.410156 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.products
[0m18:32:10.410396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.dates, now seed.my_star_schema_project.products)
[0m18:32:10.410580 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.products
[0m18:32:10.411597 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.products
[0m18:32:10.411893 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.products
[0m18:32:10.412080 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.sales
[0m18:32:10.412310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.products, now seed.my_star_schema_project.sales)
[0m18:32:10.412490 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.sales
[0m18:32:10.413446 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.sales
[0m18:32:10.413745 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.sales
[0m18:32:10.413937 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_customers
[0m18:32:10.414121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.sales, now model.my_star_schema_project.dim_customers)
[0m18:32:10.414297 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_customers
[0m18:32:10.415775 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_customers"
[0m18:32:10.416154 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_customers
[0m18:32:10.416470 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_customers
[0m18:32:10.416660 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_dates
[0m18:32:10.416848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_customers, now model.my_star_schema_project.dim_dates)
[0m18:32:10.417025 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_dates
[0m18:32:10.418410 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_dates"
[0m18:32:10.418895 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_dates
[0m18:32:10.419205 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_dates
[0m18:32:10.419390 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_products
[0m18:32:10.419595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_dates, now model.my_star_schema_project.dim_products)
[0m18:32:10.419779 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_products
[0m18:32:10.421272 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_products"
[0m18:32:10.421551 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_products
[0m18:32:10.421857 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_products
[0m18:32:10.422041 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.fact_sales
[0m18:32:10.422300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_products, now model.my_star_schema_project.fact_sales)
[0m18:32:10.422481 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.fact_sales
[0m18:32:10.424666 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.fact_sales"
[0m18:32:10.425062 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.fact_sales
[0m18:32:10.425414 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.fact_sales
[0m18:32:10.425622 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m18:32:10.425883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.fact_sales, now test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d)
[0m18:32:10.426083 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m18:32:10.431959 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"
[0m18:32:10.432557 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m18:32:10.432905 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m18:32:10.433121 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:32:10.433357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d, now test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m18:32:10.433549 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:32:10.435801 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m18:32:10.436121 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:32:10.436448 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:32:10.436645 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m18:32:10.436860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d)
[0m18:32:10.437045 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m18:32:10.439035 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"
[0m18:32:10.439321 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m18:32:10.439755 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m18:32:10.439979 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m18:32:10.440223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d, now test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa)
[0m18:32:10.440508 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m18:32:10.442594 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"
[0m18:32:10.442930 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m18:32:10.443253 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m18:32:10.443448 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:32:10.443659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa, now test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m18:32:10.443848 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:32:10.446987 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m18:32:10.447319 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:32:10.447653 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:32:10.447856 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m18:32:10.448113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.my_star_schema_project.not_null_dim_products_price.93519fc0ed)
[0m18:32:10.448331 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m18:32:10.451258 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m18:32:10.451606 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m18:32:10.451946 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m18:32:10.452143 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m18:32:10.452364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_price.93519fc0ed, now test.my_star_schema_project.not_null_dim_products_product_category.069796c541)
[0m18:32:10.452549 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m18:32:10.454546 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m18:32:10.454874 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m18:32:10.455208 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m18:32:10.455403 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m18:32:10.455616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_category.069796c541, now test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1)
[0m18:32:10.455811 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m18:32:10.458004 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m18:32:10.458506 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m18:32:10.458842 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m18:32:10.459048 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m18:32:10.459279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1, now test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3)
[0m18:32:10.459469 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m18:32:10.461642 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m18:32:10.461949 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m18:32:10.462267 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m18:32:10.462459 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m18:32:10.462672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3, now test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985)
[0m18:32:10.462857 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m18:32:10.464820 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m18:32:10.465097 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m18:32:10.465412 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m18:32:10.465606 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.star_schema_view
[0m18:32:10.465814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985, now model.my_star_schema_project.star_schema_view)
[0m18:32:10.465996 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.star_schema_view
[0m18:32:10.467733 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.star_schema_view"
[0m18:32:10.468230 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.star_schema_view
[0m18:32:10.468544 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.star_schema_view
[0m18:32:10.469002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:10.469207 [debug] [MainThread]: Connection 'model.my_star_schema_project.star_schema_view' was properly closed.
[0m18:32:10.470521 [debug] [MainThread]: Command end result
[0m18:32:10.548020 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m18:32:10.549510 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m18:32:10.553642 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m18:32:10.555894 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m18:32:10.556101 [info ] [MainThread]: Building catalog
[0m18:32:10.561624 [debug] [ThreadPool]: Acquiring new duckdb connection 'duckdb.information_schema'
[0m18:32:10.565939 [debug] [ThreadPool]: Using duckdb connection "duckdb.information_schema"
[0m18:32:10.566261 [debug] [ThreadPool]: On duckdb.information_schema: BEGIN
[0m18:32:10.566540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:10.572264 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m18:32:10.572549 [debug] [ThreadPool]: Using duckdb connection "duckdb.information_schema"
[0m18:32:10.572752 [debug] [ThreadPool]: On duckdb.information_schema: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "duckdb.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'duckdb'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'duckdb'
    )
    select
        'duckdb' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m18:32:10.585973 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m18:32:10.601807 [debug] [ThreadPool]: On duckdb.information_schema: ROLLBACK
[0m18:32:10.602092 [debug] [ThreadPool]: Failed to rollback 'duckdb.information_schema'
[0m18:32:10.602254 [debug] [ThreadPool]: On duckdb.information_schema: Close
[0m18:32:10.619174 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/takeshiiijima/github/duckdb-dbt/target/catalog.json
[0m18:32:10.632257 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m18:32:10.633152 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m18:32:10.637948 [info ] [MainThread]: Catalog written to /Users/takeshiiijima/github/duckdb-dbt/target/catalog.json
[0m18:32:10.639669 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.8139265, "process_in_blocks": "0", "process_kernel_time": 0.186275, "process_mem_max_rss": "154206208", "process_out_blocks": "0", "process_user_time": 1.220828}
[0m18:32:10.640301 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:32:10.640202 after 0.81 seconds
[0m18:32:10.640652 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:32:10.640836 [debug] [MainThread]: Connection 'duckdb.information_schema' was properly closed.
[0m18:32:10.641040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc12d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fb7b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671b220>]}
[0m18:32:10.641339 [debug] [MainThread]: Flushing usage events
[0m18:32:12.005166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:35:02.538317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e52a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff6d10>]}


============================== 18:35:02.541980 | 85aa21e7-c2b8-4351-b0b1-d428c03d6171 ==============================
[0m18:35:02.541980 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:35:02.542340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/takeshiiijima/github/duckdb-dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/takeshiiijima/github/duckdb-dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:35:02.695565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85aa21e7-c2b8-4351-b0b1-d428c03d6171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061791b0>]}
[0m18:35:02.725018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85aa21e7-c2b8-4351-b0b1-d428c03d6171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10549d030>]}
[0m18:35:02.727775 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m18:35:02.783196 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:35:02.865542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:02.865810 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:02.896494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85aa21e7-c2b8-4351-b0b1-d428c03d6171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cc100>]}
[0m18:35:02.908469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85aa21e7-c2b8-4351-b0b1-d428c03d6171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106595ea0>]}
[0m18:35:02.908818 [info ] [MainThread]: Found 5 models, 4 seeds, 10 data tests, 426 macros
[0m18:35:02.909025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85aa21e7-c2b8-4351-b0b1-d428c03d6171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106595930>]}
[0m18:35:02.910126 [info ] [MainThread]: 
[0m18:35:02.910333 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:02.910498 [info ] [MainThread]: 
[0m18:35:02.910770 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:35:02.913608 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duckdb_main'
[0m18:35:02.945751 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m18:35:02.946019 [debug] [ThreadPool]: On list_duckdb_main: BEGIN
[0m18:35:02.946193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:02.987199 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m18:35:02.987483 [debug] [ThreadPool]: Using duckdb connection "list_duckdb_main"
[0m18:35:02.987663 [debug] [ThreadPool]: On list_duckdb_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "list_duckdb_main"} */
select
      'duckdb' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duckdb'
  
[0m18:35:03.002571 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m18:35:03.003663 [debug] [ThreadPool]: On list_duckdb_main: ROLLBACK
[0m18:35:03.004217 [debug] [ThreadPool]: Failed to rollback 'list_duckdb_main'
[0m18:35:03.004397 [debug] [ThreadPool]: On list_duckdb_main: Close
[0m18:35:03.006975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85aa21e7-c2b8-4351-b0b1-d428c03d6171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106594070>]}
[0m18:35:03.008587 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.customers
[0m18:35:03.008845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_duckdb_main, now seed.my_star_schema_project.customers)
[0m18:35:03.009039 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.customers
[0m18:35:03.012914 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.customers
[0m18:35:03.013294 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.customers
[0m18:35:03.013496 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.dates
[0m18:35:03.013761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.customers, now seed.my_star_schema_project.dates)
[0m18:35:03.013950 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.dates
[0m18:35:03.014923 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.dates
[0m18:35:03.015228 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.dates
[0m18:35:03.015414 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.products
[0m18:35:03.015644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.dates, now seed.my_star_schema_project.products)
[0m18:35:03.015823 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.products
[0m18:35:03.016791 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.products
[0m18:35:03.017097 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.products
[0m18:35:03.017291 [debug] [Thread-1 (]: Began running node seed.my_star_schema_project.sales
[0m18:35:03.017522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.products, now seed.my_star_schema_project.sales)
[0m18:35:03.017699 [debug] [Thread-1 (]: Began compiling node seed.my_star_schema_project.sales
[0m18:35:03.018663 [debug] [Thread-1 (]: Began executing node seed.my_star_schema_project.sales
[0m18:35:03.018959 [debug] [Thread-1 (]: Finished running node seed.my_star_schema_project.sales
[0m18:35:03.019151 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_customers
[0m18:35:03.019371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_star_schema_project.sales, now model.my_star_schema_project.dim_customers)
[0m18:35:03.019555 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_customers
[0m18:35:03.021109 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_customers"
[0m18:35:03.021685 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_customers
[0m18:35:03.022125 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_customers
[0m18:35:03.022343 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_dates
[0m18:35:03.022679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_customers, now model.my_star_schema_project.dim_dates)
[0m18:35:03.022903 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_dates
[0m18:35:03.024556 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_dates"
[0m18:35:03.025048 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_dates
[0m18:35:03.025396 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_dates
[0m18:35:03.025596 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.dim_products
[0m18:35:03.025829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_dates, now model.my_star_schema_project.dim_products)
[0m18:35:03.026018 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.dim_products
[0m18:35:03.027640 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.dim_products"
[0m18:35:03.028000 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.dim_products
[0m18:35:03.028336 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.dim_products
[0m18:35:03.028532 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.fact_sales
[0m18:35:03.028868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.dim_products, now model.my_star_schema_project.fact_sales)
[0m18:35:03.029124 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.fact_sales
[0m18:35:03.031409 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.fact_sales"
[0m18:35:03.031935 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.fact_sales
[0m18:35:03.032291 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.fact_sales
[0m18:35:03.032493 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m18:35:03.032758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_star_schema_project.fact_sales, now test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d)
[0m18:35:03.032954 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m18:35:03.039031 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d"
[0m18:35:03.039784 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m18:35:03.040182 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d
[0m18:35:03.040396 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:35:03.040662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_city.f59e32635d, now test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m18:35:03.040904 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:35:03.043101 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m18:35:03.043578 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:35:03.043924 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m18:35:03.044144 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m18:35:03.044382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d)
[0m18:35:03.044577 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m18:35:03.046605 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d"
[0m18:35:03.046925 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m18:35:03.047253 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d
[0m18:35:03.047452 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m18:35:03.047669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_name.c8ab2d704d, now test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa)
[0m18:35:03.047928 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m18:35:03.049919 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa"
[0m18:35:03.050217 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m18:35:03.050539 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa
[0m18:35:03.050734 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:35:03.050949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_customers_customer_state.7c7083b6aa, now test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m18:35:03.051144 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:35:03.054453 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m18:35:03.054901 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:35:03.055245 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m18:35:03.055519 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m18:35:03.055818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.my_star_schema_project.not_null_dim_products_price.93519fc0ed)
[0m18:35:03.056049 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m18:35:03.059098 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_price.93519fc0ed"
[0m18:35:03.059675 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m18:35:03.060032 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_price.93519fc0ed
[0m18:35:03.060239 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m18:35:03.060482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_price.93519fc0ed, now test.my_star_schema_project.not_null_dim_products_product_category.069796c541)
[0m18:35:03.060711 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m18:35:03.062702 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_category.069796c541"
[0m18:35:03.063038 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m18:35:03.063380 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_category.069796c541
[0m18:35:03.063579 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m18:35:03.063796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_category.069796c541, now test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1)
[0m18:35:03.063984 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m18:35:03.066030 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1"
[0m18:35:03.066511 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m18:35:03.066855 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1
[0m18:35:03.067060 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m18:35:03.067274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_id.c8aba288d1, now test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3)
[0m18:35:03.067465 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m18:35:03.069553 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3"
[0m18:35:03.069846 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m18:35:03.070171 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3
[0m18:35:03.070371 [debug] [Thread-1 (]: Began running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m18:35:03.070592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.not_null_dim_products_product_name.991aec73f3, now test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985)
[0m18:35:03.070782 [debug] [Thread-1 (]: Began compiling node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m18:35:03.072735 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985"
[0m18:35:03.073076 [debug] [Thread-1 (]: Began executing node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m18:35:03.073407 [debug] [Thread-1 (]: Finished running node test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985
[0m18:35:03.073606 [debug] [Thread-1 (]: Began running node model.my_star_schema_project.star_schema_view
[0m18:35:03.073854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_star_schema_project.unique_dim_products_product_id.ef7b2a9985, now model.my_star_schema_project.star_schema_view)
[0m18:35:03.074045 [debug] [Thread-1 (]: Began compiling node model.my_star_schema_project.star_schema_view
[0m18:35:03.075851 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_star_schema_project.star_schema_view"
[0m18:35:03.076266 [debug] [Thread-1 (]: Began executing node model.my_star_schema_project.star_schema_view
[0m18:35:03.076594 [debug] [Thread-1 (]: Finished running node model.my_star_schema_project.star_schema_view
[0m18:35:03.077062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:03.077230 [debug] [MainThread]: Connection 'model.my_star_schema_project.star_schema_view' was properly closed.
[0m18:35:03.078526 [debug] [MainThread]: Command end result
[0m18:35:03.156887 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m18:35:03.158685 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m18:35:03.163189 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/takeshiiijima/github/duckdb-dbt/target/run_results.json
[0m18:35:03.165482 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m18:35:03.165681 [info ] [MainThread]: Building catalog
[0m18:35:03.171320 [debug] [ThreadPool]: Acquiring new duckdb connection 'duckdb.information_schema'
[0m18:35:03.176006 [debug] [ThreadPool]: Using duckdb connection "duckdb.information_schema"
[0m18:35:03.176450 [debug] [ThreadPool]: On duckdb.information_schema: BEGIN
[0m18:35:03.176689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:03.182276 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m18:35:03.182551 [debug] [ThreadPool]: Using duckdb connection "duckdb.information_schema"
[0m18:35:03.182752 [debug] [ThreadPool]: On duckdb.information_schema: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_star_schema_profile", "target_name": "dev", "connection_name": "duckdb.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'duckdb'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'duckdb'
    )
    select
        'duckdb' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m18:35:03.196164 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m18:35:03.212100 [debug] [ThreadPool]: On duckdb.information_schema: ROLLBACK
[0m18:35:03.212388 [debug] [ThreadPool]: Failed to rollback 'duckdb.information_schema'
[0m18:35:03.212554 [debug] [ThreadPool]: On duckdb.information_schema: Close
[0m18:35:03.228490 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/takeshiiijima/github/duckdb-dbt/target/catalog.json
[0m18:35:03.241679 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/takeshiiijima/github/duckdb-dbt/target/manifest.json
[0m18:35:03.242578 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/takeshiiijima/github/duckdb-dbt/target/semantic_manifest.json
[0m18:35:03.242761 [info ] [MainThread]: Catalog written to /Users/takeshiiijima/github/duckdb-dbt/target/catalog.json
[0m18:35:03.245118 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.74952674, "process_in_blocks": "0", "process_kernel_time": 0.187721, "process_mem_max_rss": "136839168", "process_out_blocks": "0", "process_user_time": 1.238154}
[0m18:35:03.245401 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:35:03.245351 after 0.75 seconds
[0m18:35:03.245598 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:35:03.245748 [debug] [MainThread]: Connection 'duckdb.information_schema' was properly closed.
[0m18:35:03.245927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e52a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10549d030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062566b0>]}
[0m18:35:03.246139 [debug] [MainThread]: Flushing usage events
[0m18:35:04.187937 [debug] [MainThread]: An error was encountered while trying to flush usage events
